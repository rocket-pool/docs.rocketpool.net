import nimbus_dashboard from "./images/nimbus-dashboard.png";
import tui_checkbox_checked from "./images/tui-checkbox-checked.png";
import tui_checkbox_unchecked from "./images/tui-checkbox-unchecked.png";
import tui_dropdown_closed from "./images/tui-dropdown-closed.png";
import tui_dropdown_open from "./images/tui-dropdown-open.png";
import tui_native_cc_url from "./images/tui-native-cc-url.png";
import tui_native_cc from "./images/tui-native-cc.png";
import tui_native_ec from "./images/tui-native-ec.png";
import tui_native_finished from "./images/tui-native-finished.png";
import tui_native_metrics from "./images/tui-native-metrics.png";
import tui_native_mev from "./images/tui-native-mev.png";
import tui_native_network from "./images/tui-native-network.png";
import tui_native_welcome from "./images/tui-native-welcome.png";
import tui_native_other from "./images/tui-native-other.png";
import tui_native_review from "./images/tui-native-review.png";
import tui_native_settings_home from "./images/tui-native-settings-home.png";
import tui_native_smartnode from "./images/tui-native-smartnode.png";
import tui_textbox from "./images/tui-textbox.png";

# Smartnode 스택 구성하기 (Native 모드)

이 섹션에서는 Docker를 전혀 사용하지 않는 **Native 설정**을 사용하는 경우 Smartnode를 구성하는 다양한 방법을 다룹니다.

::: warning 참고
Docker 기반 설정을 사용하는 경우, [Docker 구성 가이드](./config-docker)를 대신 방문하십시오.
:::

구성하는 세 가지 방법이 있습니다:

- [마법사 UI](#마법사를-통한-구성)를 통해 - 가장 쉬운 방법입니다. 몇 가지 기본 질문만 물어보고 잘 테스트된 기본값을 사용합니다. `rocketpool service config`를 처음 실행할 때 표시되는 화면입니다.
- [설정 관리자 UI](#설정-관리자를-통한-구성)를 통해 - Smartnode의 모든 설정에 액세스할 수 있어 원하는 대로 모든 것을 사용자 정의할 수 있습니다.
- [명령줄](#명령줄을-통한-구성)을 통한 헤드리스 방식 - Smartnode를 헤드리스(비대화형) 환경에서 실행하고 자동으로 구성해야 하는 사람들을 위한 옵션입니다.

위 목록에서 자세히 알아보고 싶은 모드를 선택하거나 아래의 각 옵션을 스크롤하여 살펴보십시오.

## 마법사를 통한 구성

Smartnode를 구성하려면 구성 명령을 실행하십시오:

```shell
rp service config
```

이렇게 하면 노드를 빠르고 쉽게 구성할 수 있는 터미널 기반 UI가 시작되며, Native 모드와 관련된 설정에 대한 선택적 세밀한 제어도 제공합니다.

::: tip 참고
이미 Smartnode를 구성한 경우, 대신 [설정 관리자](#설정-관리자를-통한-구성)가 표시됩니다.
원하는 경우 거기에서 마법사를 다시 열도록 선택할 수 있으며, 기존의 모든 설정이 미리 선택되어 있습니다.
:::

처음으로 config UI를 실행하거나 나중에 마법사를 다시 실행하도록 선택하면 다음과 같은 화면이 표시됩니다:

<img src={tui_native_welcome} width="100%" height="auto" />

::: tip 팁
마법사를 사용하려면 **`방향키`(위/아래/왼쪽/오른쪽)를 눌러 버튼(선택지) 또는 텍스트 박스와 같은 항목 사이를 이동하십시오**.
원하는 경우 `Tab`과 `Shift+Tab`을 사용할 수도 있습니다 - 동일한 기능을 합니다.

버튼의 경우, **현재 선택된 버튼은 녹색으로 강조 표시됩니다**.
검은색 버튼은 선택되지 않은 것입니다.
위 스크린샷에서 `Next`가 현재 선택되어 있고 `Quit`은 선택되지 않았습니다.

**`Enter` 또는 `Space`를 눌러 버튼을 선택하십시오**. 마우스로 클릭하는 것과 유사합니다.

**생각이 바뀌면 `Escape`를 눌러 이전 대화 상자로 돌아가십시오**.
다양한 마법사 페이지를 진행하면서 유용하게 사용할 수 있습니다.

**언제든지 `Ctrl`을 누른 상태에서 `C`를 눌러 아무것도 저장하지 않고 마법사를 종료하십시오**.

예를 들어, 위 화면에서 `왼쪽` 및 `오른쪽` 방향키를 눌러 `Next`와 `Quit` 버튼 사이를 이동할 수 있습니다.

`Next`가 선택된 상태에서 `Enter`를 누르면 다음 화면으로 진행됩니다.
`Quit`이 선택된 상태에서 `Enter`를 누르면 저장하지 않고 마법사를 종료합니다.
:::

준비가 되면 `Next`를 누르십시오.

### 네트워크 선택

다음 화면에서는 사용할 네트워크를 선택하라는 메시지가 표시됩니다:

<img src={tui_native_network} width="100%" height="auto" />

`위` 및 `아래` 방향키(또는 `Tab` 및 `Shift+Tab`)로 다양한 선택지를 강조 표시할 수 있습니다.
선택을 변경하면 오른쪽의 **Description** 박스에 각 옵션에 대한 간단한 설명이 표시됩니다.
이것은 네트워크 선택뿐만 아니라 마법사의 모든 선택 기반 페이지에 적용되므로 이러한 스타일의 페이지를 자주 보게 됩니다.

무료로 얻을 수 있는 가짜 ETH 및 RPL로 Hoodi 테스트 네트워크에서 Rocket Pool 노드를 실행하는 연습을 하고 싶다면 **Hoodi Testnet**을 선택하십시오.

실제 보상을 얻기 위해 메인넷에서 실제 Rocket Pool 노드를 생성할 준비가 되었다면 **Mainnet**을 선택하십시오.

### Execution 클라이언트 설정

다음 화면에서는 Execution 클라이언트의 HTTP 기반 RPC API URL을 입력하라는 메시지가 표시됩니다:

<img src={tui_native_ec} width="100%" height="auto" />

Smartnode와 동일한 머신에서 Execution 클라이언트를 실행할 계획이라면 여기에 `http://127.0.0.1:8545`를 입력하십시오(이 가이드의 나머지 부분에서는 이것을 계획하고 있다고 가정합니다).
그러나 이미 다른 곳에 Execution 클라이언트가 설정되어 있다면 대신 여기에 해당 URL을 사용하십시오.

나중에 `rp service config`를 다시 실행하여 언제든지 이를 변경할 수 있습니다.

### Consensus 클라이언트 설정

다음으로, 사용 중이거나 사용할 계획인 Consensus 클라이언트를 선택하라는 메시지가 표시됩니다.
각 Consensus 클라이언트는 약간 다른 동작을 하기 때문에 Smartnode는 사용 중인 클라이언트를 알아야 그에 따라 자체 동작을 조정할 수 있습니다.
다음 화면의 목록에서 클라이언트를 선택하십시오:

<img src={tui_native_cc} width="100%" height="auto" />

다음으로, 클라이언트의 API URL을 입력하라는 화면이 표시됩니다:

<img src={tui_native_cc_url} width="100%" height="auto" />

Smartnode와 동일한 머신에서 Consensus 클라이언트의 Beacon Node를 실행할 계획이라면 여기에 `http://127.0.0.1:5052`를 입력하십시오(이 가이드의 나머지 부분에서는 이것을 계획하고 있다고 가정합니다).
그러나 이미 다른 곳에 Beacon Node가 설정되어 있다면 대신 여기에 해당 URL을 사용하십시오.

### 기타 설정

다음 화면에는 몇 가지 기타 설정이 있습니다:

<img src={tui_native_other} width="100%" height="auto" />

Smartnode 설치를 위해 `/srv/rocketpool` 이외의 디렉토리를 사용하기로 결정하지 않았다면 기본 옵션으로 그대로 두십시오.

### Fallback 클라이언트

Smartnode 스택 1.5.0부터 기본 클라이언트가 오프라인 상태가 될 경우(예: Geth를 사용하고 프루닝해야 하는 경우) 이를 대신할 수 있는 "fallback" Execution 클라이언트 및 Consensus 클라이언트 쌍을 제공할 수 있습니다.
이 상황에서 기본 노드 머신은 여전히 미니풀의 validator 키로 증명하고 블록을 제안할 책임이 있지만, Execution 레이어 및 Beacon 체인과 상호 작용하기 위해 외부 머신에 연결합니다.

[fallback 노드에 대해 자세히 알아보려면 이 섹션을 참조하십시오](./fallback). 완료되면 여기로 돌아오십시오.

### Metrics

Rocket Pool은 Prometheus 및 Grafana와 통합하여 노드의 상태를 한눈에 관찰할 수 있는 편리한 웹 기반 대시보드를 생성할 수 있습니다:

<img src={nimbus_dashboard} width="100%" height="auto" />

마법사의 마지막 질문은 이를 활성화할 것인지 묻습니다:

<img src={tui_native_metrics} width="100%" height="auto" />

활성화하도록 선택하면 프로세스 후반부의 [Grafana 대시보드 설정](./grafana.mdx) 섹션에서 설정 방법과 사용 방법에 대해 자세히 알아볼 수 있습니다.

::: warning 참고
이 시스템에서 수집한 모든 데이터는 **머신에 남아 있습니다**.
Rocket Pool은 원격 측정 데이터를 수집하거나 별도의 서비스로 전송하지 않습니다.
순전히 자신의 노드를 모니터링할 수 있도록 제공되는 것입니다!
:::

### MEV 구성

2022년 9월 Execution 및 Consensus 레이어가 병합된 이후 Ethereum validator는 이제 우선순위 수수료를 얻고 MEV(Maximal Extractable Value)에 참여할 수 있습니다.

Smartnode v1.7.0부터 MEV는 이제 *opt-out*이므로 다음 화면에서 볼 수 있듯이 초기 설정의 일부로 구성에 대한 알림이 표시됩니다:

<img src={tui_native_mev} width="100%" height="auto" />

[MEV, 구성 및 마법사의 이 섹션에서 수행할 작업에 대해 자세히 알아보려면 MEV 가이드를 읽어보십시오.](./mev.mdx)
완료되면 여기로 돌아오십시오.

### 완료

이 질문 후, Smartnode 구성 설정이 완료되었습니다.
다음 대화 상자가 표시됩니다:

<img src={tui_native_finished} width="100%" height="auto" />

설정에 만족하고 Smartnode를 시작할 준비가 되었다면 여기에서 `Save and Exit`을 클릭하십시오.

아직 Rocket Pool 설치를 완료하지 않았다면 이제 Native 설정 가이드로 돌아가십시오.
그렇지 않으면 다음 단계는 다음 명령으로 데몬 서비스를 다시 시작하는 것입니다:

```shell
sudo systemctl restart rp-node rp-watchtower
```

마법사에 포함되지 않은 많은 추가 설정을 검토하고 사용자 정의하려면 `Review All Settings`를 클릭하고 [다음 섹션](#설정-관리자를-통한-구성)으로 이동하십시오.

## 설정 관리자를 통한 구성

이미 `rp service config`를 실행한 경우, 마법사가 아닌 **설정 관리자** 화면이 표시됩니다:

<img src={tui_native_settings_home} width="100%" height="auto" />

이 화면에는 세 가지 주요 기능이 있습니다:

1. **카테고리 목록** - Native 모드와 관련된 Smartnode 스택의 각 카테고리에 대한 설정을 드릴다운할 수 있습니다
2. **Review Changes and Save** 버튼 - 변경한 설정을 확인하고 업데이트된 구성을 저장할 준비가 되었을 때 사용할 수 있습니다
3. **Open the Config Wizard** 버튼 - 해당 인터페이스를 선호하는 경우 [설정 마법사](#마법사를-통한-구성)로 이동합니다

::: tip 팁
설정 관리자를 사용하려면 **`방향키`(위/아래/왼쪽/오른쪽)를 눌러 홈 페이지의 옵션 사이를 이동하십시오**.

화면 하단의 **카테고리 목록(1)과 버튼(2 및 3) 사이를 이동**하려면 `Tab`을 누르십시오.
현재 선택된 버튼은 **녹색으로 강조 표시**됩니다.

**`Enter` 또는 `Space`를 눌러 버튼을 선택하십시오**. 마우스로 클릭하는 것과 유사합니다.

**언제든지 `Ctrl`을 누른 상태에서 `C`를 눌러 아무것도 저장하지 않고 설정 관리자를 종료하십시오**.
:::

카테고리 목록을 스크롤하면 각 옵션에 대해 화면 오른쪽의 **Description Box**에 유용한 설명이 표시됩니다.
자유롭게 탐색하십시오. **Review Changes and Save** 버튼을 통해 Review 대화 상자를 거치기 전까지는 아무것도 저장되지 않으며, 언제든지 **Ctrl+C**를 눌러 저장하지 않고 종료할 수 있으므로 여기에서 설정을 가지고 놀다가 실수로 무언가를 망치지 않습니다.

### 설정 구성

홈 화면에서 `Enter` 키로 카테고리 중 하나를 선택하여 해당 카테고리의 설정을 확인하십시오.
예를 들어, 다음은 **Smartnode and TX Fees** 카테고리의 화면입니다:

<img src={tui_native_smartnode} width="100%" height="auto" />

`방향키`를 사용하여 설정 사이를 위아래로 이동하십시오.
현재 선택된 설정은 끝에 흰색 사각형이 있거나(텍스트 박스 또는 체크 박스인 경우) 흰색으로 강조 표시됩니다(드롭다운인 경우).

완료되면 `Escape`를 눌러 설정 관리자의 홈 화면으로 돌아가십시오.

설정을 스크롤하면 오른쪽의 **Description Box**에 각 설정이 무엇을 하는지에 대한 간단한 설명이 표시됩니다.
기본 설정으로 되돌리려는 경우 **기본값**도 표시됩니다.

이 예제에서는 **RPL Claim Gas Threshold** 설정이 현재 선택되어 있습니다(화면 왼쪽에 녹색 상자로 강조 표시됨).
`40`으로 변경되었지만 오른쪽 상단 모서리(**Description Box** 상단)에서 기본값이 `150`임을 알 수 있습니다.

::: tip 팁
참고로, **Review Changes and Save** 버튼을 통해 Review 대화 상자를 거치기 전까지는 디스크에 아무것도 저장되지 않습니다.
모든 설정을 탐색하여 알아보는 것이 좋습니다.
:::

### 설정 유형 및 사용 방법

설정 관리자는 다음 설정 유형 및 UI 요소를 사용합니다:

#### 텍스트 박스

텍스트 박스는 임의의 텍스트 또는 숫자 문자열을 입력하는 데 사용됩니다.
다음과 같이 보입니다:

<img src={tui_textbox} width="100%" height="auto" />

원하는 값을 입력한 다음 **`Enter`를 누르거나 `방향키`를 사용하여 다른 설정으로 이동하여 변경 사항을 보존하십시오.**
그렇지 않으면 설정 관리자는 여전히 해당 설정을 업데이트하고 있다고 가정하고 아직 변경된 것으로 표시하지 않습니다.

#### 드롭다운

드롭다운은 선택지 목록에서 옵션을 선택하는 데 사용됩니다.
열려 있을 때 다음과 같이 보입니다:

<img src={tui_dropdown_open} width="100%" height="auto" />

**녹색** 항목이 현재 선택된 항목입니다.
`방향키`를 사용하여 옵션을 변경하십시오 - 그렇게 하면 오른쪽의 **Description Box**가 업데이트되어 현재 선택된 옵션에 대해 자세히 알려줍니다.
선택에 만족하면 `Enter`를 눌러 선택한 옵션을 선택하면 드롭다운이 닫히고 현재 선택된 옵션이 표시됩니다:

<img src={tui_dropdown_closed} width="100%" height="auto" />

#### 체크 박스

체크 박스는 간단한 예/아니오 질문에 사용됩니다.
다음과 같이 보입니다:

<img src={tui_checkbox_checked} width="100%" height="auto" />

체크되면 위에서 볼 수 있듯이 중간에 `X`가 표시됩니다.
체크되지 _않으면_ 다음과 같이 단순히 비어 있습니다:

<img src={tui_checkbox_unchecked} width="100%" height="auto" />

설정을 변경하려면 선택하고 `Enter`를 누르십시오.

### 변경 사항 저장

변경 사항에 만족하고 저장하기 전에 검토하려면 홈 화면에서 **Review Changes and Save** 버튼을 누르십시오.
참고로, 이동하려면 `Tab` 키를 누르십시오.

다음과 같은 화면이 표시됩니다:

<img src={tui_native_review} width="100%" height="auto" />

여기의 **Review Box**는 변경한 모든 설정을 표시하며 이전 값과 새 값을 보여줍니다.
예를 들어, 여기의 첫 번째 줄은 **RPL Claim Gas Threshold**가 `150`이었고 `40`으로 변경되었음을 보여줍니다.

::: tip 참고
이 시점에서 변경 사항은 **아직 저장되지 않았습니다**.
돌아가서 무언가를 수정하려면 `Escape`를 눌러 홈 화면으로 돌아가십시오.
:::

변경 사항에 만족하면 `Enter`를 눌러 새 구성을 디스크에 저장하십시오.
그러면 터미널 UI를 종료하고 다음 메시지가 표시됩니다:

```
Your changes have been saved!
Please restart your daemon service for them to take effect.
```

아직 Rocket Pool 설치를 완료하지 않았다면 이제 Native 설정 가이드로 돌아가십시오.
그렇지 않으면 이제 다음 명령으로 데몬 서비스를 다시 시작할 수 있습니다:

```shell
sudo systemctl restart rp-node rp-watchtower
```

## 명령줄을 통한 구성

터미널 UI와 상호 작용할 수 없는 헤드리스 환경에서 Smartnode를 사용하는 경우 대신 명령줄을 통해 노드를 구성할 수 있습니다.

`rocketpool service config` 명령은 일반적으로 터미널 UI를 통해 구성할 수 있는 모든 설정을 인수로 허용합니다.
다음 명령을 실행하여 목록을 확인하십시오(상당히 깁니다):

```
rocketpool service config --help
```

출력은 다음과 같습니다:

```
NAME:
   rocketpool service config - Configure the Rocket Pool service

USAGE:
   rocketpool service config

OPTIONS:
   --executionClientMode value  Choose which mode to use for your Execution client - locally managed (Docker Mode), or externally managed (Hybrid Mode).
                                Type: choice
                                Options: local, external
 (default: "local")
   --executionClient value  Select which Execution client you would like to run.
                            Type: choice
                            Options: geth, infura, pocket
 (default: "geth")
   --useFallbackExecutionClient         Enable this if you would like to specify a fallback Execution client, which will temporarily be used by the Smartnode and your Consensus client if your primary Execution client ever goes offline.
                                        Type: bool

...
```

각 옵션에는 이름, 유형, 기본값 및 (선택 매개변수인 경우) 옵션이 있습니다.
이 텍스트를 사용하여 설정하려는 옵션을 찾고 적절한 인수를 통해 지정할 수 있습니다.

::: tip 참고
이 명령은 기존 구성 위에 빌드되므로 이미 저장된 일부 설정이 있고 다른 설정만 수정하려는 경우 반복할 필요가 없습니다.
이 명령에 인수로 포함하는 설정만 업데이트합니다.
:::

아직 Rocket Pool 설치를 완료하지 않았다면 이제 Native 설정 가이드로 돌아가십시오.
그렇지 않으면 다음 단계는 다음 명령으로 데몬 서비스를 다시 시작하는 것입니다:

```shell
sudo systemctl restart rp-node rp-watchtower
```
