import { Tab, Tabs } from "@rspress/core/theme";

# Rocket Pool 시작하기

이 시점에서 Smartnode 스택, Execution 및 Consensus 클라이언트를 포함한 완전한 Rocket Pool 인프라가 실행되고 있어야 합니다.
또한 외부 공격자로부터 운영 체제를 강화해야 합니다.
이 두 단계를 모두 완료했다면 Rocket Pool 노드를 생성하고 스테이킹을 시작할 준비가 된 것입니다.
그렇지 않은 경우 이전 섹션을 검토하고 해당 단계를 완료한 후 여기로 돌아오세요.

## Rocket Pool 서비스 시작 및 중지

<div className="p-3">
  <Tabs>
    <Tab label="Docker (Default) Mode">
      이제 Smartnode가 설치되었으므로 스택을 시작하는 것은 쉽습니다.
      다음 명령을 입력하기만 하면 됩니다:

      ```shell
      rocketpool service start
      ```

      이 명령은 아직 존재하지 않는 경우 모든 필요한 Docker 이미지를 생성하고, Rocket Pool docker 네트워크 및 스토리지 볼륨이 초기화되었는지 확인하며, `rocketpool service config`의 UI에서 구성 설정과 더 이상 일치하지 않는 컨테이너를 업데이트합니다.

      처음 실행하면 출력은 다음과 같아야 합니다:

      ```
      $ rocketpool service start

      Creating network "rocketpool_net" with the default driver
      Creating volume "rocketpool_eth1clientdata" with default driver
      Creating volume "rocketpool_eth2clientdata" with default driver
      Creating rocketpool_eth1 ...
      Creating rocketpool_eth1 ... done
      Creating rocketpool_eth2 ...
      Creating rocketpool_api  ...
      Creating rocketpool_api  ... done
      Creating rocketpool_eth2 ... done
      Creating rocketpool_watchtower ...
      Creating rocketpool_mev-boost   ...
      Creating rocketpool_mev-boost   ... done
      Creating rocketpool_node       ...
      Creating rocketpool_validator  ...
      Creating rocketpool_validator  ... done
      Creating rocketpool_node       ... done
      Creating rocketpool_watchtower ... done
      ```

      이와 같이 표시되면 Smartnode 스택이 성공적으로 초기화되어 현재 실행 중입니다.

      서비스를 중지해야 하는 경우(예: 업그레이드 중 또는 유지 관리를 수행해야 하는 경우) `rocketpool service stop`을 사용하여 모든 것을 종료할 수 있습니다.
      출력은 다음과 같아야 합니다:

      ```
      $ rocketpool service stop

      Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized! [y/n]
      y

      Stopping rocketpool_node       ...
      Stopping rocketpool_validator  ...
      Stopping rocketpool_watchtower ...
      Stopping rocketpool_mev-boost  ...
      Stopping rocketpool_eth2       ...
      Stopping rocketpool_api        ...
      Stopping rocketpool_eth1       ...
      Stopping rocketpool_validator  ... done
      Stopping rocketpool_node       ... done
      Stopping rocketpool_watchtower ... done
      Stopping rocketpool_api        ... done
      Stopping rocketpool_mev-boost  ... done
      Stopping rocketpool_eth2       ... done
      Stopping rocketpool_eth1       ... done
      ```

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">참고</p>
        이 명령을 호출하면 Rocket Pool은 시스템 재부팅 후 **자동으로** 시작되지 않습니다.
        모든 Docker 컨테이너를 시작하고 재부팅 시 자동 시작을 다시 활성화하려면 `rocketpool service start`를 호출해야 합니다.
      </p>
    </Tab>
    <Tab label="Hybrid Mode">
      이제 Smartnode가 설치되었으므로 스택을 시작하는 것은 쉽습니다.
      다음 명령을 입력하기만 하면 됩니다:

      ```shell
      rocketpool service start
      ```

      이 명령은 아직 존재하지 않는 경우 모든 필요한 Docker 이미지를 생성하고, Rocket Pool docker 네트워크 및 스토리지 볼륨이 초기화되었는지 확인하며, `rocketpool service config`의 UI에서 구성 설정과 더 이상 일치하지 않는 컨테이너를 업데이트합니다.

      처음 실행하면 출력은 다음과 같아야 합니다:

      ```
      $ rocketpool service start

      Creating network "rocketpool_net" with the default driver
      Creating rocketpool_api  ...
      Creating rocketpool_api  ... done
      Creating rocketpool_watchtower ...
      Creating rocketpool_node       ...
      Creating rocketpool_validator  ...
      Creating rocketpool_validator  ... done
      Creating rocketpool_node       ... done
      Creating rocketpool_watchtower ... done
      ```

      이와 같이 표시되면 Smartnode 스택이 성공적으로 초기화되어 현재 실행 중입니다.

      외부 Execution 및/또는 Consensus 클라이언트는 Rocket Pool이 관리하지 않으므로 시작할 수 없기 때문에 여기에 나열되지 않습니다.
      원래 생성한 메커니즘을 사용하여 별도로 시작했는지 확인해야 합니다.

      서비스를 중지해야 하는 경우(예: 업그레이드 중 또는 유지 관리를 수행해야 하는 경우) `rocketpool service stop`을 사용하여 모든 것을 종료할 수 있습니다.
      출력은 다음과 같아야 합니다:

      ```
      $ rocketpool service stop

      Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized! [y/n]
      y

      Stopping rocketpool_node       ...
      Stopping rocketpool_validator  ...
      Stopping rocketpool_watchtower ...
      Stopping rocketpool_api        ...
      Stopping rocketpool_validator  ... done
      Stopping rocketpool_node       ... done
      Stopping rocketpool_watchtower ... done
      Stopping rocketpool_api        ... done
      ```

      마찬가지로 Execution 및 Consensus 클라이언트를 중지하려는 경우 적절하게 중지되도록 수동으로 확인해야 합니다.

      <p className="rspress-directive tip">
        <p className="rspress-directive-title">참고</p>
        이 명령을 호출하면 Rocket Pool은 시스템 재부팅 후 자동으로 시작되지 않습니다.
        모든 Docker 컨테이너를 시작하고 재부팅 시 자동 시작을 다시 활성화하려면 `rocketpool service start`를 호출해야 합니다.
      </p>

    </Tab>
    <Tab label="Native Mode">
      Native 모드에서는 [Configuring a Native Rocket Pool Node without Docker](./native) 섹션의 일부로 Smartnode 서비스를 이미 설정하고 시작했습니다.

      `systemd` 서비스로 설정했다고 가정하면 `sudo systemctl start ...`로 시작할 수 있습니다.
      예를 들어 Execution에 Geth를, Consensus에 Teku를 사용하는 경우:

      ```shell
      sudo systemctl start geth teku-bn teku-vc rp-node rp-watchtower
      ```

      중지는 동일한 프로세스이지만 `sudo systemctl stop ...`을 사용합니다.

      서비스를 중지해도 **자동 시작이 비활성화되지 않습니다**. 재부팅 시 프로세스가 자동으로 시작됩니다.

    </Tab>

  </Tabs>
</div>

## 올바른 버전 및 네트워크 확인

컨테이너 또는 서비스가 실행되면 올바른 버전의 클라이언트를 사용하고 있고 예상하는 네트워크에 있는지 확인하는 것이 좋습니다.
다음 명령으로 이를 수행할 수 있습니다:

```shell
rocketpool service version
```

출력은 다음과 같습니다 **(여기에 표시된 것보다 최신 버전이 있을 수 있으며 이것은 단지 예시입니다)**:

```
Your Smartnode is currently using the Ethereum Mainnet.

Rocket Pool client version: 1.6.4
Rocket Pool service version: 1.6.4
Selected Eth 1.0 client: Geth (Locally managed)
Image: ethereum/client-go:v1.10.25
Selected Eth 2.0 client: Lighthouse (Locally managed)
Image: sigp/lighthouse:v3.1.0
```

첫 번째 줄은 Smartnode가 Ethereum 메인넷 또는 Hoodi 테스트넷으로 구성되어 있는지 알려줍니다.

::: warning 참고
**Docker / Hybrid 사용자의 경우:**
예상하는 네트워크에 있지 않은 경우 Installing Rocket Pool 섹션으로 돌아가 설치 지침을 검토하세요. 사용하려는 네트워크에 따라 다른 지침이 있는 부분을 놓쳤을 수 있습니다.

**Native 사용자의 경우:**
`rp service config`를 처음 실행할 때 기본 설정을 수락한 경우 여기에 보고된 네트워크가 올바르지 않을 수 있습니다.
`rp service config` TUI의 `Smartnode` 섹션에서 적절한 네트워크로 전환하고 `node` 및 `watchtower` 서비스를 재시작하기만 하면 됩니다.
:::

두 번째 줄 세트는 사용 중인 클라이언트와 Rocket Pool 구성에 정의된 버전을 알려줍니다.

## 서비스 상태 및 로그 확인

이제 Smartnode 서비스가 시작되었으므로 오류 없이 올바르게 실행되고 있는지 확인하는 것이 좋습니다.

<div className="p-3">
  <Tabs>
    <Tab label="Docker (Default) Mode">
      가장 먼저 확인해야 할 것은 Docker 컨테이너가 잘 실행되고 있는지, 아니면 오류로 인해 계속 재시작되고 있는지입니다.
      다음 명령을 실행합니다:

      ```shell
      docker ps
      ```

      결과는 다음과 같아야 합니다:

      ```
      CONTAINER ID   IMAGE                         COMMAND                  CREATED       STATUS      PORTS                                                                                                         NAMES
      4c1de08a352b   prom/prometheus:v2.37.0       "/bin/prometheus --w…"   9 days ago    Up 9 days   9090/tcp                                                                                                      rocketpool_prometheus
      56940decdd1f   sigp/lighthouse:v2.5.1        "sh /setup/start-bn.…"   9 days ago    Up 9 days   0.0.0.0:9001->9001/tcp, 0.0.0.0:9001->9001/udp, :::9001->9001/tcp, :::9001->9001/udp                          rocketpool_eth2
      bd061e632535   grafana/grafana:8.5.9         "/run.sh"                9 days ago    Up 9 days   3000/tcp, 0.0.0.0:3100->3100/tcp, :::3100->3100/tcp                                                           rocketpool_grafana
      5c4db92762fb   ethereum/client-go:v1.10.21   "sh /setup/start-ec.…"   9 days ago    Up 9 days   8545-8546/tcp, 0.0.0.0:30303->30303/tcp, 0.0.0.0:30303->30303/udp, :::30303->30303/tcp, :::30303->30303/udp   rocketpool_eth1
      e20c560861fc   rocketpool/smartnode:v1.5.0   "/bin/sleep infinity"    9 days ago    Up 9 days                                                                                                                 rocketpool_api
      4cf8d364fb90   rocketpool/smartnode:v1.5.0   "/go/bin/rocketpool …"   9 days ago    Up 9 days                                                                                                                 rocketpool_watchtower
      9eb944c29997   rocketpool/smartnode:v1.5.0   "/go/bin/rocketpool …"   9 days ago    Up 9 days                                                                                                                 rocketpool_node
      2ca5d3dcb471   sigp/lighthouse:v2.5.1        "sh /setup/start-vc.…"   9 days ago    Up 9 days                                                                                                                 rocketpool_validator
      dedc577fe361   prom/node-exporter:v1.3.1     "/bin/node_exporter …"   2 weeks ago   Up 9 days                                                                                                                 rocketpool_exporter
      ```

      확인해야 할 주요 사항은 `STATUS` 열입니다.
      항목 중 `Restarting...`이라고 표시되는 것이 없으면 컨테이너가 제대로 실행되고 있어야 합니다(`rocketpool_validator` 컨테이너에 대한 예외는 아래 참고 사항 참조).


      <p className="rspress-directive warning">
        <p className="rspress-directive-title">참고</p>
        Consensus 클라이언트로 Prysm 또는 Lodestar를 사용하는 경우 `rocketpool_validator` 컨테이너가 계속 재시작되는 것을 볼 수 있습니다.
        괜찮습니다!
        validator 컨테이너는 [Creating a Minipool (Validator)](./create-validator) 섹션에서 다룰 `rocketpool node deposit` 명령을 사용하여 새 validator가 생성될 때까지 실패합니다.
        이 작업이 완료되면 컨테이너가 올바르게 작동합니다. 그때까지는 무시하세요.
      </p>

      그래도 다양한 서비스의 로그를 확인하는 것이 유용할 수 있습니다.

      로그를 확인하려면 `rocketpool service logs container` 명령을 사용합니다. 여기서 `container`는 `eth1`, `eth2`, `validator`, `api`, `node` 또는 `watchtower` 중 하나입니다.

      예를 들어 ETH1 클라이언트의 로그를 확인하려면:

      ```
      $ rocketpool service logs eth1

      Attaching to rocketpool_eth1
      eth1_1        | INFO [06-17|05:17:19.052] Imported new block receipts              count=25   elapsed=26.651ms    number=247,000   hash=6583ec..35eb1c age=2y3mo2w  size=15.72KiB
      eth1_1        | INFO [06-17|05:17:19.098] Imported new block headers               count=192  elapsed=18.515ms    number=247,551   hash=b7d5e4..d49faf age=2y3mo2w
      eth1_1        | INFO [06-17|05:17:19.334] Imported new block receipts              count=371  elapsed=46.450ms    number=247,371   hash=dd3240..1ed173 age=2y3mo2w  size=266.59KiB
      eth1_1        | INFO [06-17|05:17:19.354] Imported new state entries               count=1271 elapsed=2.866ms     processed=374,695 pending=3134  trieretry=0   coderetry=0  duplicate=0 unexpected=0
      eth1_1        | INFO [06-17|05:17:19.441] Imported new block headers               count=384  elapsed=35.331ms    number=247,935   hash=4c4dba..5bf8b6 age=2y3mo2w
      eth1_1        | INFO [06-17|05:17:19.460] Imported new block receipts              count=180  elapsed=33.648ms    number=247,551   hash=b7d5e4..d49faf age=2y3mo2w  size=128.73KiB
      eth1_1        | INFO [06-17|05:17:19.480] Imported new block headers               count=192  elapsed=19.122ms    number=248,127   hash=aa70b9..40d139 age=2y3mo1w
      eth1_1        | INFO [06-17|05:17:19.486] Imported new block receipts              count=6    elapsed=26.042ms    number=247,557   hash=fd6656..ca2439 age=2y3mo2w  size=3.77KiB
      ```

      `eth1`과 `eth2` 모두에 대해 이 작업을 수행하여 두 클라이언트 모두 오류 없이 실행되고 있는지 확인해야 합니다.
    </Tab>
    <Tab label="Hybrid Mode">
      가장 먼저 확인해야 할 것은 Docker 컨테이너가 잘 실행되고 있는지, 아니면 오류로 인해 계속 재시작되고 있는지입니다.
      다음 명령을 실행합니다:

      ```shell
      docker ps
      ```

      결과는 다음과 같아야 합니다:

      ```
      CONTAINER ID   IMAGE                               COMMAND                  CREATED       STATUS         NAMES
      a3c22f54eff0   rocketpool/smartnode:v1.0.0-rc3     "/go/bin/rocketpool …"   2 hours ago   Up 2 minutes   rocketpool_node
      0d5818868ef6   sigp/lighthouse:v1.4.0              "sh /setup/start-val…"   2 hours ago   Up 2 minutes   rocketpool_validator
      88bea525fa89   rocketpool/smartnode:v1.0.0-rc3     "/go/bin/rocketpool …"   2 hours ago   Up 2 minutes   rocketpool_watchtower
      62314e5a0ecf   rocketpool/smartnode:v1.0.0-rc3     "/bin/sleep infinity"    2 hours ago   Up 2 minutes   rocketpool_api
      ```

      확인해야 할 주요 사항은 `STATUS` 열입니다.
      항목 중 `Restarting...`이라고 표시되는 것이 없으면 컨테이너가 제대로 실행되고 있어야 합니다(`rocketpool_validator` 컨테이너에 대한 예외는 아래 참고 사항 참조).

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">참고</p>
        Consensus 클라이언트로 **Lodestar** 또는 **Prysm**을 사용하는 경우 `rocketpool_validator` 컨테이너가 계속 재시작되는 것을 볼 수 있습니다.
        괜찮습니다!
        validator 컨테이너는 [Creating a Minipool (Validator)](./create-validator) 섹션에서 다룰 `rocketpool node deposit` 명령을 사용하여 새 validator가 생성될 때까지 실패합니다.
        이 작업이 완료되면 컨테이너가 올바르게 작동합니다. 그때까지는 무시하세요.
      </p>

      그래도 다양한 서비스의 로그를 확인하는 것이 유용할 수 있습니다.

      로그를 확인하려면 `rocketpool service logs container` 명령을 사용합니다. 여기서 `container`는 `eth1`, `eth2`, `validator`, `api`, `node` 또는 `watchtower` 중 하나입니다.

      외부에서 유지 관리하는 것에 따라 `eth1` 및/또는 `eth2`를 무시할 수 있지만 Rocket Pool이 그 중 하나를 관리하도록 하는 경우 이 명령을 사용하여 지금 상태를 확인해야 합니다.
    </Tab>
    <Tab label="Native Mode">
      Native 모드에서 상태와 로그를 확인하는 가장 쉬운 방법은 Smartnode 서비스를 처음 설정할 때 만든 로깅 스크립트를 사용하는 것입니다.

      예를 들어 Geth의 로그를 확인하려면 다음을 실행하면 됩니다:

      ```shell
      /srv/geth/log.sh
      ```

      오류 없이 천천히 진행되고 있는 것을 볼 수 있어야 합니다.
      Execution 및 Consensus 클라이언트가 제대로 작동하는지 확인하기 위해 지금 이 작업을 수행하세요.
    </Tab>

  </Tabs>
</div>

::: tip 팁
로그 보기를 마치면 `Ctrl + C`를 사용하여 종료하고 명령 프롬프트로 돌아갈 수 있습니다.
:::

## ETH 클라이언트 동기화 대기

이제 클라이언트가 시작되었으므로 계속 진행하기 전에 Execution 및 Consensus 클라이언트가 네트워크와의 동기화를 완료할 때까지 기다려야 합니다.

상태를 확인하는 쉬운 방법은 다음 명령을 사용하는 것입니다:

```shell
rocketpool node sync
```

이 명령은 Execution 및 Consensus 클라이언트가 동기화 프로세스에서 얼마나 진행되었는지 다음과 유사하게 표시합니다:

```shell
$ rocketpool node sync

Your Smartnode is currently using the Hoodi Test Network.

Your eth2 client is on the correct network.

Your primary execution client is fully synced.
You do not have a fallback execution client enabled.
Your consensus client is still syncing (99.69%).
```

이것을 가끔 호출하여 클라이언트의 진행 상황을 확인할 수 있습니다.

동기화 시간의 실제 ETA를 얻으려면 각각 `rocketpool service logs eth1` 및 `rocketpool service logs eth2`(또는 Hybrid / Native 모드를 사용하는 경우 동등한 로그 스크립트 명령)를 사용하여 클라이언트의 로그를 보는 것이 가장 쉽습니다.
각 클라이언트는 일반적으로 로그 출력에서 동기화 상태에 대한 ETA를 제공합니다.

::: tip 참고
클라이언트 선택 및 머신의 하드웨어 프로필에 따라 ETH1 및 ETH2를 모두 완전히 동기화하는 데 **며칠**이 걸릴 수 있습니다.
**이것은 예상되는 것입니다**.
편히 앉아서 두 가지 모두 완료될 때까지 기다리세요.
:::

::: warning 참고
노드가 전혀 동기화되지 않거나 피어가 없는 경우 라우터가 포트 30303 및 9001을 차단하고 있기 때문일 수 있습니다. 포트가 닫혀 있으면 라우터에서 포트 포워딩을 설정해야 합니다. 또한 노드가 새 주소를 받아 포트 포워딩이 끊어지지 않도록 노드에 고정 로컬 IP 주소가 있는지 확인하세요.
:::

## 다음 단계

클라이언트가 동기화되면 첫 번째 노드인 경우 [새 지갑 생성](./wallet-init) 또는 백업에서 복원하거나 Allnodes와 같은 다른 제공자에서 자체 하드웨어로 마이그레이션하는 경우 [기존 지갑 복구](./recovering-rp)를 준비할 수 있습니다.

자세히 알아보려는 항목을 선택하고 해당 가이드의 단계를 따르세요.
