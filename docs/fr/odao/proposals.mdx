import { Tab, Tabs } from "@rspress/core/theme";

# Propositions de l'Oracle DAO

Pour rappel, il existe deux types de tâches de l'Oracle DAO :

1. **Tâches automatisées** - ce sont des tâches liées au fonctionnement routinier de Rocket Pool, telles que le transfert d'informations de la couche de Consensus vers la couche d'Execution, le calcul de divers aspects du protocole hors chaîne et leur soumission en tant que mises à jour aux Smart Contracts. Chacune de ces tâches est effectuée automatiquement par le processus démon `watchtower` et ne nécessite pas d'intervention manuelle tant que vos clients d'Execution et de Consensus, ainsi que votre démon `watchtower`, fonctionnent tous normalement. Vous avez déjà configuré le démon `watchtower` dans les étapes précédentes, donc cette section ne les couvrira pas à nouveau.
2. **Tâches manuelles** - ce sont des tâches qui nécessitent votre propre prise de décision et une communication hors bande avec le reste de l'Oracle DAO pour être effectuées. Elles incluent des éléments tels que le vote sur les mises à niveau de contrats, la modification de paramètres et l'invitation ou l'exclusion de membres de/vers l'Oracle DAO. Toutes ces tâches peuvent être effectuées via la CLI standard du Smartnode. Cette section décrit chacune de ces tâches et comment les effectuer.

Les propositions constituent le cœur de vos responsabilités en dehors des tâches automatisées du `watchtower`.
Essentiellement, elles fonctionnent comme suit :

- L'Oracle DAO collectif doit discuter de manière approfondie d'une proposition à venir à l'avance, afin que chaque membre en soit conscient et comprenne ce que cette proposition impliquera.
- Un membre de l'Oracle DAO crée ensuite la proposition via une transaction on-chain.
- La proposition entrera ensuite dans une **période d'attente** avant que le vote ne puisse commencer pour avoir une discussion plus approfondie et se former une opinion à ce sujet. Cela dure actuellement **7 jours** sur le Mainnet.
- Après la période d'attente, les membres peuvent voter sur la proposition via un simple vote oui-ou-non.
- Lorsqu'un quorum de 51% des membres de l'Oracle DAO a voté de la même manière, le vote est conclu. Si 51% ont accepté la proposition, elle pourra être **exécutée**. N'importe quel membre peut exécuter la proposition une fois qu'elle est approuvée.
- L'exécution fait référence au déclenchement formel du changement on-chain, modifiant ainsi l'état des contrats principaux de Rocket Pool.

## Créer une proposition

Une fois que vous créez une proposition, elle entrera dans une **période d'examen** où les autres membres pourront la voir et en discuter, mais ne pourront pas voter dessus.
Au moment de la rédaction, cela dure actuellement **7 jours**.

Après la période d'examen, il y aura une **période de vote** où les membres peuvent voter soit pour la proposition, soit contre elle.
Au moment de la rédaction, cela dure actuellement **14 jours**.

Si la proposition atteint le quorum avant d'expirer (c'est-à-dire si suffisamment de membres votent en sa faveur pour atteindre le consensus), elle sera **adoptée**.
Le quorum est un paramètre configurable par l'Oracle DAO ; il est actuellement fixé à au moins **51%** du pool total de membres.

Une fois qu'un vote est adopté, il peut être **exécuté**, ce qui fait entrer ses changements en vigueur.
Au moment de la rédaction, l'exécution est **14 jours** après l'adoption de la proposition.

Le processus de création d'une nouvelle proposition dépend du type de proposition que vous souhaitez faire.
Sélectionnez un type dans les onglets ci-dessous.

<div className="p-3">
  <Tabs>
    <Tab label="Liste des membres de l'Oracle DAO">
      Pour proposer de modifier la liste des membres de l'Oracle DAO, utilisez la commande `rocketpool odao propose member` qui
      fournit les options suivantes :

      ```
      NAME:
      rocketpool odao propose member - Make an oracle DAO member proposal

      USAGE:
      rocketpool odao propose member command [command options] [arguments...]

      COMMANDS:
      invite, i Propose inviting a new member
      leave, l Propose leaving the oracle DAO
      kick, k Propose kicking a member

      OPTIONS:
      --help, -h show help
      ```

      #### invite

      Inviter un membre se fait via `rocketpool odao propose member invite` qui prendra 3 arguments supplémentaires :

      - L'adresse du nœud à inviter (doit être un nœud Rocket Pool enregistré)
      - Le nom / label pour ce nœud
      - L'URL ou les informations de contact pour l'utilisateur ou l'organisation qui gère le nœud

      Par exemple : pour inviter un nouveau membre, exécutez `rocketpool odao propose member invite
      0xabcd1234abcd1234abcd1234abcd1234abcd1234 some-user user@example.com`.

      #### kick

      Exclure un membre de l'Oracle DAO se fait via la commande `rocketpool odao propose member kick`.
      Il vous sera demandé de sélectionner le membre que vous souhaitez exclure et d'émettre une amende facultative (de 0 RPL jusqu'au
      montant du RPL cautionné, actuellement 1750 RPL).
      Cette amende, si elle est fournie, brûlera une partie (ou la totalité) de la caution RPL du membre si l'Oracle DAO vote pour exclure ce
      membre.

      #### leave

      Si vous souhaitez démissionner volontairement de l'Oracle DAO, utilisez la commande `rocketpool odao propose member leave`.
      Cela créera une nouvelle proposition afin que les autres membres puissent voter pour approuver ou non votre démission.
    </Tab>
    <Tab label="Paramètres de l'Oracle DAO">
      Pour proposer de modifier les paramètres qui régissent le fonctionnement des votes de l'Oracle DAO et la modification de l'adhésion, utilisez la
      commande `rocketpool odao propose setting` qui fournit les options suivantes :

      ```
      NAME:
      rocketpool odao propose setting - Make an oracle DAO setting proposal

      USAGE:
      rocketpool odao propose setting command [command options] [arguments...]

      COMMANDS:
      members-quorum, q Propose updating the members.quorum setting - takes a percent, from 0 to 100
      members-rplbond, b Propose updating the members.rplbond setting - takes an RPL amount (e.g. 5000)
      proposal-cooldown, c Propose updating the proposal.cooldown.time setting - format is e.g. 1h30m45s
      proposal-vote-timespan, v Propose updating the proposal.vote.time setting - format is e.g. 1h30m45s
      proposal-vote-delay-timespan, d Propose updating the proposal.vote.delay.time setting - format is e.g. 1h30m45s
      proposal-execute-timespan, x Propose updating the proposal.execute.time setting - format is e.g. 1h30m45s
      proposal-action-timespan, a Propose updating the proposal.action.time setting - format is e.g. 1h30m45s
      scrub-period, s Propose updating the minipool.scrub.period setting - format is e.g. 1h30m45s

      OPTIONS:
      --help, -h show help
      ```

      #### members-quorum

      L'utilisation de `rocketpool odao propose setting members-quorum value` modifiera le quorum requis pour les tâches de l'Oracle DAO
      avant qu'elles ne soient considérées comme canonisées.
      `value` ici peut être un nombre à virgule flottante entre 0 et 100, indiquant le pourcentage de membres nécessaires pour atteindre le
      quorum sur les votes de l'Oracle DAO.

      ::: warning NOTE
      Notez que cela n'affecte **pas** le quorum requis pour les tâches automatisées telles que la soumission du prix du RPL et du solde de rETH ;
      ces paramètres sont contrôlés par la Protocol DAO (pDAO), _et non_ par l'Oracle DAO.
      :::

      #### members-rplbond

      Utilisez `rocketpool odao propose setting members-rplbond value` pour modifier le montant de RPL requis comme caution pour les nouveaux
      membres invités à l'Oracle DAO.
      Par exemple, entrer `5000` pour `value` fixera la caution à 5000 RPL.
      Notez que cela n'affecte pas les membres qui existent déjà ; cela affecte uniquement les nouveaux membres invités après le changement.

      #### proposal-cooldown

      Utilisez `rocketpool odao propose setting proposal-cooldown value` pour modifier le temps de récupération qu'un membre doit attendre
      entre la soumission de propositions.

      `value` est une durée formatée en chaîne, telle que `1h30m45s` pour une heure, trente minutes et quarante-cinq
      secondes.
      Elle n'accepte pas les jours ; pour plusieurs jours, utilisez simplement le nombre total d'heures.

      #### proposal-vote-timespan

      Utilisez `rocketpool odao propose setting proposal-vote-timespan value` pour modifier la durée pendant laquelle un vote peut exister avant
      d'expirer.

      `value` est une durée formatée en chaîne, telle que `1h30m45s` pour une heure, trente minutes et quarante-cinq
      secondes.
      Elle n'accepte pas les jours ; pour plusieurs jours, utilisez simplement le nombre total d'heures.

      #### proposal-vote-delay-timespan

      Utilisez `rocketpool odao propose setting proposal-vote-delay-timespan value` pour modifier la durée pendant laquelle l'Oracle DAO doit
      attendre avant de pouvoir voter sur une nouvelle proposition.

      `value` est une durée formatée en chaîne, telle que `1h30m45s` pour une heure, trente minutes et quarante-cinq
      secondes.
      Elle n'accepte pas les jours ; pour plusieurs jours, utilisez simplement le nombre total d'heures.

      #### proposal-execute-timespan

      Utilisez `rocketpool odao propose setting proposal-execute-timespan value` pour modifier la durée dont l'Oracle DAO dispose pour
      exécuter (promulguer) une proposition après son approbation.
      Si aucun des membres n'exécute la proposition pendant cette fenêtre, elle expirera et la proposition deviendra
      invalide.

      `value` est une durée formatée en chaîne, telle que `1h30m45s` pour une heure, trente minutes et quarante-cinq
      secondes.
      Elle n'accepte pas les jours ; pour plusieurs jours, utilisez simplement le nombre total d'heures.

      #### proposal-action-timespan

      Certaines propositions nécessitent des actions secondaires après avoir été exécutées pour qu'elles prennent effet (telles que
      inviter un membre à rejoindre, puis qu'il rejoigne effectivement).
      Utilisez `rocketpool odao propose setting proposal-action-timespan `value`` pour modifier la durée pendant laquelle cette action secondaire peut
      être exécutée après l'exécution de la proposition.
      L'utilisateur ne pourra pas effectuer cette action _après_ cette fenêtre ; si l'action n'est pas effectuée à temps, la proposition
      est essentiellement invalide.

      `value` est une durée formatée en chaîne, telle que `1h30m45s` pour une heure, trente minutes et quarante-cinq
      secondes.
      Elle n'accepte pas les jours ; pour plusieurs jours, utilisez simplement le nombre total d'heures.

      #### scrub-period

      Utilisez `rocketpool odao propose setting scrub-period value` pour modifier la durée de la "période de scrub" (le temps
      entre le moment où un nouveau minipool entre dans le statut `prelaunch` et entre dans le statut `staking`).
      L'Oracle DAO dispose de ce temps pour vérifier les nouveaux minipools pour l'[exploit des informations d'identification de retrait](https://github.com/rocket-pool/rocketpool-research/blob/master/Reports/withdrawal-creds-exploit) et
      les scrubber si l'exploit est détecté, garantissant ainsi que les fonds de rETH ne sont pas volés.
      Cette tâche est effectuée automatiquement par le démon `watchtower`.
      Comme la vérification est généralement effectuée en quelques minutes, cette valeur est simplement conçue pour agir comme un tampon d'assurance
      dans le cas où l'Oracle DAO ne peut pas parvenir à un consensus en raison d'une défaillance de nœud ; les membres disposent de ce temps pour
      résoudre le problème et atteindre le quorum sur le scrubbing d'un minipool exploité.

      `value` est une durée formatée en chaîne, telle que `1h30m45s` pour une heure, trente minutes et quarante-cinq
      secondes.
      Elle n'accepte pas les jours ; pour plusieurs jours, utilisez simplement le nombre total d'heures.
    </Tab>
    <Tab label="Mises à niveau de contrats">
      Les mises à niveau de contrats sont actuellement en dehors de la portée de la CLI.
      Les transactions doivent être soumises manuellement ; veuillez consulter l'équipe Rocket Pool si vous souhaitez apprendre comment
      proposer une mise à niveau de contrat au réseau.
    </Tab>

  </Tabs>
</div>

## Afficher les propositions

Pour afficher un bref résumé de toutes les propositions dans l'historique du protocole, utilisez `rocketpool odao proposals list`.
Cela triera les propositions par leur statut et montrera qui l'a proposée et ce qu'elle fait.

Pour afficher les détails d'une proposition spécifique, utilisez `rocketpool odao proposals details value` où `value` est l'ID de la proposition que vous souhaitez afficher.
Cela affichera une ventilation complète des informations de la proposition, y compris qui l'a créée, quand elle a été créée, le corps de la charge utile, combien de membres ont voté en sa faveur, combien de membres ont voté contre elle, et si votre nœud a déjà voté dessus.

## Voter sur les propositions

Pour voter sur une proposition, utilisez la commande suivante :

```shell
rocketpool odao proposals vote
```

Cela vous fournira une boîte de dialogue interactive vous demandant sur quelle proposition vous souhaitez voter, et si vous souhaitez voter en sa faveur ou contre elle.
Suivez attentivement les invites pour compléter le vote.

## Exécuter les propositions

Lorsqu'une proposition a reçu suffisamment de votes en sa faveur pour atteindre le quorum, n'importe quel membre de l'Oracle DAO peut alors _exécuter_ la proposition (appliquer ses changements) en utilisant la commande suivante :

```shell
rocketpool odao proposals execute
```

Cela vous fournira une boîte de dialogue interactive vous demandant quelle proposition vous souhaitez exécuter.
Suivez attentivement les invites pour compléter l'exécution.
