---
next:
  text: Secourir un minipool dissous
  link: "/fr/node-staking/rescue-dissolved"
---

# Arrêter un minipool

## Sortir votre validateur

Lorsque vous avez décidé de ne plus vouloir exécuter un minipool et de vouloir accéder au solde complet verrouillé sur la Beacon Chain, vous devrez suivre plusieurs étapes :

1. Envoyer une demande de sortie volontaire pour le validateur du minipool depuis la Beacon Chain.
2. Attendre que votre validateur sorte.
3. Attendre que le solde de votre validateur soit retiré vers votre minipool sur la couche d'exécution.
4. Fermer le minipool pour distribuer les récompenses et accéder aux fonds

Nous couvrirons chaque étape ci-dessous.

### Envoyer la demande de sortie

Si vous souhaitez sortir le validateur attaché à un minipool, exécutez la commande suivante :

```shell
rocketpool minipool exit
```

Une liste de minipools pouvant être sortis vous sera présentée :

```
Please select a minipool to exit:
1: All available minipools
2: 0x7E5700bcd65B1770bA68abB288D3f53814d376aC (staking since 2023-02-08, 06:33 +0000 UTC)
3: 0xd8E804cFA64ADb386F52DB20717810130c90f674 (staking since 2023-02-08, 06:33 +0000 UTC)
```

Une fois que vous confirmez vouloir sortir, votre nœud enverra une demande de sortie volontaire à la Beacon Chain.
Ce n'est **pas** une transaction normale de la couche d'exécution, vous n'avez donc pas besoin de payer de gas pour cela.

Si vous avez besoin de la clé publique du validateur pour le minipool que vous venez de sortir, vous pouvez la récupérer en utilisant `rocketpool minipool status`.
Vous pouvez voir le statut de sortie de votre validateur sur un explorateur de Beacon Chain tel que [https://beaconcha.in](https://beaconcha.in) (ou [https://hoodi.beaconcha.in](https://hoodi.beaconcha.in) pour le testnet Hoodi).
Il faudra un certain temps pour que votre statut soit mis à jour, mais une fois fait, vous le verrez dans l'état "exiting" :

<img src="./images/exiting.png" width="100%" height="auto" />

Ici, vous pouvez voir que le statut est `Exiting`, l'epoch à laquelle il sortira est mis en évidence (5224), et l'icône "Exited" clignotera en vert pour indiquer que l'opération est en cours.
Il peut falloir un certain temps pour que votre validateur sorte, _surtout_ s'il y a un grand nombre de validateurs sortant de la Beacon Chain en même temps ; le protocole est conçu pour ne permettre qu'à un petit nombre de validateurs de sortir par epoch, vous devrez peut-être attendre votre tour.

Une fois votre epoch de sortie passée, votre validateur sortira officiellement de la chaîne et n'attestera ni ne proposera plus de blocs.
Vous pouvez le confirmer dans vos logs de client validateur, ou sur l'explorateur :

<img src="./images/exited.png" width="100%" height="auto" />

Le statut est passé à `Exited` et il y a du texte en dessous qui indique votre **epoch de retrait** (qui devrait être 256 epochs après votre sortie, soit environ 27 heures).
Beaconcha.in fournit également commodément les horodatages locaux pour le moment où votre validateur sortira et quand il sera retirable.

Une fois qu'il est entré dans l'état **withdrawable**, votre validateur sera mis en file d'attente par la Beacon Chain pour la distribution des récompenses.
Cette file d'attente dépend du nombre de validateurs en cours de retrait.
Une fois que c'est votre tour, la Beacon Chain enverra _automatiquement_ votre solde à l'adresse de votre minipool sur la couche d'exécution.
À ce stade, vous pouvez y accéder en utilisant la CLI Smartnode pour effectuer une distribution.

### Distribuer les récompenses complètes

::: tip NOTE
Ce processus nécessite que votre validateur soit sorti de la Beacon Chain et que le solde de votre validateur ait été transféré au contrat minipool.
Si vous avez besoin d'un rappel sur la façon de procéder, veuillez consulter la section [**Sortir votre validateur**](#sortir-votre-validateur) ci-dessus - revenez ici une fois que vous avez terminé.
:::

Si vous avez sorti votre validateur de la Beacon Chain et que votre solde a été déposé dans le contrat minipool, vous pouvez retirer en toute sécurité le tout en une seule commande.
Contrairement à la [distribution manuelle](./skimming#distribution-manuelle), ce processus va en fait **finaliser** votre minipool, ce qui le ferme et le rend inactif.
Une fois que votre solde a été retiré de la Beacon Chain et que vous avez suivi le processus suivant pour accéder aux fonds, la mission du minipool est terminée.

Pour récupérer les fonds et fermer le minipool, exécutez la commande suivante :

```shell
rocketpool minipool close
```

Cela vous présentera une liste de minipools éligibles à la fermeture :

```
Please select a minipool to close:
1: All available minipools
2: 0xd8E804cFA64ADb386F52DB20717810130c90f674 (32.007209 ETH available, 8.002559 ETH is yours plus a refund of 0.000000 ETH)
```

Ici, vous pouvez voir le solde total pour chaque minipool éligible, combien de ce solde vous sera distribué, et combien de ce solde vous est réservé en tant que remboursement (qui contourne la distribution).

Sélectionnez le minipool que vous souhaitez distribuer et fermer dans la liste, confirmez l'action et attendez que votre transaction soit validée.
Une fois cela fait, votre part du solde du minipool (et votre remboursement) sera envoyée à votre adresse de retrait, et le minipool entrera dans l'état `finalized`.

Vous pouvez le vérifier en regardant la transaction sur un explorateur de blocs ; par exemple, voir [la transaction de fermeture du minipool ci-dessus (testnet Goerli)](https://goerli.etherscan.io/tx/0xe81415b3b66f9b42d43ac17a0983e792725726c9fdd35ac855745bd12a053509).

### Dé-staker le RPL

À ce stade, votre RPL effectif sera mis à jour pour retirer ce minipool du calcul.
Vous pouvez maintenant dé-staker tout RPL que vous avez qui vous ferait dépasser le seuil de 60% d'ETH obligé.

Pour dé-staker le RPL du nœud, exécutez la commande suivante :

```shell
rocketpool node withdraw-rpl
```

::: tip NOTE
Il y a deux limitations sur les retraits RPL :

Le RPL ne peut pas être retiré dans les 28 jours suivant le staking (ou le re-staking) de RPL. Faites attention si vous réclamez ces récompenses avant de fermer votre minipool, si vous re-stakez n'importe quel montant de récompenses RPL, vous ne pourrez pas retirer de montant de RPL pendant 28 jours depuis la dernière action de staking.

Le RPL peut être retiré jusqu'à 60% de votre total d'ETH obligé. Sur une sortie complète, cela signifie que tout peut être retiré ; pour les sorties partielles, planifiez en gardant cette limite à l'esprit.
:::

## Une note sur l'ancien délégué

Le **délégué de minipool original** attribué à chaque minipool depuis le lancement de Rocket Pool jusqu'au déploiement d'Atlas a été conçu avec deux hypothèses à l'esprit :

1. La seule fois où votre minipool aura un solde est après que le validateur soit sorti de la Beacon Chain.
2. L'Oracle DAO changera l'état de votre minipool de "staking" à "withdrawable" une fois que le solde aura été transféré de la Beacon Chain au contrat minipool.

Le premier point n'est clairement plus pertinent maintenant qu'Ethereum est mis à niveau pour prendre en charge le skimming.
Le deuxième point n'est _également_ plus vrai, car l'Oracle DAO ne marquera **plus** les minipools "withdrawable".
C'était une décision de conception intentionnelle pour réduire le pouvoir que l'Oracle DAO exerce sur les opérateurs de nœud Rocket Pool et leur permettre d'accéder aux récompenses sans aucune exigence supplémentaire de parties de confiance.

En raison de ces lacunes, la CLI Smartnode **ne prend plus en charge** les retraits ou la distribution de fonds sur le délégué de minipool original.
Si vous souhaitez accéder à vos récompenses, vous **devez** passer au délégué Atlas qui prend en charge les nouvelles conditions de retrait listées ci-dessus.

::: danger DANGER
Si vous êtes un utilisateur avancé et contournez la CLI pour invoquer la fonctionnalité de distribution sur le contrat directement via un outil tiers, soyez averti des éléments suivants :

1. La fonction de distribution du délégué sera annulée si le solde du minipool est **inférieur à 16 ETH**. Les soldes inférieurs à 16 ETH **ne peuvent pas être accessibles.**
2. Si le minipool a **entre 16 et 32 ETH** dans son solde, la distribution par le délégué original supposera que votre validateur a été **slashé**. Il retournera 16 ETH au pool de staking et vous donnera ce qui reste. Il ne fonctionnera _correctement_ que si le solde du minipool est supérieur à 32 ETH.
3. Le minipool n'entrera jamais dans l'état `finalized` car l'Oracle DAO ne le marquera jamais comme `withdrawable`, donc même si vous pouvez accéder à votre ETH, **votre RPL sera verrouillé** jusqu'à ce que vous passiez au délégué Atlas.

En raison de ces points, nous **recommandons fortement** de simplement passer au délégué Atlas dès le départ et de les éviter entièrement.
:::
