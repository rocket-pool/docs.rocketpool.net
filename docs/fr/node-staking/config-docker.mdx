import { Tab, Tabs } from "@rspress/core/theme";
import ECSelection from "./images/tui-ec-selection.png";
import tuiExternalEC from "./images/tui-external-ec.png";
import tuiLocalCC from "./images/tui-local-cc.png";
import tuiLocalGraffiti from "./images/tui-local-graffiti.png";
import tuiLocalCheckpoint from "./images/tui-local-checkpoint.png";
import tuiLocalDD from "./images/tui-local-dd.png";
import tuiExternalLH from "./images/tui-external-lh.png";
import tuiExternalGraffiti from "./images/tui-external-graffiti.png";
import tuiExternalDD from "./images/tui-external-dd.png";
import tuiExternalPrysm from "./images/tui-external-prysm.png";
import tuiExternalTeku from "./images/tui-external-teku.png";

# Configuration de la pile Smartnode (Docker / Mode Hybride)

Exécuter des clients de couche d'exécution et de couche de consensus complets peut être intimidant ; il existe plusieurs options parmi lesquelles choisir et chacune d'entre elles possède une pléthore de paramètres différents.
Heureusement, le Smartnode est conçu pour masquer toute cette complexité afin que la configuration soit rapide et facile, tout en vous donnant la liberté de tout personnaliser si vous le souhaitez.

Dans cette section, nous allons passer en revue les différentes méthodes de configuration du Smartnode si vous utilisez la **configuration basée sur Docker** ou une **configuration hybride** où vous vous connectez à des clients d'exécution ou de consensus gérés en externe (par exemple, des clients que vous gérez en dehors du Smartnode pour le staking solo).

::: warning NOTE
Si vous utilisez le mode natif sans Docker, veuillez consulter le [guide de configuration native](./config-native) à la place.
:::

Il existe trois façons de le configurer :

- Via l'[interface utilisateur de l'assistant](#configuration-via-lassistant) - c'est la façon la plus simple. Il ne vous pose que quelques questions de base et utilise des paramètres par défaut bien testés pour le reste. C'est ce qui vous sera présenté lorsque vous exécuterez `rocketpool service config` pour la première fois.
- Via l'[interface utilisateur du gestionnaire de paramètres](#configuration-via-le-gestionnaire-de-parametres) - cela vous donne accès à tous les paramètres du Smartnode afin que vous puissiez tout personnaliser autant que vous le souhaitez.
- Sans interface via la [ligne de commande](#configuration-via-la-ligne-de-commande) - c'est une option pour les personnes qui exécutent le Smartnode dans un environnement sans interface (non interactif) et qui doivent le configurer automatiquement.

Choisissez le mode sur lequel vous souhaitez en savoir plus dans la liste ci-dessus, ou parcourez simplement chaque option ci-dessous.

## Configuration via l'assistant

Pour démarrer le processus de configuration, exécutez la commande suivante :

```shell
rocketpool service config
```

Cela lancera une interface utilisateur basée sur le terminal qui vous permettra de configurer rapidement et facilement votre nœud, tout en offrant un contrôle facultatif à grain fin sur chaque paramètre pour une personnalisation avancée.

::: tip NOTE
Si vous avez déjà configuré le Smartnode, vous serez plutôt accueilli par le [gestionnaire de paramètres](#configuration-via-le-gestionnaire-de-parametres).
Vous pouvez choisir de rouvrir l'assistant à partir de là si vous le préférez, et tous vos paramètres existants seront présélectionnés pour vous.
:::

Lorsque vous exécutez l'interface utilisateur de configuration pour la première fois (ou si vous choisissez d'exécuter à nouveau l'assistant ultérieurement), vous serez présenté avec un écran qui ressemble à ceci :

<img src="./images/tui-first-time.png" width="100%" height="auto" />

::: tip ASTUCE
Pour utiliser l'assistant, **appuyez sur les `touches fléchées` (haut/bas/gauche/droite) pour naviguer entre les éléments tels que les boutons (choix) ou les zones de texte**.
Vous pouvez également utiliser `Tab` et `Shift+Tab` si vous préférez - cela fera la même chose.

Pour les boutons, **celui qui est actuellement sélectionné sera surligné en vert**.
Ceux en noir ne sont pas sélectionnés.
Dans la capture d'écran ci-dessus, `Next` est actuellement sélectionné et `Quit` ne l'est pas.

**Appuyez sur `Entrée` ou `Espace` pour sélectionner un bouton**, analogue à cliquer dessus avec la souris.

**Appuyez sur `Échap` pour revenir à la boîte de dialogue précédente** si vous avez changé d'avis sur quelque chose.
Cela sera utile au fur et à mesure que vous progresserez dans les différentes pages de l'assistant.

**Maintenez `Ctrl` et appuyez sur `C` à tout moment pour quitter l'assistant sans rien enregistrer**.

Par exemple, sur l'écran ci-dessus, vous pourriez appuyer sur les touches fléchées `gauche` et `droite` pour vous déplacer entre les boutons `Next` et `Quit`.

Appuyer sur `Entrée` lorsque `Next` est sélectionné passera à l'écran suivant.
Appuyer sur `Entrée` lorsque `Quit` est sélectionné quittera l'assistant sans enregistrer.
:::

Lorsque vous êtes prêt à commencer, appuyez sur `Next`.

### Choix d'un réseau

Dans l'écran suivant, il vous sera demandé de choisir le réseau que vous souhaitez utiliser :

<img src="./images/tui-network.png" width="100%" height="auto" />

Vous pouvez mettre en surbrillance les différents choix avec les touches fléchées `Haut` et `Bas` (ou `Tab` et `Shift+Tab`).
Lorsque vous changez de choix, la zone **Description** à droite vous montrera une brève description de chaque option.
Cela est vrai pour toutes les pages basées sur des choix dans l'assistant, pas seulement pour la sélection du réseau, vous verrez donc fréquemment ce style de page.

Si vous souhaitez vous entraîner à exécuter un nœud Rocket Pool sur le réseau de test Hoodi avec de faux ETH et RPL que vous pouvez obtenir gratuitement, sélectionnez **Hoodi Testnet**.

Si vous êtes prêt à créer un véritable nœud Rocket Pool sur Mainnet pour gagner de vraies récompenses, sélectionnez **Mainnet**.

### Mode client

Deux options vous seront présentées pour le mode client :

<img src="./images/tui-client-mode.png" width="100%" height="auto" />

**Géré localement** (également connu sous le nom de **"Mode Docker"**) est le choix par défaut.
Utilisez-le si vous n'avez pas encore de paire de clients et que vous souhaitez que le Smartnode en gère une pour vous.
En choisissant cela, le Smartnode créera, configurera et gérera une paire de clients d'exécution et de consensus en tant que conteneurs Docker.
Ne vous inquiétez pas, vous pourrez choisir _quel_ client vous voulez exécuter ensuite.

**Géré en externe** (également connu sous le nom de **"Mode Hybride"**) est un choix pratique pour les utilisateurs qui ont déjà une paire de clients d'exécution et de consensus en cours d'exécution ailleurs qu'ils gèrent manuellement.
En choisissant cela, le Smartnode se connectera simplement à vos clients existants et n'en exécutera pas un lui-même.
Par exemple, les utilisateurs peuvent l'utiliser pour se connecter aux clients qu'ils utilisent actuellement pour le staking solo ; de cette façon, ils n'ont pas besoin d'avoir deux copies distinctes des clients.

:::warning NOTE
Depuis la fusion de la couche d'exécution et de la couche de consensus, vous _ne pouvez pas_ mélanger ces modes (par exemple, vous ne pouvez pas avoir un client d'exécution local mais un client de consensus géré en externe).
Vous devez choisir soit tout géré localement, soit tout géré en externe.
:::

### Configuration du client d'exécution

Choisissez le mode que vous souhaitez utiliser pour gérer votre client d'exécution et suivez les étapes de l'onglet correspondant ci-dessous :

<div className="p-3">
  <Tabs>
    <Tab label="Géré localement">
      Si vous souhaitez que le Smartnode gère un client d'exécution pour vous, l'écran suivant vous demandera de choisir un client :

      <img src={ECSelection} width="100%" height="auto"/>

      Veuillez vous référer à la section [Choisir vos clients ETH](/fr/node-staking/eth-clients#execution-clients) pour une description de chaque option.
      Une fois que vous avez fait votre choix, cliquez sur l'onglet approprié ci-dessous pour apprendre à le configurer :

      Si vous choisissez **Geth**, **Besu** ou **Nethermind**, l'assistant gérera toute la configuration pour vous.
      Vous pouvez ajuster manuellement certains de ses paramètres à la fin de ce processus, mais les valeurs par défaut qu'il utilise sont tout à fait appropriées pour l'exploitation du nœud.
      Vous pouvez passer à la section suivante.


      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTE</p>
        **Ouvrez le port P2P dans la configuration de redirection de port de votre routeur**. Configurez-le pour rediriger le **port 30303** sur TCP et UDP vers l'adresse IP locale de votre machine.
        De cette façon, d'autres clients de consensus peuvent le découvrir et communiquer avec lui de l'extérieur. Cela aidera votre client de consensus à se synchroniser rapidement et à améliorer les performances (et donc les récompenses).

        Chaque routeur a une façon différente de faire cela, donc **vous devrez consulter le manuel de votre routeur sur la façon de configurer la redirection de port**.
      </p>

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTE</p>
        Parce que le Smartnode s'exécutera dans son propre conteneur Docker, il utilisera le réseau interne de Docker.
        Vous ne pourrez pas utiliser des noms d'hôte comme `localhost` ou `127.0.0.1` ici ; si votre client d'exécution s'exécute sur la même machine que le Smartnode, vous devrez fournir l'adresse IP LAN de la machine à la place.
      </p>

      Et voilà, votre client d'exécution est prêt !
    </Tab>
    <Tab label="Externe">
      Pour un client d'exécution géré en externe, l'écran suivant vous invitera à saisir les URL de son API RPC basée sur HTTP (web3) et de son API RPC basée sur Websocket :

      <img src={tuiExternalEC} width="100%" height="auto"/>

      Le Smartnode utilisera l'URL HTTP pour communiquer avec lui et effectuer des activités blockchain, telles que l'interrogation de l'état de la chaîne et la soumission de transactions.
      **Si vous n'avez pas déjà activé le port API de votre client et qu'il n'est pas accessible depuis votre machine Smartnode, vous devrez le configurer maintenant.**
      Les instructions varient d'un client à l'autre ; consultez la documentation de votre client pour apprendre à configurer le point de terminaison HTTP RPC.

      L'URL Websocket n'est pertinente que si vous en avez besoin pour votre propre usage ; le Smartnode ne l'utilise pas.
      Vous pouvez la laisser vide si vous n'en avez pas besoin.

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTE</p>
        Parce que le Smartnode s'exécutera dans son propre conteneur Docker, il utilisera le réseau interne de Docker.
        Vous ne pourrez pas utiliser des noms d'hôte comme `localhost` ou `127.0.0.1` ici ; si votre client d'exécution de secours s'exécute sur la même machine que le Smartnode, vous devrez fournir l'adresse IP LAN de la machine à la place.
      </p>

      Lorsque vous êtes satisfait de vos choix de client d'exécution de secours, passez à l'étape suivante.
    </Tab>

  </Tabs>
</div>

### Configuration du client de consensus

Maintenant que vous avez un client d'exécution prêt, la tâche suivante consiste à configurer le client de consensus.
Le "mode" (local ou externe) sera hérité du choix que vous avez utilisé pour votre client d'exécution plus tôt.

Choisissez le mode que vous avez sélectionné précédemment dans les onglets ci-dessous :

<div className="p-3">
  <Tabs>
    <Tab label="Géré localement">
      Si vous souhaitez que le Smartnode gère un client de consensus pour vous, l'écran suivant vous demandera de choisir un client :

      <img src={tuiLocalCC} width="100%" height="auto"/>

      **Le choix préféré** pour la santé globale et la diversité du réseau est le choix **Aléatoire (recommandé)**, qui choisira au hasard parmi l'un des quatre clients de consensus pris en charge pour vous.

      Si vous préférez choisir un client explicite, veuillez vous référer à la section [Choisir vos clients ETH](./eth-clients#eth2-clients) pour une description de chaque option afin que vous puissiez prendre une décision éclairée.


      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTE</p>
        Il existe deux conditions qui vous inviteront avec des avertissements en fonction de la sélection du client :

        - Le client sélectionné est actuellement [un client supermajoritaire](https://clientdiversity.org/), ce qui signifie qu'une majorité malsaine de validateurs sur la Beacon Chain l'utilisent, ce qui menace la stabilité du réseau

        - Le client sélectionné est **trop gourmand en ressources** pour le matériel que vous utilisez actuellement

        Si l'un de ces cas est vrai pour votre client choisi, vous serez averti et invité à choisir un autre client.
        Vous avez la possibilité de continuer à utiliser celui que vous avez sélectionné, mais vous devez être conscient des risques en le faisant.
      </p>

      Une fois que vous avez fait votre choix ou qu'un client aléatoire vous a été attribué, cliquez sur l'onglet approprié ci-dessous pour apprendre à le configurer :

      <div className="p-3">
        <Tabs>
          <Tab label="Lighthouse">
            La première option dans la configuration de Lighthouse vous demandera le message **graffiti** de votre validateur :

            <img src={tuiLocalGraffiti} width="100%" height="auto"/>

            Il s'agit d'un message personnalisé facultatif que vous pouvez joindre à tous les blocs que vous proposez sur la Beacon Chain.
            Le message sera conservé pour toujours, alors pensez-y comme une façon amusante de laisser votre marque !

            **Notez que la longueur maximale du graffiti est de 16 caractères.**

            Si vous souhaitez voir quelques exemples de ce que les validateurs utilisent pour le Graffiti aujourd'hui, [jetez un œil ici](https://beaconcha.in/blocks).

            Ensuite, il y a une option pour activer ou désactiver la **synchronisation par point de contrôle** :

            <img src={tuiLocalCheckpoint} width="100%" height="auto"/>

            Lighthouse a la capacité de se synchroniser instantanément au dernier bloc sur le réseau Beacon Chain en se connectant à un nœud Beacon existant en qui vous avez confiance.
            Ceci est préférable à la synchronisation conventionnelle car cela ne nécessite aucun temps (alors que la synchronisation conventionnelle peut prendre des jours) et offre certains avantages de sécurité.
            Consultez [leur documentation sur la synchronisation par point de contrôle](https://lighthouse-book.sigmaprime.io/checkpoint-sync.html) pour plus d'informations si vous êtes curieux.

            Vous pouvez entrer l'URL de n'importe quel nœud Beacon qui fournit un accès à son API REST ici.

            Voir [la section ci-dessous sur la synchronisation par point de contrôle](#synchronisation-par-point-de-controle-beacon-chain) si vous souhaitez l'utiliser.

            La dernière question vous demandera si vous souhaitez activer la protection Doppelgänger :

            <img src={tuiLocalDD} width="100%" height="auto"/>

            Lighthouse prend en charge une fonctionnalité appelée [détection Doppelgänger](https://lighthouse-book.sigmaprime.io/validator-doppelganger.html).
            En un mot, cette fonctionnalité manquera **intentionnellement** quelques attestations après le redémarrage du client validateur de Lighthouse ; ce faisant, il écoutera pour voir si des attestations sont toujours envoyées au réseau en utilisant vos clés de validateur.

            Idéalement, il n'y aurait aucune attestation (ce qui signifie qu'aucune autre machine n'utilise vos clés de validateur).
            Après sa courte période d'attente, Lighthouse commencerait à valider normalement.

            _Cependant_, s'il _y a_ une autre machine exécutant vos clés de validateur attachées, alors Lighthouse s'arrêtera immédiatement et émettra un message d'erreur dans ses fichiers journaux.
            La raison en est que s'il devait commencer à attester également, vous commenceriez à **double attester**, ce qui est une **infraction punissable**.
            Lorsqu'il est sanctionné, votre validateur sera expulsé de force de la Beacon Chain et vous serez pénalisé d'une quantité importante d'ETH.

            La plupart du temps, la détection de doppelgänger ne se traduira que par quelques attestations manquées après le redémarrage d'un client.
            Dans les situations où vous déplacez votre validateur vers une nouvelle machine ou où vous changez pour un nouveau client Beacon, cependant, **la détection de doppelgänger peut vous empêcher d'être sanctionné en attestant deux fois accidentellement**.

            Considérez-la comme une assurance bon marché pour vos minipools ; vous manquerez un peu de profit insignifiant chaque fois que vous redémarrerez, mais vous pouvez être assez confiant que vous n'exécuterez pas accidentellement vos clés à deux endroits et ne serez pas sanctionné pour cela.

            À partir de la version 4.5.0, Lighthouse a une option pour établir des connexions P2P de manière plus efficace en utilisant le [protocole QUIC](https://en.wikipedia.org/wiki/QUIC). Si vous êtes prêt à utiliser cette fonctionnalité, vous devrez définir un champ supplémentaire "port QUIC P2P" dans les paramètres ETH2, et le rediriger vers votre nœud dans la configuration de redirection de port de votre routeur. Le port QUIC P2P par défaut est 8001 (UDP). Assurez-vous d'éviter les collisions avec les ports déjà utilisés par votre nœud (ou les nœuds de secours/testnet). Assurez-vous également que le même port est ouvert si vous utilisez un pare-feu sur votre nœud (vérifiez `ufw status`).
            Pour vérifier si la configuration QUIC fonctionne, vous devriez voir un nombre à 2 chiffres après `libp2p_quic_peers` lors de l'exécution de `docker run --network rocketpool_net curlimages/curl http://eth2:9100/metrics | grep libp2p_peers_multi`.

          </Tab>
          <Tab label="Nimbus">
            La première option dans la configuration de Nimbus vous demandera le message **graffiti** de votre validateur :

            <img src={tuiLocalGraffiti} width="100%" height="auto"/>

            Il s'agit d'un message personnalisé facultatif que vous pouvez joindre à tous les blocs que vous proposez sur la Beacon Chain.
            Le message sera conservé pour toujours, alors pensez-y comme une façon amusante de laisser votre marque !

            **Notez que la longueur maximale du graffiti est de 16 caractères.**

            Si vous souhaitez voir quelques exemples de ce que les validateurs utilisent pour le Graffiti aujourd'hui, [jetez un œil ici](https://beaconcha.in/blocks).

            Ensuite, il y a une option pour activer ou désactiver la **synchronisation par point de contrôle** :

            <img src={tuiLocalCheckpoint} width="100%" height="auto"/>

            Nimbus a la capacité de se synchroniser instantanément au dernier bloc sur le réseau Beacon Chain en se connectant à un nœud Beacon existant en qui vous avez confiance.
            Ceci est préférable à la synchronisation conventionnelle car cela ne nécessite aucun temps (alors que la synchronisation conventionnelle peut prendre des jours) et offre certains avantages de sécurité.
            Consultez [leur documentation sur la synchronisation par point de contrôle](https://nimbus.guide/trusted-node-sync.html) pour plus d'informations si vous êtes curieux.

            Vous pouvez entrer l'URL de n'importe quel nœud Beacon qui fournit un accès à son API REST ici.

            Voir [la section ci-dessous sur la synchronisation par point de contrôle](#synchronisation-par-point-de-controle-beacon-chain) si vous souhaitez l'utiliser.

            La dernière question vous demandera si vous souhaitez activer la protection Doppelgänger :

            <img src={tuiLocalDD} width="100%" height="auto"/>

            Nimbus prend en charge une fonctionnalité appelée [protection Doppelgänger](https://nimbus.guide/faq.html#why-does-my-validator-miss-two-epochs-of-attestations-after-restarting).
            En un mot, cette fonctionnalité manquera **intentionnellement** quelques attestations après le redémarrage de Nimbus ; ce faisant, il écoutera pour voir si des attestations sont toujours envoyées au réseau en utilisant vos clés de validateur.

            Idéalement, il n'y aurait aucune attestation (ce qui signifie qu'aucune autre machine n'utilise vos clés de validateur).
            Après sa courte période d'attente, Nimbus commencerait à valider normalement.

            _Cependant_, s'il _y a_ une autre machine exécutant vos clés de validateur attachées, alors Nimbus s'arrêtera immédiatement et émettra un message d'erreur dans ses fichiers journaux.
            La raison en est que s'il devait commencer à attester également, vous commenceriez à **double attester**, ce qui est une **infraction punissable**.
            Lorsqu'il est sanctionné, votre validateur sera expulsé de force de la Beacon Chain et vous serez pénalisé d'une quantité importante d'ETH.

            La plupart du temps, la détection de doppelgänger ne se traduira que par quelques attestations manquées après le redémarrage d'un client.
            Dans les situations où vous déplacez votre validateur vers une nouvelle machine ou où vous changez pour un nouveau client Beacon, cependant, **la détection de doppelgänger peut vous empêcher d'être sanctionné en attestant deux fois accidentellement**.

            Considérez-la comme une assurance bon marché pour vos minipools ; vous manquerez un peu de profit insignifiant chaque fois que vous redémarrerez, mais vous pouvez être assez confiant que vous n'exécuterez pas accidentellement vos clés à deux endroits et ne serez pas sanctionné pour cela.

          </Tab>
          <Tab label="Prysm">
            La première option dans la configuration de Prysm vous demandera le message **graffiti** de votre validateur :

            <img src={tuiLocalGraffiti} width="100%" height="auto"/>

            Il s'agit d'un message personnalisé facultatif que vous pouvez joindre à tous les blocs que vous proposez sur la Beacon Chain.
            Le message sera conservé pour toujours, alors pensez-y comme une façon amusante de laisser votre marque !

            **Notez que la longueur maximale du graffiti est de 16 caractères.**

            Si vous souhaitez voir quelques exemples de ce que les validateurs utilisent pour le Graffiti aujourd'hui, [jetez un œil ici](https://beaconcha.in/blocks).

            Ensuite, il y a une option pour activer ou désactiver la **synchronisation par point de contrôle** :

            <img src={tuiLocalCheckpoint} width="100%" height="auto"/>

            Prysm a la capacité de se synchroniser instantanément au dernier bloc sur le réseau Beacon Chain en se connectant à un nœud Beacon existant en qui vous avez confiance.
            Ceci est préférable à la synchronisation conventionnelle car cela ne nécessite aucun temps (alors que la synchronisation conventionnelle peut prendre des jours) et offre certains avantages de sécurité.
            Consultez [leur documentation sur la synchronisation par point de contrôle](https://docs.prylabs.network/docs/prysm-usage/checkpoint-sync) pour plus d'informations si vous êtes curieux.

            Vous pouvez entrer l'URL de n'importe quel nœud Beacon qui fournit un accès à son API REST ici.

            Voir [la section ci-dessous sur la synchronisation par point de contrôle](#synchronisation-par-point-de-controle-beacon-chain) si vous souhaitez l'utiliser.

            La dernière question vous demandera si vous souhaitez activer la protection Doppelgänger :

            <img src={tuiLocalDD} width="100%" height="auto"/>

            Prysm prend en charge une fonctionnalité appelée protection Doppelgänger.
            En un mot, cette fonctionnalité manquera **intentionnellement** quelques attestations après le redémarrage du client validateur de Prysm ; ce faisant, il écoutera pour voir si des attestations sont toujours envoyées au réseau en utilisant vos clés de validateur.

            Idéalement, il n'y aurait aucune attestation (ce qui signifie qu'aucune autre machine n'utilise vos clés de validateur).
            Après sa courte période d'attente, Prysm commencerait à valider normalement.

            _Cependant_, s'il _y a_ une autre machine exécutant vos clés de validateur attachées, alors Prysm s'arrêtera immédiatement et émettra un message d'erreur dans ses fichiers journaux.
            La raison en est que s'il devait commencer à attester également, vous commenceriez à **double attester**, ce qui est une **infraction punissable**.
            Lorsqu'il est sanctionné, votre validateur sera expulsé de force de la Beacon Chain et vous serez pénalisé d'une quantité importante d'ETH.

            La plupart du temps, la détection de doppelgänger ne se traduira que par quelques attestations manquées après le redémarrage d'un client.
            Dans les situations où vous déplacez votre validateur vers une nouvelle machine ou où vous changez pour un nouveau client Beacon, cependant, **la détection de doppelgänger peut vous empêcher d'être sanctionné en attestant deux fois accidentellement**.

            Considérez-la comme une assurance bon marché pour vos minipools ; vous manquerez un peu de profit insignifiant chaque fois que vous redémarrerez, mais vous pouvez être assez confiant que vous n'exécuterez pas accidentellement vos clés à deux endroits et ne serez pas sanctionné pour cela.

          </Tab>
          <Tab label="Teku">
            La première option dans la configuration de Teku vous demandera le message **graffiti** de votre validateur :

            <img src={tuiLocalGraffiti} width="100%" height="auto"/>

            Il s'agit d'un message personnalisé facultatif que vous pouvez joindre à tous les blocs que vous proposez sur la Beacon Chain.
            Le message sera conservé pour toujours, alors pensez-y comme une façon amusante de laisser votre marque !

            **Notez que la longueur maximale du graffiti est de 16 caractères.**

            Si vous souhaitez voir quelques exemples de ce que les validateurs utilisent pour le Graffiti aujourd'hui, [jetez un œil ici](https://beaconcha.in/blocks).

            La dernière question est une option pour activer ou désactiver la **synchronisation par point de contrôle** :

            <img src={tuiLocalCheckpoint} width="100%" height="auto"/>

            Teku a la capacité de se synchroniser instantanément au dernier bloc sur le réseau Beacon Chain en se connectant à un nœud Beacon existant en qui vous avez confiance.
            Ceci est préférable à la synchronisation conventionnelle car cela ne nécessite aucun temps (alors que la synchronisation conventionnelle peut prendre des jours) et offre certains avantages de sécurité.
            Consultez [leur documentation sur la synchronisation par point de contrôle](https://docs.teku.consensys.net/en/latest/HowTo/Get-Started/Checkpoint-Start/) pour plus d'informations si vous êtes curieux.

            Vous pouvez entrer l'URL de n'importe quel nœud Beacon qui fournit un accès à son API REST ici.

            Voir [la section ci-dessous sur la synchronisation par point de contrôle](#synchronisation-par-point-de-controle-beacon-chain) si vous souhaitez l'utiliser.
          </Tab>
          <Tab label="Lodestar">
            La première option dans la configuration de Lodestar vous demandera le message **graffiti** de votre validateur :

            <img src={tuiLocalGraffiti} width="100%" height="auto"/>

            Il s'agit d'un message personnalisé facultatif que vous pouvez joindre à tous les blocs que vous proposez sur la Beacon Chain.
            Le message sera conservé pour toujours, alors pensez-y comme une façon amusante de laisser votre marque !

            **Notez que la longueur maximale du graffiti est de 16 caractères.**

            Si vous souhaitez voir quelques exemples de ce que les validateurs utilisent pour le Graffiti aujourd'hui, [jetez un œil ici](https://beaconcha.in/blocks).

            Ensuite, il y a une option pour activer ou désactiver la **synchronisation par point de contrôle** :

            <img src={tuiLocalCheckpoint} width="100%" height="auto"/>

            Lodestar a la capacité de se synchroniser instantanément au dernier bloc sur le réseau Beacon Chain en se connectant à un nœud Beacon existant en qui vous avez confiance.
            Ceci est préférable à la synchronisation conventionnelle car cela ne nécessite aucun temps (alors que la synchronisation conventionnelle peut prendre des jours) et offre certains avantages de sécurité.
            Consultez [leur documentation sur la synchronisation par point de contrôle](https://chainsafe.github.io/lodestar/run/beacon-management/starting-a-node#checkpoint-sync) pour plus d'informations si vous êtes curieux.

            Vous pouvez entrer l'URL de n'importe quel nœud Beacon qui fournit un accès à son API REST ici.

            Voir [la section ci-dessous sur la synchronisation par point de contrôle](#synchronisation-par-point-de-controle-beacon-chain) si vous souhaitez l'utiliser.

            La dernière question vous demandera si vous souhaitez activer la protection Doppelgänger :

            <img src={tuiLocalDD} width="100%" height="auto"/>

            Lodestar prend en charge une fonctionnalité appelée détection Doppelgänger.
            En un mot, cette fonctionnalité manquera **intentionnellement** quelques attestations après le redémarrage du client validateur de Lodestar ; ce faisant, il écoutera pour voir si des attestations sont toujours envoyées au réseau en utilisant vos clés de validateur.

            Idéalement, il n'y aurait aucune attestation (ce qui signifie qu'aucune autre machine n'utilise vos clés de validateur).
            Après sa courte période d'attente, Lodestar commencerait à valider normalement.

            _Cependant_, s'il _y a_ une autre machine exécutant vos clés de validateur attachées, alors Lodestar s'arrêtera immédiatement et émettra un message d'erreur dans ses fichiers journaux.
            La raison en est que s'il devait commencer à attester également, vous commenceriez à **double attester**, ce qui est une **infraction punissable**.
            Lorsqu'il est sanctionné, votre validateur sera expulsé de force de la Beacon Chain et vous serez pénalisé d'une quantité importante d'ETH.

            La plupart du temps, la détection de doppelgänger ne se traduira que par quelques attestations manquées après le redémarrage d'un client.
            Dans les situations où vous déplacez votre validateur vers une nouvelle machine ou où vous changez pour un nouveau client Beacon, cependant, **la détection de doppelgänger peut vous empêcher d'être sanctionné en attestant deux fois accidentellement**.

            Considérez-la comme une assurance bon marché pour vos minipools ; vous manquerez un peu de profit insignifiant chaque fois que vous redémarrerez, mais vous pouvez être assez confiant que vous n'exécuterez pas accidentellement vos clés à deux endroits et ne serez pas sanctionné pour cela.

          </Tab>
        </Tabs>
      </div>

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTE</p>
        **Ouvrez le port P2P dans la configuration de redirection de port de votre routeur**. Configurez-le pour rediriger le **port 9001** sur TCP et UDP vers l'adresse IP locale de votre machine.
        De cette façon, d'autres clients de consensus peuvent le découvrir et communiquer avec lui de l'extérieur. Cela aidera votre client de consensus à se synchroniser rapidement et à améliorer les performances (et donc les récompenses).

        Chaque routeur a une façon différente de faire cela, donc **vous devrez consulter le manuel de votre routeur sur la façon de configurer la redirection de port**
      </p>
    </Tab>
    <Tab label="Géré en externe">
      Étant donné que chaque client de consensus a un comportement légèrement différent, le Smartnode doit savoir lequel vous utilisez en externe afin qu'il puisse adapter son propre comportement en conséquence.
      Commencez par choisir le client que vous avez dans la liste de l'écran suivant :

      <img src="./images/tui-external-cc.png" width="100%" height="auto"/>


      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTE</p>
        À l'heure actuelle, **Nimbus** n'est pas compatible avec le mode externe car il ne peut pas encore s'exécuter en tant que conteneur validateur (VC) autonome.
        Lorsque le client prendra en charge cette fonctionnalité, il sera ajouté à la liste ici.
      </p>

      Sélectionnez votre client dans les onglets ci-dessous pour apprendre à terminer sa configuration.

      <div className="p-3">
        <Tabs>
          <Tab label="Lighthouse">
            Commencez par spécifier l'URL de l'API de votre nœud Beacon Lighthouse :

            <img src={tuiExternalLH} width="100%" height="auto"/>

            Le Smartnode utilisera l'URL HTTP pour communiquer avec lui et effectuer des activités blockchain, telles que l'interrogation de l'état de la chaîne et la soumission de messages.
            **Si vous n'avez pas déjà activé le port API et qu'il n'est pas accessible depuis votre machine Smartnode, vous devrez le configurer maintenant.**
            Voir [la documentation de Lighthouse](https://lighthouse-book.sigmaprime.io/api-bn.html) pour des instructions sur la façon de procéder.

            <p className="rspress-directive warning">
              <p className="rspress-directive-title">NOTE</p>
              Parce que le Smartnode s'exécutera dans son propre conteneur Docker, il utilisera le réseau interne de Docker.
              Vous ne pourrez pas utiliser des noms d'hôte comme `localhost` ou `127.0.0.1` ici ; si votre client s'exécute sur la même machine que le Smartnode, vous devrez fournir l'adresse IP LAN de la machine à la place.
            </p>


            Ensuite, il vous demandera le message **graffiti** de votre validateur :

            <img src={tuiExternalGraffiti} width="100%" height="auto"/>

            Il s'agit d'un message personnalisé facultatif que vous pouvez joindre à tous les blocs que vous proposez sur la Beacon Chain.
            Le message sera conservé pour toujours, alors pensez-y comme une façon amusante de laisser votre marque !

            **Notez que la longueur maximale du graffiti est de 16 caractères.**

            Si vous souhaitez voir quelques exemples de ce que les validateurs utilisent pour le Graffiti aujourd'hui, [jetez un œil ici](https://beaconcha.in/blocks).

            La dernière question vous demandera si vous souhaitez activer la protection Doppelgänger :

            <img src={tuiExternalDD} width="100%" height="auto"/>

            Lighthouse prend en charge une fonctionnalité appelée [détection Doppelgänger](https://lighthouse-book.sigmaprime.io/validator-doppelganger.html).
            En un mot, cette fonctionnalité manquera **intentionnellement** quelques attestations après le redémarrage du client validateur de Lighthouse ; ce faisant, il écoutera pour voir si des attestations sont toujours envoyées au réseau en utilisant vos clés de validateur.

            Idéalement, il n'y aurait aucune attestation (ce qui signifie qu'aucune autre machine n'utilise vos clés de validateur).
            Après sa courte période d'attente, Lighthouse commencerait à valider normalement.

            _Cependant_, s'il _y a_ une autre machine exécutant vos clés de validateur attachées, alors Lighthouse s'arrêtera immédiatement et émettra un message d'erreur dans ses fichiers journaux.
            La raison en est que s'il devait commencer à attester également, vous commenceriez à **double attester**, ce qui est une **infraction punissable**.
            Lorsqu'il est sanctionné, votre validateur sera expulsé de force de la Beacon Chain et vous serez pénalisé d'une quantité importante d'ETH.

            La plupart du temps, la détection de doppelgänger ne se traduira que par quelques attestations manquées après le redémarrage d'un client.
            Dans les situations où vous déplacez votre validateur vers une nouvelle machine ou où vous changez pour un nouveau client Beacon, cependant, **la détection de doppelgänger peut vous empêcher d'être sanctionné en attestant deux fois accidentellement**.

            Considérez-la comme une assurance bon marché pour vos minipools ; vous manquerez un peu de profit insignifiant chaque fois que vous redémarrerez, mais vous pouvez être assez confiant que vous n'exécuterez pas accidentellement vos clés à deux endroits et ne serez pas sanctionné pour cela.

          </Tab>
          <Tab label="Prysm">
            Commencez par spécifier l'URL de l'API de votre nœud Beacon Prysm et l'URL de son API JSON-RPC :

            <img src={tuiExternalPrysm} width="100%" height="auto"/>

            Le Smartnode utilisera l'URL HTTP pour communiquer avec lui et effectuer des activités blockchain, telles que l'interrogation de l'état de la chaîne et la soumission de messages.
            Il préparera son client validateur Prysm avec l'URL JSON-RPC afin qu'il puisse communiquer avec votre nœud Beacon, car _le client validateur de Prysm ne peut actuellement pas fonctionner via l'API HTTP._

            **Si vous n'avez pas déjà activé les ports API et qu'ils ne sont pas accessibles depuis votre machine Smartnode, vous devrez les configurer maintenant.**
            Voir [la documentation de Prysm](https://docs.prylabs.network/docs/prysm-usage/parameters) pour des instructions sur la façon de procéder.
            **Vous devrez activer le `grpc-gateway` _et_ le `rpc-host`.**

            <p className="rspress-directive warning">
              <p className="rspress-directive-title">NOTE</p>
              Parce que le Smartnode s'exécutera dans son propre conteneur Docker, il utilisera le réseau interne de Docker.
              Vous ne pourrez pas utiliser des noms d'hôte comme `localhost` ou `127.0.0.1` ici ; si votre client s'exécute sur la même machine que le Smartnode, vous devrez fournir l'adresse IP LAN de la machine à la place.
            </p>


            Ensuite, il vous demandera le message **graffiti** de votre validateur :

            <img src={tuiExternalGraffiti} width="100%" height="auto"/>

            Il s'agit d'un message personnalisé facultatif que vous pouvez joindre à tous les blocs que vous proposez sur la Beacon Chain.
            Le message sera conservé pour toujours, alors pensez-y comme une façon amusante de laisser votre marque !

            **Notez que la longueur maximale du graffiti est de 16 caractères.**

            Si vous souhaitez voir quelques exemples de ce que les validateurs utilisent pour le Graffiti aujourd'hui, [jetez un œil ici](https://beaconcha.in/blocks).

            La dernière question vous demandera si vous souhaitez activer la protection Doppelgänger :

            <img src={tuiExternalDD} width="100%" height="auto"/>

            Prysm prend en charge une fonctionnalité appelée protection Doppelgänger.
            En un mot, cette fonctionnalité manquera **intentionnellement** quelques attestations après le redémarrage du client validateur de Prysm ; ce faisant, il écoutera pour voir si des attestations sont toujours envoyées au réseau en utilisant vos clés de validateur.

            Idéalement, il n'y aurait aucune attestation (ce qui signifie qu'aucune autre machine n'utilise vos clés de validateur).
            Après sa courte période d'attente, Prysm commencerait à valider normalement.

            _Cependant_, s'il _y a_ une autre machine exécutant vos clés de validateur attachées, alors Prysm s'arrêtera immédiatement et émettra un message d'erreur dans ses fichiers journaux.
            La raison en est que s'il devait commencer à attester également, vous commenceriez à **double attester**, ce qui est une **infraction punissable**.
            Lorsqu'il est sanctionné, votre validateur sera expulsé de force de la Beacon Chain et vous serez pénalisé d'une quantité importante d'ETH.

            La plupart du temps, la détection de doppelgänger ne se traduira que par quelques attestations manquées après le redémarrage d'un client.
            Dans les situations où vous déplacez votre validateur vers une nouvelle machine ou où vous changez pour un nouveau client Beacon, cependant, **la détection de doppelgänger peut vous empêcher d'être sanctionné en attestant deux fois accidentellement**.

            Considérez-la comme une assurance bon marché pour vos minipools ; vous manquerez un peu de profit insignifiant chaque fois que vous redémarrerez, mais vous pouvez être assez confiant que vous n'exécuterez pas accidentellement vos clés à deux endroits et ne serez pas sanctionné pour cela.

          </Tab>
          <Tab label="Teku">
            Commencez par spécifier l'URL de l'API de votre nœud Beacon Teku :

            <img src={tuiExternalTeku} width="100%" height="auto"/>

            Le Smartnode utilisera l'URL HTTP pour communiquer avec lui et effectuer des activités blockchain, telles que l'interrogation de l'état de la chaîne et la soumission de messages.
            **Si vous n'avez pas déjà activé le port API et qu'il n'est pas accessible depuis votre machine Smartnode, vous devrez le configurer maintenant.**
            Voir [la documentation de Teku](https://docs.teku.consensys.net/en/latest/Reference/CLI/CLI-Syntax/#rest-api-enabled) pour des instructions sur la façon de procéder.


            <p className="rspress-directive warning">
              <p className="rspress-directive-title">NOTE</p>
              Parce que le Smartnode s'exécutera dans son propre conteneur Docker, il utilisera le réseau interne de Docker.
              Vous ne pourrez pas utiliser des noms d'hôte comme `localhost` ou `127.0.0.1` ici ; si votre client s'exécute sur la même machine que le Smartnode, vous devrez fournir l'adresse IP LAN de la machine à la place.
            </p>

            Ensuite, il vous demandera le message **graffiti** de votre validateur :

            <img src={tuiExternalGraffiti} width="100%" height="auto"/>

            Il s'agit d'un message personnalisé facultatif que vous pouvez joindre à tous les blocs que vous proposez sur la Beacon Chain.
            Le message sera conservé pour toujours, alors pensez-y comme une façon amusante de laisser votre marque !

            **Notez que la longueur maximale du graffiti est de 16 caractères.**

            Si vous souhaitez voir quelques exemples de ce que les validateurs utilisent pour le Graffiti aujourd'hui, [jetez un œil ici](https://beaconcha.in/blocks).
          </Tab>

        </Tabs>
      </div>
    </Tab>

  </Tabs>
</div>

#### Synchronisation par point de contrôle Beacon Chain

La **synchronisation par point de contrôle** est une technique très utile que certains clients Beacon Chain prennent en charge.
Elle permet à votre client Beacon de se synchroniser instantanément avec l'ensemble de la Beacon Chain sans avoir à commencer depuis le début et à rattraper chaque bloc.
Cela signifie qu'au lieu de prendre **des jours**, votre client Beacon peut être prêt en quelques **minutes**.
Tout ce dont il a besoin est l'accès à un client Beacon existant en qui vous avez confiance.

Vous pouvez utiliser n'importe quel nœud Beacon qui fournit un accès à son API HTTP.
Actuellement, de nombreux opérateurs de nœuds utilisent les points de terminaison de synchronisation par point de contrôle - un service qui permet aux opérateurs de nœuds Rocket Pool de se synchroniser facilement par point de contrôle.
Le testnet Hoodi et le Mainnet sont tous deux pris en charge.
Une liste d'URL de synchronisation par point de contrôle peut être trouvée via le lien suivant :

- [URL de synchronisation par point de contrôle](https://eth-clients.github.io/checkpoint-sync-endpoints/)

Choisissez une URL de synchronisation par point de contrôle pertinente et collez-la dans le terminal lors de `rocketpool service config` lorsqu'il vous invite à saisir un fournisseur de synchronisation par point de contrôle.

Après cela, votre nœud Beacon se connectera automatiquement au nœud de synchronisation par point de contrôle lors de son premier démarrage et récupérera instantanément le dernier état de la chaîne !

::: warning NOTE
La synchronisation par point de contrôle ne se produira que si vous _n'avez pas encore de données Beacon Chain_.
En d'autres termes, si vous commencez à vous synchroniser normalement et décidez de vous synchroniser par point de contrôle plus tard, vous devrez d'abord supprimer vos données de chaîne pour que la synchronisation par point de contrôle fonctionne.
Cela peut facilement être fait avec la commande suivante :

```shell
rocketpool service resync-eth2
```

:::

### Nœud de secours

À partir de la version 1.5.0 de la pile Smartnode, vous pouvez fournir un client d'exécution et un client de consensus de "secours" qui peuvent prendre le relais de vos clients principaux s'ils tombent hors ligne (par exemple parce que vous utilisez Geth et devez l'élaguer).
Dans cette situation, votre machine de nœud principale sera toujours responsable de l'attestation et de la proposition de blocs avec les clés de validateur de vos minipools, mais elle se connectera à une machine externe pour interagir avec les chaînes de couche d'exécution et Beacon.

[Pour en savoir plus sur les nœuds de secours, consultez cette section](./fallback) et revenez ici lorsque vous avez terminé.

### Configuration des métriques

Rocket Pool est livré avec la possibilité d'afficher un tableau de bord détaillé montrant des métriques sur la santé matérielle de votre nœud, les mises à jour du système, les performances de votre validateur, vos récompenses, des informations sur l'ensemble du réseau Rocket Pool, et plus encore :

<img src="./images/nimbus-dashboard.png" width="100%" height="auto" />

La question suivante dans l'assistant vous demandera si vous souhaitez activer cela :

<img src="./images/tui-metrics.png" width="100%" height="auto" />

Si vous choisissez de l'activer, vous en apprendrez davantage sur sa configuration et son utilisation dans la section [Configuration du tableau de bord Grafana](./grafana) plus tard dans le processus.

::: warning NOTE
Toutes les données collectées par ce système **restent sur votre machine**.
Rocket Pool ne collecte aucune télémétrie et ne l'envoie pas à un service séparé.
C'est purement là pour que vous puissiez surveiller votre propre nœud !
:::

### Configuration MEV

Depuis la fusion des couches d'exécution et de consensus en septembre 2022, les validateurs Ethereum ont maintenant la capacité de gagner des frais prioritaires et de participer à la valeur extractible maximale (ou MEV pour faire court).

À partir de Smartnode v1.7.0, le MEV est maintenant _opt-out_ donc sa configuration est présentée dans le cadre de la configuration initiale, comme vous le voyez dans l'écran suivant :

<img src="./images/tui-mev-mode.png" width="100%" height="auto" />

[Veuillez lire notre guide MEV pour en savoir plus sur le MEV, sa configuration et ce qu'il faut faire dans cette section de l'assistant.](./mev)
Revenez ici lorsque vous avez terminé.

### Achèvement

Après cette question, vous avez terminé la configuration du Smartnode !
Vous verrez la boîte de dialogue suivante :

<img src="./images/tui-finished.png" width="100%" height="auto" />

Si vous êtes satisfait de votre configuration et êtes prêt à démarrer le Smartnode, cliquez sur `Save and Exit` ici et passez à la section [Sécurisation de votre nœud](./securing-your-node) ensuite.

Si vous souhaitez examiner tous les paramètres et personnaliser de nombreux paramètres supplémentaires qui n'ont pas été inclus dans l'assistant, cliquez sur `Review All Settings` et passez à la [section suivante](#configuration-via-le-gestionnaire-de-parametres).

## Configuration via le gestionnaire de paramètres

Si vous avez déjà exécuté `rocketpool service config`, au lieu d'être accueilli par l'assistant, vous verrez l'écran du **gestionnaire de paramètres** :

<img src="./images/tui-settings-manager.png" width="100%" height="auto" />

Il y a trois fonctionnalités principales de cet écran :

1. La **liste des catégories**, qui vous permet d'explorer les paramètres de chaque catégorie de la pile Smartnode
2. Le bouton **Review Changes and Save**, que vous pouvez utiliser lorsque vous êtes prêt à voir quels paramètres vous avez modifiés et à enregistrer la configuration mise à jour
3. Le bouton **Open the Config Wizard**, qui vous amènera à l'[assistant de configuration](#configuration-via-lassistant) si vous préférez cette interface à la place

::: tip ASTUCE
Pour utiliser le gestionnaire de paramètres, **appuyez sur les `touches fléchées` (haut/bas/gauche/droite) pour naviguer entre les options de la page d'accueil**.

Appuyez sur `Tab` pour passer **entre la liste des catégories (1) et les boutons (2 et 3)** en bas de l'écran.
Le bouton actuellement sélectionné sera **surligné en vert**.

**Appuyez sur `Entrée` ou `Espace` pour sélectionner un bouton**, analogue à cliquer dessus avec la souris.

**Maintenez `Ctrl` et appuyez sur `C` à tout moment pour quitter le gestionnaire de paramètres sans rien enregistrer**.
:::

Lorsque vous faites défiler la liste des catégories, chaque option aura une description utile qui apparaîtra dans la **zone de description** à droite de l'écran.
N'hésitez pas à les explorer ; rien de ce que vous ferez ne sera enregistré tant que vous ne passerez pas par la boîte de dialogue de révision via le bouton **Review Changes and Save**, et vous pouvez appuyer sur **Ctrl+C** à tout moment pour quitter sans enregistrer, vous ne risquez donc pas de gâcher quelque chose en jouant avec les paramètres ici.

### Configuration des paramètres

Depuis l'écran d'accueil, sélectionnez l'une des catégories avec la touche `Entrée` pour afficher les paramètres de cette catégorie.
Par exemple, voici l'écran de la catégorie **Smartnode and TX Fees** :

<img src="./images/tui-smartnode.png" width="100%" height="auto" />

Utilisez les `touches fléchées` pour vous déplacer vers le haut et vers le bas entre les paramètres.
Celui actuellement sélectionné aura un carré blanc à la fin (s'il s'agit d'une zone de texte ou d'une case à cocher), ou sera surligné en blanc (s'il s'agit d'un menu déroulant).

Appuyez sur `Échap` pour revenir à l'écran d'accueil du gestionnaire de paramètres lorsque vous avez terminé.

Lorsque vous faites défiler les paramètres, chacun affichera une brève description de ce qu'il fait dans la **zone de description** à droite.
Il affichera également la **valeur par défaut** là-bas au cas où vous voudriez la rétablir à son paramètre d'origine.

Dans cet exemple, le paramètre **RPL Claim Gas Threshold** est actuellement sélectionné (surligné d'une boîte verte sur le côté gauche de l'écran).
Il a été changé en `40`, mais vous pouvez voir qu'il a une valeur par défaut de `150` dans le coin supérieur droit (le haut de la **zone de description**).

::: tip ASTUCE
Pour rappel, rien ne sera enregistré sur le disque tant que vous n'aurez pas passé par la boîte de dialogue de révision via le bouton **Review Changes and Save**.
Nous vous encourageons à explorer tous les paramètres pour en apprendre davantage à leur sujet et voir ce que votre Smartnode peut faire !
:::

### Les types de paramètres et comment les utiliser

Le gestionnaire de paramètres utilise les types de paramètres et éléments d'interface utilisateur suivants :

#### Zones de texte

Les zones de texte sont utilisées pour saisir des chaînes de texte ou des nombres arbitraires.
Elles ressemblent à ceci :

<img src="./images/tui-textbox.png" width="100%" height="auto" />

Entrez les valeurs souhaitées, puis **appuyez sur `Entrée` ou utilisez les `touches fléchées` pour naviguer vers un paramètre différent afin de conserver vos modifications.**
Si vous ne le faites pas, le gestionnaire de paramètres supposera que vous mettez toujours à jour ce paramètre et ne le marquera pas encore comme modifié.

#### Menus déroulants

Les menus déroulants sont utilisés pour sélectionner une option dans une liste de choix.
Ils ressemblent à ceci (lorsqu'ils sont ouverts) :

<img src="./images/tui-dropdown-open.png" width="100%" height="auto" />

L'élément **vert** est celui qui est actuellement sélectionné.
Utilisez les `touches fléchées` pour changer d'option - ce faisant, la **zone de description** à droite se mettra à jour pour vous en dire plus sur l'option actuellement sélectionnée.
Lorsque vous êtes satisfait de votre choix, appuyez sur `Entrée` pour choisir l'option sélectionnée et le menu déroulant se fermera, révélant l'option actuellement sélectionnée :

<img src="./images/tui-dropdown-closed.png" width="100%" height="auto" />

#### Cases à cocher

Les cases à cocher sont utilisées pour les questions simples Oui/Non.
Elles ressemblent à ceci :

<img src="./images/tui-checkbox-checked.png" width="100%" height="auto" />

Lorsqu'elles sont cochées, elles auront un `X` au milieu comme vous le voyez ci-dessus.
Lorsqu'elles ne sont _pas_ cochées, elles seront simplement vides comme ceci :

<img src="./images/tui-checkbox-unchecked.png" width="100%" height="auto" />

Pour modifier le paramètre, sélectionnez-le simplement et appuyez sur `Entrée`.

### Enregistrement des modifications

Lorsque vous êtes satisfait de vos modifications et que vous souhaitez les examiner avant de les enregistrer, appuyez sur le bouton **Review Changes and Save** sur l'écran d'accueil.
Pour rappel, pour y accéder, appuyez sur la touche `Tab`.

Vous serez présenté avec une vue qui ressemble à ceci :

<img src="./images/tui-review.png" width="100%" height="auto" />

La **zone de révision** ici présentera tous les paramètres que vous avez modifiés, montrant les anciennes valeurs et les nouvelles.
Par exemple, la première ligne ici montre que le **RPL Claim Gas Threshold** était `150`, et il a été changé en `40`.

Elle vous montrera également quels conteneurs sont affectés par les paramètres que vous avez modifiés et vous proposera de les redémarrer pour vous après avoir enregistré vos modifications.

::: tip NOTE
À ce stade, vos modifications **n'ont toujours pas été enregistrées**.
Si vous voulez revenir en arrière et modifier quelque chose, appuyez sur `Échap` pour revenir à l'écran d'accueil.
:::

Lorsque vous êtes satisfait des modifications, appuyez sur `Entrée` pour enregistrer la nouvelle configuration sur le disque.
Vous quitterez alors l'interface utilisateur du terminal et serez présenté avec quelque chose comme ce message :

```
Your changes have been saved!
The following containers must be restarted for the changes to take effect:
	rocketpool_watchtower
	rocketpool_validator
	rocketpool_eth2
	rocketpool_node
Would you like to restart them automatically now? [y/n]
```

Appuyez sur `y` et `Entrée` si vous souhaitez appliquer automatiquement vos nouvelles modifications de configuration et redémarrer les conteneurs affectés.

Appuyez sur `n` et `Entrée` si vous avez d'autres choses à faire avant de les redémarrer, et le ferez manuellement plus tard.

Dans les deux cas, votre configuration est terminée !

::: tip NOTE
Vous pouvez voir un message d'erreur comme celui ci-dessous :

```
2022/08/13 13:49:41 Error piping stdout: read |0: file already closed
```

Ce n'est pas réellement une erreur, c'est simplement un problème cosmétique.
Vous pouvez l'ignorer en toute sécurité.
:::

::: tip NOTE
Si vous utilisez Mac OS, vous pouvez voir un problème se plaignant de node_exporter.
Vous devrez exécuter ces commandes pour corriger.

```shell
rocketpool service stop
nano ~/.rocketpool/override/exporter.yml
```

Remplacez tout le contenu du fichier par :

```
# Enter your own customizations for the node exporter container here. These changes will persist after upgrades, so you only need to do them once.
#
# See https://docs.docker.com/compose/extends/#adding-and-overriding-configuration
# for more information on overriding specific parameters of docker-compose files.

version: "3.7"
services:
  node-exporter:
    x-rp-comment: Add your customizations below this line
    volumes:   ["/proc:/host/proc:ro","/sys:/host/sys:ro"]
```

puis enfin `rocketpool service start`.
:::

## Configuration via la ligne de commande

Si vous utilisez le Smartnode dans un environnement sans interface où vous ne pouvez pas interagir avec l'interface utilisateur du terminal, vous pouvez configurer votre nœud via la ligne de commande à la place.

La commande `rocketpool service config` accepte, en tant qu'arguments, chaque paramètre qui peut normalement être configuré via l'interface utilisateur du terminal.
Exécutez la commande suivante pour en voir une liste (notez qu'elle est assez longue) :

```shell
rocketpool service config --help
```

La sortie ressemblera à ceci :

```
NAME:
   rocketpool service config - Configure the Rocket Pool service

USAGE:
   rocketpool service config

OPTIONS:
   --executionClientMode value  Choose which mode to use for your Execution client - locally managed (Docker Mode), or externally managed (Hybrid Mode).
                                Type: choice
                                Options: local, external
 (default: "local")
   --executionClient value  Select which Execution client you would like to run.
                            Type: choice
                            Options: geth, infura, pocket
 (default: "geth")
   --useFallbackExecutionClient         Enable this if you would like to specify a fallback Execution client, which will temporarily be used by the Smartnode and your Consensus client if your primary Execution client ever goes offline.
                                        Type: bool

...
```

Chaque option aura son nom, son type, sa valeur par défaut et (s'il s'agit d'un paramètre de choix) ses options.
En utilisant ce texte, vous pouvez trouver les options que vous souhaitez définir et les spécifier via les arguments appropriés.

::: tip NOTE
Cette commande s'appuie sur votre configuration existante, donc si vous avez déjà enregistré certains paramètres et que vous souhaitez simplement en modifier d'autres, vous n'avez pas besoin de les répéter.
Elle ne mettra à jour que les paramètres que vous incluez comme arguments à cette commande.
:::

## Étapes suivantes

Une fois que vous avez configuré votre nœud comme vous le souhaitez, vous êtes prêt à sécuriser votre système d'exploitation pour protéger votre nœud.
Passez à la section [Sécurisation de votre nœud](./securing-your-node) ensuite.
