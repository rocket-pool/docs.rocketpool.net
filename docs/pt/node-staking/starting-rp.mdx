import { Tab, Tabs } from "@rspress/core/theme";

# Iniciando o Rocket Pool

Neste ponto, você deve ter a infraestrutura completa do Rocket Pool em execução, incluindo o stack Smartnode, um cliente de Execução e um de Consenso.
Você também deve ter fortalecido seu sistema operacional contra atacantes externos.
Se você completou ambas essas etapas, está pronto para criar um nó Rocket Pool e começar a fazer staking.
Caso contrário, revise as seções anteriores e retorne aqui quando tiver completado essas etapas.

## Iniciando e Parando os Serviços do Rocket Pool

<div className="p-3">
  <Tabs>
    <Tab label="Modo Docker (Padrão)">
      Agora que você tem o Smartnode instalado, iniciar o stack é fácil.
      Simplesmente digite o seguinte comando:

      ```shell
      rocketpool service start
      ```

      Este comando criará todas as imagens Docker necessárias se elas ainda não existirem, garantirá que a rede docker do Rocket Pool e os volumes de armazenamento tenham sido inicializados, e atualizará quaisquer contêineres se eles não corresponderem mais às configurações do UI `rocketpool service config`.

      Na primeira vez que você fizer isso, a saída deve se parecer com isto:

      ```
      $ rocketpool service start

      Creating network "rocketpool_net" with the default driver
      Creating volume "rocketpool_eth1clientdata" with default driver
      Creating volume "rocketpool_eth2clientdata" with default driver
      Creating rocketpool_eth1 ...
      Creating rocketpool_eth1 ... done
      Creating rocketpool_eth2 ...
      Creating rocketpool_api  ...
      Creating rocketpool_api  ... done
      Creating rocketpool_eth2 ... done
      Creating rocketpool_watchtower ...
      Creating rocketpool_mev-boost   ...
      Creating rocketpool_mev-boost   ... done
      Creating rocketpool_node       ...
      Creating rocketpool_validator  ...
      Creating rocketpool_validator  ... done
      Creating rocketpool_node       ... done
      Creating rocketpool_watchtower ... done
      ```

      Se for assim, então o stack Smartnode foi inicializado com sucesso e está agora em execução.

      Se você precisar parar os serviços (por exemplo, durante uma atualização ou porque você precisa fazer manutenção), você pode usar `rocketpool service stop` para desligar tudo.
      A saída deve se parecer com isto:

      ```
      $ rocketpool service stop

      Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized! [y/n]
      y

      Stopping rocketpool_node       ...
      Stopping rocketpool_validator  ...
      Stopping rocketpool_watchtower ...
      Stopping rocketpool_mev-boost  ...
      Stopping rocketpool_eth2       ...
      Stopping rocketpool_api        ...
      Stopping rocketpool_eth1       ...
      Stopping rocketpool_validator  ... done
      Stopping rocketpool_node       ... done
      Stopping rocketpool_watchtower ... done
      Stopping rocketpool_api        ... done
      Stopping rocketpool_mev-boost  ... done
      Stopping rocketpool_eth2       ... done
      Stopping rocketpool_eth1       ... done
      ```

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Depois de chamar isso, o Rocket Pool **não** iniciará automaticamente após uma reinicialização do sistema.
        Você terá que chamar `rocketpool service start` para iniciar todos os contêineres Docker e habilitar o início automático na reinicialização novamente.
      </p>
    </Tab>
    <Tab label="Modo Híbrido">
      Agora que você tem o Smartnode instalado, iniciar o stack é fácil.
      Simplesmente digite o seguinte comando:

      ```shell
      rocketpool service start
      ```

      Este comando criará todas as imagens Docker necessárias se elas ainda não existirem, garantirá que a rede docker do Rocket Pool e os volumes de armazenamento tenham sido inicializados, e atualizará quaisquer contêineres se eles não corresponderem mais às configurações do UI `rocketpool service config`.

      Na primeira vez que você fizer isso, a saída deve se parecer com isto:

      ```
      $ rocketpool service start

      Creating network "rocketpool_net" with the default driver
      Creating rocketpool_api  ...
      Creating rocketpool_api  ... done
      Creating rocketpool_watchtower ...
      Creating rocketpool_node       ...
      Creating rocketpool_validator  ...
      Creating rocketpool_validator  ... done
      Creating rocketpool_node       ... done
      Creating rocketpool_watchtower ... done
      ```

      Se for assim, então o stack Smartnode foi inicializado com sucesso e está agora em execução.

      Observe que seus clientes externos de Execução e/ou Consenso não serão listados aqui, pois o Rocket Pool não os gerencia e, portanto, não pode iniciá-los.
      Você terá que garantir que os iniciou separadamente, usando o mecanismo com o qual você os criou originalmente.

      Se você precisar parar os serviços (por exemplo, durante uma atualização ou porque você precisa fazer manutenção), você pode usar `rocketpool service stop` para desligar tudo.
      A saída deve se parecer com isto:

      ```
      $ rocketpool service stop

      Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized! [y/n]
      y

      Stopping rocketpool_node       ...
      Stopping rocketpool_validator  ...
      Stopping rocketpool_watchtower ...
      Stopping rocketpool_api        ...
      Stopping rocketpool_validator  ... done
      Stopping rocketpool_node       ... done
      Stopping rocketpool_watchtower ... done
      Stopping rocketpool_api        ... done
      ```

      Novamente, você será responsável por garantir manualmente que seus clientes de Execução e Consenso sejam parados apropriadamente também, se você quiser que sejam parados.

      <p className="rspress-directive tip">
        <p className="rspress-directive-title">NOTA</p>
        Depois de chamar isso, o Rocket Pool não iniciará automaticamente após uma reinicialização do sistema.
        Você terá que chamar `rocketpool service start` para iniciar todos os contêineres Docker e habilitar o início automático na reinicialização novamente.
      </p>

    </Tab>
    <Tab label="Modo Nativo">
      No modo nativo, você já configurou e iniciou os serviços do Smartnode como parte da seção [Configurando um Nó Rocket Pool Nativo sem Docker](./native).

      Assumindo que você os configurou como serviços `systemd`, você pode iniciá-los com `sudo systemctl start ...`.
      Por exemplo, se você estiver usando Geth para Execução e Teku para Consenso:

      ```shell
      sudo systemctl start geth teku-bn teku-vc rp-node rp-watchtower
      ```

      Pará-los é o mesmo processo, mas usando `sudo systemctl stop ...`.

      Observe que parar os serviços **não desativa o início automático**; os processos iniciarão automaticamente após uma reinicialização.

    </Tab>

  </Tabs>
</div>

## Confirmando a Versão e Rede Corretas

Depois que os contêineres ou serviços estiverem ativos, um bom primeiro passo é confirmar que você tem as versões corretas dos clientes e está na rede que espera.
Você pode fazer isso com o seguinte comando:

```shell
rocketpool service version
```

A saída será parecida com isto **(observe que você pode ter uma versão mais recente do que a exibida aqui, isto é apenas um exemplo)**:

```
Your Smartnode is currently using the Ethereum Mainnet.

Rocket Pool client version: 1.6.4
Rocket Pool service version: 1.6.4
Selected Eth 1.0 client: Geth (Locally managed)
Image: ethereum/client-go:v1.10.25
Selected Eth 2.0 client: Lighthouse (Locally managed)
Image: sigp/lighthouse:v3.1.0
```

A primeira linha informará se seu Smartnode está configurado para a mainnet Ethereum ou para a testnet Hoodi.

::: warning NOTA
**Para usuários Docker / Hybrid:**
Se você não estiver na rede que espera estar, volte para a seção Instalando o Rocket Pool e revise as instruções de instalação - você pode ter perdido a parte que tem instruções diferentes dependendo de qual rede você deseja usar.

**Para usuários Native:**
Se você aceitou as configurações padrão quando executou pela primeira vez `rp service config`, então é possível que a rede relatada aqui esteja incorreta.
Simplesmente altere-a no TUI `rp service config`, na seção `Smartnode`, para a rede apropriada e reinicie seus serviços `node` e `watchtower`.
:::

O segundo conjunto de linhas informará quais clientes você está usando e quais versões deles estão definidas na configuração do Rocket Pool.

## Verificando o Status do Serviço e Logs

Agora que os serviços do Smartnode foram iniciados, é uma boa ideia verificar se eles estão sendo executados corretamente sem erros.

<div className="p-3">
  <Tabs>
    <Tab label="Modo Docker (Padrão)">
      A primeira coisa a verificar é se os contêineres Docker estão sendo executados bem, ou se estão constantemente reiniciando devido a um erro.
      Execute o seguinte comando:

      ```shell
      docker ps
      ```

      Os resultados devem se parecer com isto:

      ```
      CONTAINER ID   IMAGE                         COMMAND                  CREATED       STATUS      PORTS                                                                                                         NAMES
      4c1de08a352b   prom/prometheus:v2.37.0       "/bin/prometheus --w…"   9 days ago    Up 9 days   9090/tcp                                                                                                      rocketpool_prometheus
      56940decdd1f   sigp/lighthouse:v2.5.1        "sh /setup/start-bn.…"   9 days ago    Up 9 days   0.0.0.0:9001->9001/tcp, 0.0.0.0:9001->9001/udp, :::9001->9001/tcp, :::9001->9001/udp                          rocketpool_eth2
      bd061e632535   grafana/grafana:8.5.9         "/run.sh"                9 days ago    Up 9 days   3000/tcp, 0.0.0.0:3100->3100/tcp, :::3100->3100/tcp                                                           rocketpool_grafana
      5c4db92762fb   ethereum/client-go:v1.10.21   "sh /setup/start-ec.…"   9 days ago    Up 9 days   8545-8546/tcp, 0.0.0.0:30303->30303/tcp, 0.0.0.0:30303->30303/udp, :::30303->30303/tcp, :::30303->30303/udp   rocketpool_eth1
      e20c560861fc   rocketpool/smartnode:v1.5.0   "/bin/sleep infinity"    9 days ago    Up 9 days                                                                                                                 rocketpool_api
      4cf8d364fb90   rocketpool/smartnode:v1.5.0   "/go/bin/rocketpool …"   9 days ago    Up 9 days                                                                                                                 rocketpool_watchtower
      9eb944c29997   rocketpool/smartnode:v1.5.0   "/go/bin/rocketpool …"   9 days ago    Up 9 days                                                                                                                 rocketpool_node
      2ca5d3dcb471   sigp/lighthouse:v2.5.1        "sh /setup/start-vc.…"   9 days ago    Up 9 days                                                                                                                 rocketpool_validator
      dedc577fe361   prom/node-exporter:v1.3.1     "/bin/node_exporter …"   2 weeks ago   Up 9 days                                                                                                                 rocketpool_exporter
      ```

      A coisa principal a verificar é a coluna `STATUS`.
      Se nenhuma das entradas indicar `Restarting...`, então os contêineres devem estar sendo executados adequadamente (veja a nota abaixo para uma exceção sobre o contêiner `rocketpool_validator`).


      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Se você estiver usando Prysm ou Lodestar como seu cliente de Consenso, provavelmente notará que o contêiner `rocketpool_validator` está constantemente reiniciando.
        Isso está ok!
        O contêiner validador falhará até que um novo validador tenha sido criado usando o comando `rocketpool node deposit`, que abordaremos na seção [Criando um Minipool (Validador)](./create-validator).
        Depois que isso for feito, o contêiner funcionará corretamente - até lá, apenas ignore-o.
      </p>

      Ainda assim, pode ser útil verificar os logs dos vários serviços.

      Para verificar os logs, use o comando `rocketpool service logs container`, onde `container` é um de `eth1`, `eth2`, `validator`, `api`, `node` ou `watchtower`.

      Por exemplo, para verificar os logs do seu cliente ETH1:

      ```
      $ rocketpool service logs eth1

      Attaching to rocketpool_eth1
      eth1_1        | INFO [06-17|05:17:19.052] Imported new block receipts              count=25   elapsed=26.651ms    number=247,000   hash=6583ec..35eb1c age=2y3mo2w  size=15.72KiB
      eth1_1        | INFO [06-17|05:17:19.098] Imported new block headers               count=192  elapsed=18.515ms    number=247,551   hash=b7d5e4..d49faf age=2y3mo2w
      eth1_1        | INFO [06-17|05:17:19.334] Imported new block receipts              count=371  elapsed=46.450ms    number=247,371   hash=dd3240..1ed173 age=2y3mo2w  size=266.59KiB
      eth1_1        | INFO [06-17|05:17:19.354] Imported new state entries               count=1271 elapsed=2.866ms     processed=374,695 pending=3134  trieretry=0   coderetry=0  duplicate=0 unexpected=0
      eth1_1        | INFO [06-17|05:17:19.441] Imported new block headers               count=384  elapsed=35.331ms    number=247,935   hash=4c4dba..5bf8b6 age=2y3mo2w
      eth1_1        | INFO [06-17|05:17:19.460] Imported new block receipts              count=180  elapsed=33.648ms    number=247,551   hash=b7d5e4..d49faf age=2y3mo2w  size=128.73KiB
      eth1_1        | INFO [06-17|05:17:19.480] Imported new block headers               count=192  elapsed=19.122ms    number=248,127   hash=aa70b9..40d139 age=2y3mo1w
      eth1_1        | INFO [06-17|05:17:19.486] Imported new block receipts              count=6    elapsed=26.042ms    number=247,557   hash=fd6656..ca2439 age=2y3mo2w  size=3.77KiB
      ```

      Você deve fazer isso tanto para `eth1` quanto para `eth2` para garantir que ambos os clientes estejam sendo executados sem erros.
    </Tab>
    <Tab label="Modo Híbrido">
      A primeira coisa a verificar é se os contêineres Docker estão sendo executados bem, ou se estão constantemente reiniciando devido a um erro.
      Execute o seguinte comando:

      ```shell
      docker ps
      ```

      Os resultados devem se parecer com isto:

      ```
      CONTAINER ID   IMAGE                               COMMAND                  CREATED       STATUS         NAMES
      a3c22f54eff0   rocketpool/smartnode:v1.0.0-rc3     "/go/bin/rocketpool …"   2 hours ago   Up 2 minutes   rocketpool_node
      0d5818868ef6   sigp/lighthouse:v1.4.0              "sh /setup/start-val…"   2 hours ago   Up 2 minutes   rocketpool_validator
      88bea525fa89   rocketpool/smartnode:v1.0.0-rc3     "/go/bin/rocketpool …"   2 hours ago   Up 2 minutes   rocketpool_watchtower
      62314e5a0ecf   rocketpool/smartnode:v1.0.0-rc3     "/bin/sleep infinity"    2 hours ago   Up 2 minutes   rocketpool_api
      ```

      A coisa principal a verificar é a coluna `STATUS`.
      Se nenhuma das entradas indicar `Restarting...`, então os contêineres devem estar sendo executados adequadamente (veja a nota abaixo para uma exceção sobre o contêiner `rocketpool_validator`).

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Se você estiver usando **Lodestar** ou **Prysm** como seu cliente de Consenso, provavelmente notará que o contêiner `rocketpool_validator` está constantemente reiniciando.
        Isso está ok!
        O contêiner validador falhará até que um novo validador tenha sido criado usando o comando `rocketpool node deposit`, que abordaremos na seção [Criando um Minipool (Validador)](./create-validator).
        Depois que isso for feito, o contêiner funcionará corretamente - até lá, apenas ignore-o.
      </p>

      Ainda assim, pode ser útil verificar os logs dos vários serviços.

      Para verificar os logs, use o comando `rocketpool service logs container`, onde `container` é um de `eth1`, `eth2`, `validator`, `api`, `node` ou `watchtower`.

      Você pode ignorar `eth1` e/ou `eth2` com base em quais você está mantendo externamente, mas se você estiver deixando o Rocket Pool gerenciar um deles, você deve verificar o status dele agora usando este comando.
    </Tab>
    <Tab label="Modo Nativo">
      A maneira mais fácil de verificar o status e os logs no modo nativo é usar os scripts de log que você criou quando configurou pela primeira vez os serviços do Smartnode.

      Por exemplo, para verificar o log do Geth, você simplesmente executaria:

      ```shell
      /srv/geth/log.sh
      ```

      Você deve ver que ele está lentamente progredindo sem erros.
      Faça isso para seus clientes de Execução e Consenso agora para verificar se eles estão funcionando adequadamente.
    </Tab>

  </Tabs>
</div>

::: tip DICA
Quando terminar de ver os logs, você pode sair e retornar ao prompt de comando usando `Ctrl + C`.
:::

## Esperando seus Clientes ETH Sincronizarem

Agora que seus clientes foram iniciados, você vai querer esperar até que seus clientes de Execução e Consenso tenham terminado de sincronizar com a rede antes de prosseguir.

Uma maneira fácil de verificar seu status é com o seguinte comando:

```shell
rocketpool node sync
```

Este comando mostrará quão longe seus clientes de Execução e Consenso estão no processo de sincronização, semelhante a isto:

```shell
$ rocketpool node sync

Your Smartnode is currently using the Hoodi Test Network.

Your eth2 client is on the correct network.

Your primary execution client is fully synced.
You do not have a fallback execution client enabled.
Your consensus client is still syncing (99.69%).
```

Você pode chamar isso ocasionalmente para acompanhar o progresso dos seus clientes.

Para obter uma ETA real do tempo de sincronização, é mais fácil ver os logs dos seus clientes com `rocketpool service logs eth1` e `rocketpool service logs eth2` respectivamente (ou os comandos de script de log equivalentes se você estiver usando os modos híbrido / nativo.)
Cada cliente normalmente fornece uma ETA sobre seu status de sincronização em sua saída de log.

::: tip NOTA
Pode levar **dias** para sincronizar completamente tanto ETH1 quanto ETH2, dependendo da sua seleção de cliente e do perfil de hardware da sua máquina.
**Isso é esperado**.
Sente-se, relaxe e espere que ambos terminem.
:::

::: warning NOTA
Se seu nó não estiver sincronizando de jeito nenhum ou não tiver peers, pode ser porque seu roteador está bloqueando as portas 30303 e 9001. Se estiverem fechadas, você precisará configurar o encaminhamento de porta no seu roteador. Além disso, certifique-se de que seu nó tenha um endereço IP local estático para que o encaminhamento de porta não falhe devido ao seu nó obter um novo endereço.
:::

## Próximos Passos

Depois que seus clientes sincronizarem, você está pronto para [criar uma nova carteira](./wallet-init) se este for seu primeiro nó, ou [recuperar uma carteira existente](./recovering-rp) se estiver restaurando de um backup ou migrando de outro provedor como Allnodes para seu próprio hardware.

Selecione qual você gostaria de aprender mais e siga os passos no guia correspondente.
