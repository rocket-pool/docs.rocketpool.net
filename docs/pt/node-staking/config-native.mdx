import nimbus_dashboard from "./images/nimbus-dashboard.png";
import tui_checkbox_checked from "./images/tui-checkbox-checked.png";
import tui_checkbox_unchecked from "./images/tui-checkbox-unchecked.png";
import tui_dropdown_closed from "./images/tui-dropdown-closed.png";
import tui_dropdown_open from "./images/tui-dropdown-open.png";
import tui_native_cc_url from "./images/tui-native-cc-url.png";
import tui_native_cc from "./images/tui-native-cc.png";
import tui_native_ec from "./images/tui-native-ec.png";
import tui_native_finished from "./images/tui-native-finished.png";
import tui_native_metrics from "./images/tui-native-metrics.png";
import tui_native_mev from "./images/tui-native-mev.png";
import tui_native_network from "./images/tui-native-network.png";
import tui_native_welcome from "./images/tui-native-welcome.png";
import tui_native_other from "./images/tui-native-other.png";
import tui_native_review from "./images/tui-native-review.png";
import tui_native_settings_home from "./images/tui-native-settings-home.png";
import tui_native_smartnode from "./images/tui-native-smartnode.png";
import tui_textbox from "./images/tui-textbox.png";

# Configurando a Smartnode Stack (Modo Nativo)

Nesta seção, vamos abordar os vários métodos para configurar a Smartnode se você estiver usando a **configuração Nativa** que não usa Docker.

::: warning NOTA
Se você estiver usando uma configuração baseada em Docker, visite o [guia de configuração Docker](./config-docker) em vez disso.
:::

Existem três maneiras de configurá-la:

- Via [Interface do Assistente](#configurando-via-o-assistente) - esta é a maneira mais fácil. Ele faz apenas algumas perguntas básicas e usa padrões bem testados para o resto. Isso é o que será apresentado quando você executar `rocketpool service config` pela primeira vez.
- Via [Interface do Gerenciador de Configurações](#configurando-via-o-gerenciador-de-configuracoes) - isso dá acesso a todas as configurações da Smartnode para que você possa personalizar tudo o quanto quiser.
- Sem interface via [Linha de Comando](#configurando-via-linha-de-comando) - esta é uma opção para pessoas que executam a Smartnode em um ambiente sem interface (não interativo) e precisam configurá-la automaticamente.

Escolha qual modo você gostaria de aprender mais na lista acima, ou simplesmente percorra cada opção abaixo.

## Configurando via o Assistente

Para configurar a Smartnode, execute o comando de configuração:

```shell
rp service config
```

Isso iniciará uma interface baseada em terminal que permitirá que você configure seu node de forma rápida e fácil, além de fornecer controle opcional refinado sobre as configurações que são relevantes para o modo Nativo.

::: tip NOTA
Se você já configurou a Smartnode, será recebido com o [Gerenciador de Configurações](#configurando-a-smartnode-stack-via-o-gerenciador-de-configuracoes).
Você pode optar por reabrir o Assistente de lá se preferir, e todas as suas configurações existentes serão pré-selecionadas para você.
:::

Quando você executar a interface de configuração pela primeira vez (ou se optar por executar o Assistente novamente mais tarde), será apresentado com uma tela que se parece com isto:

<img src={tui_native_welcome} width="100%" height="auto" />

::: tip DICA
Para usar o Assistente, **pressione as `Setas do Teclado` (cima/baixo/esquerda/direita) para navegar entre coisas como botões (escolhas) ou caixas de texto**.
Você também pode usar `Tab` e `Shift+Tab` se preferir - fará a mesma coisa.

Para botões, **o que estiver selecionado atualmente será destacado em verde**.
Os que estão em preto não estão selecionados.
Na captura de tela acima, `Next` está atualmente selecionado e `Quit` não está.

**Pressione `Enter` ou `Espaço` para selecionar um botão**, análogo a clicar nele com o mouse.

**Pressione `Escape` para voltar ao diálogo anterior** se você mudou de ideia sobre algo.
Isso será útil conforme você progride pelas várias páginas do Assistente.

**Segure `Ctrl` e pressione `C` a qualquer momento para sair do Assistente sem salvar nada**.

Por exemplo, na tela acima, você poderia pressionar as teclas de seta `esquerda` e `direita` para mover entre os botões `Next` e `Quit`.

Pressionar `Enter` enquanto `Next` está selecionado irá prosseguir para a próxima tela.
Pressionar `Enter` enquanto `Quit` está selecionado sairá do Assistente sem salvar.
:::

Quando estiver pronto para começar, pressione `Next`.

### Escolhendo uma Rede

Na próxima tela, você será solicitado a escolher qual rede deseja usar:

<img src={tui_native_network} width="100%" height="auto" />

Você pode destacar as diferentes escolhas com as teclas de seta `Cima` e `Baixo` (ou `Tab` e `Shift+Tab`).
Quando você muda de escolha, a caixa **Description** à direita mostrará uma breve descrição de cada opção.
Isso é verdade para todas as páginas baseadas em escolha no Assistente, não apenas a seleção de rede, então você verá esse estilo de página com frequência.

Se você quiser praticar executando um node Rocket Pool na rede de teste Hoodi com ETH e RPL falsos que você pode obter gratuitamente, selecione **Hoodi Testnet**.

Se você está pronto para criar um node Rocket Pool real na Mainnet para ganhar recompensas reais, selecione **Mainnet**.

### Configuração do Execution Client

A próxima tela solicitará a URL da API RPC baseada em HTTP do seu Execution client:

<img src={tui_native_ec} width="100%" height="auto" />

Digite `http://127.0.0.1:8545` aqui se você planeja executar um Execution client na mesma máquina que a Smartnode (no resto deste guia, assumiremos que é isso que você planeja fazer).
No entanto, se você já tem um Execution client configurado em outro lugar, use sua URL aqui.

Observe que você sempre pode alterar isso executando `rp service config` novamente mais tarde.

### Configuração do Consensus Client

Em seguida, você será perguntado qual Consensus client está usando (ou planeja usar).
Porque cada Consensus client tem comportamento ligeiramente diferente, a Smartnode precisa saber qual você está usando para que possa adaptar seu próprio comportamento adequadamente.
Escolha seu cliente da lista na seguinte tela:

<img src={tui_native_cc} width="100%" height="auto" />

Em seguida, você verá uma tela solicitando a URL da API do seu cliente:

<img src={tui_native_cc_url} width="100%" height="auto" />

Digite `http://127.0.0.1:5052` aqui se você planeja executar o Beacon Node do seu Consensus client na mesma máquina que a Smartnode (no resto deste guia, assumiremos que é isso que você planeja fazer).
No entanto, se você já tem um Beacon Node configurado em outro lugar, use sua URL aqui.

### Outras Configurações

A próxima tela terá algumas outras configurações diversas:

<img src={tui_native_other} width="100%" height="auto" />

Deixe-as como as opções padrão, a menos que você tenha decidido usar um diretório diferente de `/srv/rocketpool` para sua instalação da Smartnode.

### Clientes de Fallback

A partir da versão 1.5.0 da Smartnode stack, você pode fornecer um par de Execution client e Consensus client de "fallback" que pode assumir para seus clientes primários se eles ficarem offline (como porque você usa Geth e precisa podá-lo).
Nesta situação, sua máquina node primária ainda será responsável por atestar e propor blocos com as chaves de validador de suas minipools, mas se conectará a uma máquina externa para interagir com a camada de Execution e as cadeias Beacon.

[Para saber mais sobre nodes de fallback, veja esta seção](./fallback) e retorne aqui quando terminar.

### Métricas

Rocket Pool tem a capacidade de integrar com Prometheus e Grafana para produzir painéis convenientes baseados na web que permitem observar a saúde do seu node rapidamente:

<img src={nimbus_dashboard} width="100%" height="auto" />

A pergunta final no Assistente perguntará se você deseja habilitar isso:

<img src={tui_native_metrics} width="100%" height="auto" />

Se você optar por habilitá-lo, aprenderá mais sobre como configurá-lo e como usá-lo na seção [Configurando o Painel Grafana](./grafana.mdx) mais tarde no processo.

::: warning NOTA
Todos os dados coletados por este sistema **ficam na sua máquina**.
Rocket Pool não coleta nenhuma telemetria ou a envia para um serviço separado.
Está lá puramente para você usar para que possa monitorar seu próprio node!
:::

### Configuração MEV

Desde o Merge das camadas de Execution e Consensus em setembro de 2022, os validadores Ethereum agora têm a capacidade de ganhar taxas de prioridade e participar do Maximal Extractable Value (ou MEV para resumir).

A partir do Smartnode v1.7.0, MEV agora é _opt-out_ então uma notificação sobre configurá-lo é apresentada como parte da configuração inicial, como você vê na próxima tela:

<img src={tui_native_mev} width="100%" height="auto" />

[Por favor, leia nosso guia MEV para saber mais sobre MEV, sua configuração e o que fazer nesta seção do assistente.](./mev.mdx)
Retorne aqui quando terminar.

### Conclusão

Após esta pergunta, você terminou de configurar a Smartnode.
Você verá o seguinte diálogo:

<img src={tui_native_finished} width="100%" height="auto" />

Se você está satisfeito com sua configuração e está pronto para iniciar a Smartnode, clique em `Save and Exit` aqui.

Se você ainda não terminou de instalar o Rocket Pool, retorne ao guia de configuração Nativa agora.
Caso contrário, o próximo passo é reiniciar seus serviços daemon com:

```shell
sudo systemctl restart rp-node rp-watchtower
```

Se você gostaria de revisar todas as configurações e personalizar muitas configurações adicionais que não foram incluídas no Assistente, clique em `Review All Settings` e vá para a [próxima seção](#configurando-via-o-gerenciador-de-configuracoes).

## Configurando via o Gerenciador de Configurações

Se você já executou `rp service config`, em vez de ser recebido pelo Assistente, verá a tela do **Gerenciador de Configurações**:

<img src={tui_native_settings_home} width="100%" height="auto" />

Existem três recursos principais desta tela:

1. A **Lista de Categorias**, que permite explorar as configurações de cada categoria da Smartnode stack que é relevante para o modo Nativo
2. O botão **Review Changes and Save**, que você pode usar quando estiver pronto para ver quais configurações você alterou e salvar a configuração atualizada
3. O botão **Open the Config Wizard**, que o levará ao [Assistente de Configuração](#configurando-a-smartnode-stack-via-o-assistente) se você preferir essa interface

::: tip DICA
Para usar o Gerenciador de Configurações, **pressione as `Setas do Teclado` (cima/baixo/esquerda/direita) para navegar entre opções na página inicial**.

Pressione `Tab` para ir **entre a lista de categorias (1) e os botões (2 e 3)** na parte inferior da tela.
O botão que está atualmente selecionado será **destacado em verde**.

**Pressione `Enter` ou `Espaço` para selecionar um botão**, análogo a clicar nele com o mouse.

**Segure `Ctrl` e pressione `C` a qualquer momento para sair do Gerenciador de Configurações sem salvar nada**.
:::

Conforme você percorre a lista de categorias, cada opção terá uma descrição útil aparecer na **Caixa de Descrição** à direita da tela.
Sinta-se livre para explorá-las; nada do que você fizer será salvo até que você passe pelo diálogo de Revisão através do botão **Review Changes and Save**, e você pode pressionar **Ctrl+C** a qualquer momento para sair sem salvar, então você não bagunçará acidentalmente algo ao mexer com as configurações aqui.

### Configurando as Definições

Na tela inicial, selecione qualquer uma das categorias com a tecla `Enter` para visualizar as configurações dessa categoria.
Por exemplo, aqui está a tela para a categoria **Smartnode and TX Fees**:

<img src={tui_native_smartnode} width="100%" height="auto" />

Use as `Setas do Teclado` para mover para cima e para baixo entre as configurações.
A atualmente selecionada terá um quadrado branco no final (se for uma caixa de texto ou uma caixa de seleção), ou será destacada em branco (se for um menu suspenso).

Pressione `Escape` para voltar à tela inicial do Gerenciador de Configurações quando terminar.

Conforme você percorre as configurações, cada uma mostrará uma breve descrição do que faz na **Caixa de Descrição** à direita.
Também mostrará o **valor padrão** lá, caso você queira revertê-lo para sua configuração padrão.

Neste exemplo, a configuração **RPL Claim Gas Threshold** está atualmente selecionada (destacada com uma caixa verde no lado esquerdo da tela).
Foi alterada para `40`, mas você pode ver que tem um padrão de `150` no canto superior direito (o topo da **Caixa de Descrição**).

::: tip DICA
Como lembrete, nada será salvo no disco até que você passe pelo diálogo de Revisão através do botão **Review Changes and Save**.
Você é encorajado a explorar todas as configurações para aprender sobre elas.
:::

### Os Tipos de Configuração e Como Usá-los

O gerenciador de configurações usa os seguintes tipos de configuração e elementos de interface:

#### Caixas de Texto

Caixas de texto são usadas para inserir strings arbitrárias de texto ou números.
Elas se parecem com isto:

<img src={tui_textbox} width="100%" height="auto" />

Digite seus valores desejados nelas, então **pressione `Enter` ou use as `Setas do Teclado` para navegar para uma configuração diferente para preservar suas alterações.**
Se você não fizer isso, o Gerenciador de Configurações assumirá que você ainda está atualizando essa configuração e não a marcará como alterada ainda.

#### Menus Suspensos

Menus suspensos são usados para selecionar uma opção de uma lista de escolhas.
Eles se parecem com isto (quando estão abertos):

<img src={tui_dropdown_open} width="100%" height="auto" />

O item **verde** é o que está atualmente selecionado.
Use as `Setas do Teclado` para mudar de opção - conforme você faz isso, a **Caixa de Descrição** à direita será atualizada para lhe contar mais sobre a opção atualmente selecionada.
Quando você estiver satisfeito com sua escolha, pressione `Enter` para escolher a opção selecionada e o menu suspenso se fechará, revelando a opção que está atualmente selecionada:

<img src={tui_dropdown_closed} width="100%" height="auto" />

#### Caixas de Seleção

Caixas de seleção são usadas para perguntas simples de Sim/Não.
Elas se parecem com isto:

<img src={tui_checkbox_checked} width="100%" height="auto" />

Quando estão marcadas, terão um `X` no meio como você vê acima.
Quando estão _desmarcadas_, simplesmente estarão em branco assim:

<img src={tui_checkbox_unchecked} width="100%" height="auto" />

Para alterar a configuração, simplesmente selecione-a e pressione `Enter`.

### Salvando Alterações

Quando você estiver satisfeito com suas alterações e quiser revisá-las antes de salvar, pressione o botão **Review Changes and Save** na tela inicial.
Como lembrete, para chegar a ele, pressione a tecla `Tab`.

Você será apresentado com uma visualização que se parece com isto:

<img src={tui_native_review} width="100%" height="auto" />

A **Caixa de Revisão** aqui apresentará todas as configurações que você alterou, mostrando os valores antigos e os novos.
Por exemplo, a primeira linha aqui mostra que o **RPL Claim Gas Threshold** costumava ser `150`, e foi alterado para `40`.

::: tip NOTA
Neste ponto, suas alterações **ainda não foram salvas**.
Se você quiser voltar e modificar algo, pressione `Escape` para retornar à tela inicial.
:::

Quando você estiver satisfeito com as alterações, pressione `Enter` para salvar a nova configuração no disco.
Você então sairá da Interface do Terminal e será apresentado com esta mensagem:

```
Your changes have been saved!
Please restart your daemon service for them to take effect.
```

Se você ainda não terminou de instalar o Rocket Pool, retorne ao guia de configuração Nativa agora.
Caso contrário, agora você pode reiniciar seus serviços daemon com:

```shell
sudo systemctl restart rp-node rp-watchtower
```

## Configurando via Linha de Comando

Se você usa a Smartnode em um ambiente sem interface onde não pode interagir com a Interface do Terminal, você pode configurar seu node via linha de comando.

O comando `rocketpool service config` aceita, como argumentos, cada configuração que normalmente pode ser configurada através da Interface do Terminal.
Execute o seguinte comando para ver uma lista delas (observe que é bastante longa):

```
rocketpool service config --help
```

A saída se parecerá com isto:

```
NAME:
   rocketpool service config - Configure the Rocket Pool service

USAGE:
   rocketpool service config

OPTIONS:
   --executionClientMode value  Choose which mode to use for your Execution client - locally managed (Docker Mode), or externally managed (Hybrid Mode).
                                Type: choice
                                Options: local, external
 (default: "local")
   --executionClient value  Select which Execution client you would like to run.
                            Type: choice
                            Options: geth, infura, pocket
 (default: "geth")
   --useFallbackExecutionClient         Enable this if you would like to specify a fallback Execution client, which will temporarily be used by the Smartnode and your Consensus client if your primary Execution client ever goes offline.
                                        Type: bool

...
```

Cada opção terá seu nome, seu tipo, seu valor padrão e (se for um parâmetro de escolha) suas opções.
Usando este texto, você pode encontrar a(s) opção(ões) que deseja definir e especificá-las através dos argumentos apropriados.

::: tip NOTA
Este comando se baseia em sua configuração existente, então se você já tem algumas configurações salvas e apenas deseja modificar outras, não precisa repeti-las.
Ele atualizará apenas as configurações que você incluir como argumentos para este comando.
:::

Se você ainda não terminou de instalar o Rocket Pool, retorne ao guia de configuração Nativa agora.
Caso contrário, o próximo passo é reiniciar seus serviços daemon com:

```shell
sudo systemctl restart rp-node rp-watchtower
```
