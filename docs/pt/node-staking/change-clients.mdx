import tui_select_ec from "./images/tui-select-ec.png";
import tui_confirm_ec from "./images/tui-confirm-ec.png";
import tui_select_cc from "./images/tui-select-cc.png";
import tui_checkpoint_sync from "./images/tui-checkpoint-sync.png";
import tui_confirm_cc from "./images/tui-confirm-cc.png";

# Alterando Clientes Execution ou Consensus

Em circunstâncias normais, você provavelmente apenas selecionará um cliente Execution e Consensus quando criar seu nó Rocket Pool pela primeira vez e os deixará funcionando felizmente por toda a vida do seu Nó.
No entanto, existem algumas situações em que você pode querer alterar sua seleção de cliente.
Aqui estão alguns exemplos:

- Seu cliente ganha uma participação de [supermaioria](https://clientdiversity.org/) nas cadeias Execution ou Beacon, e você deseja mudar pela saúde geral da rede
- Um bug faz com que seu cliente pare de funcionar corretamente, e você precisa voltar online rapidamente para retomar as tarefas de validação
- Você deseja experimentar um novo recurso que um cliente diferente oferece
- Um cliente diferente é mais adequado para o hardware do seu nó (por exemplo, alguns clientes são melhores em sistemas ARM do que outros)

Felizmente, a stack do Smartnode torna a mudança de clientes extremamente fácil.
Tudo o que é necessário são algumas mudanças na TUI de Configuração e alguns comandos extras opcionais para fazer backup dos dados do seu cliente existente antes de mudar de cliente.

## Alterando Clientes Execution

Antes de alterar seu cliente Execution, vale a pena notar os seguintes pontos:

- Os dados da cadeia **não são compartilhados** entre clientes. Seu novo cliente precisará ressincronizar os dados da cadeia Mainnet, o que pode levar algum tempo (embora cada cliente suporte snap sync, que o Smartnode usa para acelerar a ressincronização).
- Por padrão, o Smartnode deixará os dados da cadeia do seu cliente antigo em seu disco caso você queira reverter para seu cliente Execution antigo e continuar de onde parou. Você pode querer **exportá-los para um local diferente** e excluí-los para liberar espaço antes de mudar de cliente, já que clientes Execution podem usar centenas de gigabytes. Temos etapas abaixo sobre como fazer isso.
- Enquanto seu novo cliente estiver ressincronizando, a maioria das funções da CLI do Smartnode ficará offline, pois dependem do cliente Execution. **Você deve ter um cliente Execution fallback disponível antes de fazer isso para mitigar o tempo de inatividade no seu Smartnode.**

### (Opcional) Exportar o Banco de Dados do Seu Cliente Execution

O primeiro passo no processo é opcional: se você quiser, pode exportar os dados da cadeia existentes para seu cliente Execution atual.
Isso permitirá que você libere espaço valioso em disco no seu nó para seu novo cliente Execution, e você pode manter os dados da cadeia antiga por perto caso queira reverter para o cliente antigo e continuar de onde parou.

Consulte o guia [Fazendo Backup do Seu Nó](./backups##fazendo-backup-dos-seus-dados-da-cadeia-execution) para detalhes.

### Altere Seu Cliente Execution Selecionado

Para alterar seu cliente selecionado, execute `rocketpool service config` para entrar na UI de configuração.
Navegue até a seção `Execution Client (ETH1)` e selecione o dropdown `Execution Client`:

<img src={tui_select_ec} width="100%" height="auto" />

Abra o dropdown com `Enter`, use as setas para navegar até o cliente de sua escolha e pressione `Enter` novamente para confirmar a seleção.

Observe que cada cliente tem suas próprias opções únicas, então você pode ver algumas configurações adicionais aparecerem nesta tela depois de selecionar um cliente diferente.
Sinta-se à vontade para explorá-las para ver como elas afetam as coisas.

Quando estiver satisfeito com sua escolha, pressione `Esc` para retornar ao menu principal, depois `Tab` para destacar o botão `Review Changes and Save`.
Você será apresentado à tela de revisão, que mostrará sua alteração de seleção de cliente:

<img src={tui_confirm_ec} width="100%" height="auto" />

Pressione `Enter` para aceitar as alterações, e pronto!
Seu novo cliente Execution começará a sincronizar imediatamente.
Como sempre, você pode acompanhá-lo com `rocketpool service logs eth1`.
**Recomendamos que você faça isso para verificar se não há erros e se ele funciona corretamente.**

::: danger NOTA
Agora que as camadas Execution e Consensus foram mescladas, desligar seu cliente Execution também desligará seu cliente Consensus até que seu cliente Execution termine de ressincronizar.
Isso significa que seu nó **parará de atestar e propor blocos, e ele perderá ETH em vez de ganhá-lo!**

Para evitar isso e continuar validando enquanto seu cliente Execution ressincroniza, **por favor, configure um [nó fallback](./fallback)**.
:::

### (Recomendado) Remover Seus Dados da Cadeia Antiga

Esta não é uma etapa obrigatória, mas nós **recomendamos fortemente** que você remova os dados da cadeia do seu cliente antigo agora que você mudou para um novo, para que possa liberar espaço em disco para ele.

Para fazer isso, simplesmente execute o seguinte comando:

```shell
rocketpool service resync-eth1
```

Isso excluirá todos os seus dados do cliente Execution e o reiniciará.

::: tip DICA
Como você acabou de selecionar um novo cliente Execution, ele não será afetado por isso - essencialmente, tudo o que ele fará é excluir seus dados da cadeia antiga.
Você deve fazer isso o mais rápido possível após mudar de cliente para evitar perda desnecessária de progresso no seu novo cliente.
:::

## Alterando Clientes Consensus

Alterar clientes Consensus é ainda mais fácil do que clientes Execution, graças ao [Checkpoint Sync](./config-docker#beacon-chain-checkpoint-syncing).
Este recurso permite que você sincronize imediatamente um novo cliente Consensus com a rede, então não há necessidade de preservar seus dados da cadeia antiga.

Comece usando a UI `rocketpool service config` e navegando até a seção `Consensus Client (ETH2)`.
Em seguida, selecione o dropdown `Consensus Client`:

<img src={tui_select_cc} width="100%" height="auto" />

Abra o dropdown com `Enter`, use as setas para navegar até o cliente de sua escolha e pressione `Enter` novamente para confirmar a seleção.

Observe que cada cliente tem suas próprias opções únicas, então você pode ver algumas configurações adicionais aparecerem nesta tela depois de selecionar um cliente diferente.
Sinta-se à vontade para explorá-las para ver como elas afetam as coisas.

Em seguida, verifique se você está usando um provedor de Checkpoint Sync:

<img src={tui_checkpoint_sync} width="100%" height="auto" />

Se você não tiver um provedor de Checkpoint Sync configurado, [você pode facilmente usar instruções daqui para fazê-lo gratuitamente](./config-docker#beacon-chain-checkpoint-syncing)!

Quando estiver satisfeito com sua escolha, pressione `Esc` para retornar ao menu principal, depois `Tab` para destacar o botão `Review Changes and Save`.
Você será apresentado à tela de revisão, que mostrará sua alteração de seleção de cliente:

<img src={tui_confirm_cc} width="100%" height="auto" />

Pressione `Enter` para aceitar as alterações, e pronto!
Seu novo cliente Consensus começará a sincronizar imediatamente.
Como sempre, você pode acompanhá-lo com `rocketpool service logs eth2`.
**Recomendamos que você faça isso para verificar se não há erros e se ele funciona corretamente.**
