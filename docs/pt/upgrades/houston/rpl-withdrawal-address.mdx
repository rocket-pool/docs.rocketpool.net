import { Tab, Tabs } from "@rspress/core/theme";
import nodeAddress from "./images/node_address.png";
import rplWithdrawalConfirmation from "./images/rpl_withdrawal_confirmation.png";

# Definindo seu Endereço de Retirada de RPL

É importante entender a diferença entre seu [endereço de retirada primário](../../node-staking/prepare-node#setting-your-primary-withdrawal-address) e seu endereço de retirada de RPL. Por padrão, seu endereço de retirada de RPL não está definido e seu endereço de retirada primário é para onde todas as suas recompensas de checkpoint de RPL, seu RPL em staking e ETH da Beacon Chain serão enviados.

Você pode definir um [endereço de retirada separado para seu RPL](https://rpips.rocketpool.net/RPIPs/RPIP-31) se desejar. Seu endereço de retirada de RPL, se definido, poderá acionar e reivindicar RPL de recompensas de inflação e não terá efeito nas recompensas de consenso de ETH ou qualquer coisa relacionada ao ETH. Neste caso, seu endereço de retirada primário não terá mais nenhuma autoridade sobre ações relacionadas ao RPL.

Isso cria algumas oportunidades interessantes em que o RPL pode ser fornecido por uma entidade a um operador de nó que não deseja ter exposição ao RPL. Essa entidade pode então reivindicar recompensas de RPL por fornecer a garantia de seguro necessária para o nó. Em outras palavras, isso permite que diferentes atores forneçam cada tipo de garantia.

::: warning NOTA
Ao configurar seu nó pela primeira vez, seu endereço de retirada de RPL está indefinido por padrão.
Se você optar por definir um endereço de retirada de RPL, **é extremamente importante definir isso para um endereço diferente controlado por uma carteira fria.**
Uma carteira fria pode ser uma carteira de hardware (como [Ledger](https://www.ledger.com/), [Trezor](https://trezor.io/) ou [Grid+](https://gridplus.io/)), ou uma carteira Smart Contract (como [Safe](https://app.safe.global/welcome)).

Nós **fortemente recomendamos** que você NÃO use uma carteira quente como MetaMask como seu endereço de retirada de RPL.

Dessa forma, se sua carteira de nó for comprometida, o atacante não terá acesso ao seu RPL em staking forçando você a sair, porque todos esses fundos serão enviados para sua carteira fria separada (que eles esperamos que não tenham).

Os endereços de retirada de RPL são definidos no nível do operador de nó.
Se você criar vários minipools, todos se referirão ao mesmo endereço de retirada de RPL, então você só precisa executar esta configuração uma vez.

[Veja aqui](https://ethereum.org/en/security/#wallet-security) para alguns conceitos básicos sobre segurança de carteira da Ethereum Foundation.
:::

Existem duas maneiras diferentes de fazer isso.
Por favor, leia ambas as opções abaixo para determinar qual se aplica a você.

<div className="p-3">
  <Tabs>
    <Tab label="Método 1">
      *Use este método se seu novo endereço de retirada de RPL puder ser usado para assinar transações via MetaMask ou WalletConnect.**

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Este método exigirá que você **envie uma transação** do seu novo endereço de retirada de RPL, então **você deve ter uma pequena quantidade de ETH nesse endereço já.**
      </p>

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Para usuários de carteiras de hardware **Ledger**, observe que o Ledger Live ainda não suporta MetaMask ou WalletConnect nativamente.
        Você precisará usar o MetaMask e conectá-lo ao seu Ledger em vez disso.
        Siga [as instruções oficiais do Ledger](https://www.ledger.com/academy/security/the-safest-way-to-use-metamask) para fazer isso.

        Para trabalhar com o site da Rocket Pool, você precisará ter seu Ledger conectado, desbloqueado e o aplicativo ETH aberto.
        Você também precisará **habilitar "blind signing"** para a sessão atual; você pode encontrar isso na parte de Configurações do aplicativo ETH no dispositivo.
        O bind signing será automaticamente desabilitado depois que você fechar a sessão.

        Se você estiver usando o Hoodi Testnet e quiser usar seu Ledger como seu endereço de retirada de RPL, **você deve criar uma nova carteira Ethereum no seu Ledger** primeiro para garantir que você não conecte seu endereço ativo à rede de teste, o que tende a causar confusão.
        Certifique-se de selecionar o **Hoodi Testnet** no menu suspenso de seleção de rede ao conectar seu Ledger ao MetaMask.
        Observe que o Ledger Live não mostrará seu saldo na rede de teste, mas outros aplicativos que suportam a rede de teste (como MetaMask e Etherscan) poderão exibi-lo.
      </p>

      1. Execute `rocketpool node set-rpl-withdrawal-address 'seu endereço de carteira fria ou nome ENS'`. Seu novo endereço de retirada de RPL será marcado como "pendente". Até que você o confirme, **seu antigo endereço de retirada de RPL ainda será usado**.
      2. Para confirmá-lo, você deve enviar uma transação especial **do seu novo endereço de retirada de RPL** para o contrato do minipool para verificar que você possui o endereço de retirada de RPL.
      1. A maneira mais fácil de fazer isso é navegar até o site de endereço de retirada de RPL da Rocket Pool (para o [Hoodi Testnet](https://testnet.node.rocketpool.net/rpl-withdrawal-address) ou para [Mainnet](https://node.rocketpool.net/rpl-withdrawal-address)).
      3. Se você ainda não conectou o Metamask ou WalletConnect ao site da Rocket Pool, faça isso agora. Clique no botão **select wallet** no centro da tela e escolha MetaMask ou WalletConnect com base em qual carteira você gostaria de usar. Você será então solicitado a confirmar a conexão. Por exemplo, usando o MetaMask:

      Clique em **Next**, depois clique em **Confirm** para permitir que o site da Rocket Pool use sua carteira. 3. Selecione **RPL Withdrawal Address** no menu superior (ou no menu hambúrguer no lado esquerdo se você estiver em um dispositivo móvel). 4. Você verá este prompt:

      4. Digite seu **endereço de carteira de nó** aqui e clique no botão laranja **Find** para continuar.

      <img src={nodeAddress} width="100%" height="auto"/>

      1.  Você será solicitado a confirmar um endereço de retirada de RPL pendente. Este deve ser o mesmo endereço que você usou ao executar este comando anteriormente: `rocketpool node set-rpl-withdrawal-address` Selecione **Confirm Pending** quando estiver pronto.
      2.  Agora, deve haver uma nova caixa de diálogo de confirmação em sua carteira. Novamente, usando o MetaMask como exemplo, clique no ícone do MetaMask para abri-lo e você deve ver algo assim:

      Clique em **Confirm** para enviar a transação para a rede. Isso levará algum tempo até ser incluído em um bloco, mas uma vez que esteja, você verá uma caixa de diálogo de confirmação:

      <img src={rplWithdrawalConfirmation} width="100%" height="auto"/>

      5. Seu novo endereço de retirada de RPL agora estará confirmado e ativado. Você pode visualizar isso com `rocketpool node status`.
    </Tab>
    <Tab label="Método 2">
      **Use este método apenas se seu endereço de retirada de RPL _não puder_ ser usado para assinar transações via MetaMask ou WalletConnect.**

      Neste método, você executará:

      ```shell
      rocketpool node set-rpl-withdrawal-address --force `seu endereço de carteira fria`
      ```

      Você terá a chance de enviar uma transação de teste antes de confirmar isso, para garantir que você tenha o endereço certo.
      Se você confirmar este comando quando ele solicitar, seu novo endereço de retirada de RPL será definido imediatamente.


      <p className="rspress-directive danger">
        Ao fazer isso, você contorna a medida de segurança associada ao Método 1, que exige que você prove que possui o novo endereço.
        Se você cometer um erro de digitação aqui, não há como desfazê-lo e **as recompensas do seu minipool serão perdidas para sempre**.

        Nós **fortemente** encorajamos você a usar o mecanismo de transação de teste antes de confirmar isso e, se possível, use o Método 1 em vez disso.
      </p>
    </Tab>

  </Tabs>
</div>

Depois que isso for feito, você **não poderá mais alterar seu endereço de retirada de RPL usando o comando `set-rpl-withdrawal-address`**.
Para alterá-lo, você precisará enviar uma transação assinada do seu endereço de retirada de RPL **ativo** (aquele para o qual você acabou de mudar).
O site da Rocket Pool tem uma função para ajudá-lo a fazer isso.

Se você quiser desativar seu endereço de retirada de RPL, o processo é bastante simples. Primeiro, você vai querer navegar de volta para a página de Endereço de Retirada de RPL no site da Rocket Pool.

<div className="p-3">
  <Tabs>
    <Tab label="Hoodi Testnet">https://testnet.node.rocketpool.net/rpl-withdrawal-address</Tab>
    <Tab label="Mainnet">https://node.rocketpool.net/rpl-withdrawal-address</Tab>
  </Tabs>
</div>

Se você estiver conectado com o endereço de retirada de RPL do nó, você deve ser capaz de clicar no botão **unset** à direita aqui:

<img src="./images/unset_rpl_withdrawal.png" width="100%" height="auto" />

Clicar em **unset** o levará a uma página onde você pode confirmar os detalhes. Se você estiver satisfeito com o que vê, clique no botão laranja **unset** para enviar a transação para a rede.

É tudo o que há para definir seu endereço de retirada de RPL! Esperamos que você tenha achado o processo rápido e fácil.

Sinta-se à vontade para passar por [nosso servidor Discord](https://discord.gg/G46XgK264a) para nos informar o que você achou e acompanhar o projeto à medida que evolui.
