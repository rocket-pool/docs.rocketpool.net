import { Tab, Tabs } from "@rspress/core/theme";
import nodeAddress from "./images/node_address.png";
import rplWithdrawalConfirmation from "./images/rpl_withdrawal_confirmation.png";

# Definindo seu Endereço de Retirada de RPL

É importante entender a diferença entre seu [endereço de retirada primário](../../node-staking/prepare-node#setting-your-primary-withdrawal-address) e seu endereço de retirada de RPL. Por padrão, seu endereço de retirada de RPL não está definido e seu endereço de retirada primário é para onde todas as suas recompensas de checkpoint de RPL, seu RPL em stake e ETH da Beacon Chain serão enviados.

Você pode definir um [endereço de retirada separado para seu RPL](https://rpips.rocketpool.net/RPIPs/RPIP-31) se desejar. Seu endereço de retirada de RPL, se definido, poderá acionar e reivindicar RPL de recompensas de inflação e não terá efeito sobre recompensas de consenso de ETH ou qualquer coisa relacionada a ETH. Neste caso, seu endereço de retirada primário não terá mais autoridade sobre ações relacionadas a RPL.

Isso cria algumas oportunidades interessantes onde o RPL pode ser fornecido por uma entidade a um operador de nó que não deseja ter exposição ao RPL. Essa entidade pode então reivindicar recompensas de RPL por fornecer a garantia de seguro necessária para o nó. Em outras palavras, isso permite que diferentes atores forneçam cada tipo de garantia.

::: warning NOTA
Ao configurar seu nó pela primeira vez, seu endereço de retirada de RPL fica indefinido por padrão.
Se você optar por definir um endereço de retirada de RPL, **é de vital importância defini-lo para um endereço diferente controlado por uma carteira fria.**
Uma carteira fria pode ser uma carteira de hardware (como [Ledger](https://www.ledger.com/), [Trezor](https://trezor.io/) ou [Grid+](https://gridplus.io/)), ou uma carteira de contrato inteligente (como [Safe](https://app.safe.global/welcome)).

**Recomendamos fortemente** que você NÃO use uma carteira quente como MetaMask como seu endereço de retirada de RPL.

Dessa forma, se sua carteira de nó for comprometida, o invasor não terá acesso ao seu RPL em stake forçando você a sair, porque todos esses fundos serão enviados para sua carteira fria separada (que esperamos que eles não tenham).

Os endereços de retirada de RPL são definidos no nível do operador de nó.
Se você criar vários minipools, todos eles farão referência ao mesmo endereço de retirada de RPL, então você só precisa realizar essa configuração uma vez.

[Veja aqui](https://ethereum.org/en/security/#wallet-security) para alguns conceitos básicos sobre segurança de carteira da Ethereum Foundation.
:::

Existem duas maneiras diferentes de fazer isso.
Por favor, leia ambas as opções abaixo para determinar qual se aplica a você.

<div className="p-3">
  <Tabs>
    <Tab label="Método 1">
      *Use este método se seu novo endereço de retirada de RPL puder ser usado para assinar transações via MetaMask ou WalletConnect.**

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Este método exigirá que você **envie uma transação** de seu novo endereço de retirada de RPL, então **você deve ter uma pequena quantidade de ETH nesse endereço já.**
      </p>

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Para usuários de carteiras de hardware **Ledger**, observe que o Ledger Live ainda não suporta MetaMask ou WalletConnect nativamente.
        Você precisará usar o MetaMask e conectá-lo ao seu Ledger.
        Siga [as instruções oficiais da Ledger](https://www.ledger.com/academy/security/the-safest-way-to-use-metamask) para fazer isso.

        Para trabalhar com o site do Rocket Pool, você precisará ter seu Ledger conectado, desbloqueado e o aplicativo ETH aberto.
        Você também precisará **habilitar "blind signing"** para a sessão atual; você pode encontrar isso na seção de Configurações do aplicativo ETH no dispositivo.
        O blind signing será automaticamente desabilitado após você fechar a sessão.

        Se você estiver usando a Hoodi Testnet e quiser usar seu Ledger como seu endereço de retirada de RPL, **você deve criar uma nova carteira Ethereum em seu Ledger** primeiro para garantir que você não conecte seu endereço real à rede de teste, o que tende a causar confusão.
        Certifique-se de selecionar a **Hoodi Testnet** no menu suspenso de seleção de rede ao conectar seu Ledger ao MetaMask.
        Observe que o Ledger Live não mostrará seu saldo na rede de teste, mas outros aplicativos que suportam a rede de teste (como MetaMask e Etherscan) poderão exibi-lo.
      </p>

      1. Execute `rocketpool node set-rpl-withdrawal-address 'seu endereço de carteira fria ou nome ENS'`. Seu novo endereço de retirada de RPL será marcado como "pending". Até você confirmá-lo, **seu antigo endereço de retirada de RPL ainda será usado**.
      2. Para confirmá-lo, você deve enviar uma transação especial **de seu novo endereço de retirada de RPL** para o contrato do minipool para verificar se você possui o endereço de retirada de RPL.
      1. A maneira mais fácil de fazer isso é navegar até o site de endereço de retirada de RPL do Rocket Pool (para a [Hoodi Testnet](https://testnet.node.rocketpool.net/rpl-withdrawal-address) ou para a [Mainnet](https://node.rocketpool.net/rpl-withdrawal-address)).
      3. Se você ainda não conectou o Metamask ou WalletConnect ao site do Rocket Pool, faça isso agora. Clique no botão **select wallet** no centro da tela e escolha MetaMask ou WalletConnect com base na carteira que você gostaria de usar. Você será solicitado a confirmar a conexão. Por exemplo, usando o MetaMask:

      Clique em **Next**, depois clique em **Confirm** para permitir que o site do Rocket Pool use sua carteira. 3. Selecione **RPL Withdrawal Address** no menu superior (ou no menu hambúrguer no lado esquerdo se estiver em um dispositivo móvel). 4. Você verá este prompt:

      4. Digite seu **endereço de carteira de nó** aqui e clique no botão laranja **Find** para continuar.

      <img src={nodeAddress} width="100%" height="auto"/>

      1.  Você será solicitado a confirmar um endereço de retirada de RPL pendente. Este deve ser o mesmo endereço que você usou ao executar este comando anteriormente: `rocketpool node set-rpl-withdrawal-address` Selecione **Confirm Pending** quando estiver pronto.
      2.  Agora, deve haver uma nova caixa de diálogo de confirmação em sua carteira. Novamente, usando o MetaMask como exemplo, clique no ícone do MetaMask para abri-lo e você deverá ver algo assim:

      Clique em **Confirm** para enviar a transação para a rede. Isso levará algum tempo até ser incluído em um bloco, mas quando isso acontecer, você verá uma caixa de diálogo de confirmação:

      <img src={rplWithdrawalConfirmation} width="100%" height="auto"/>

      5. Seu novo endereço de retirada de RPL agora será confirmado e ativado. Você pode visualizar isso com `rocketpool node status`.
    </Tab>
    <Tab label="Método 2">
      **Use este método apenas se seu endereço de retirada de RPL _não puder_ ser usado para assinar transações via MetaMask ou WalletConnect.**

      Neste método, você executará:

      ```shell
      rocketpool node set-rpl-withdrawal-address --force `seu endereço de carteira fria`
      ```

      Você terá a chance de enviar uma transação de teste antes de confirmar isso, para garantir que você tenha o endereço correto.
      Se você confirmar este comando quando solicitado, seu novo endereço de retirada de RPL será definido imediatamente.


      <p className="rspress-directive danger">
        Ao fazer isso, você ignora a medida de segurança associada ao Método 1, que exige que você prove que possui o novo endereço.
        Se você cometer um erro de digitação aqui, não há como desfazê-lo e **as recompensas do seu minipool serão perdidas para sempre**.

        Nós **fortemente** encorajamos você a usar o mecanismo de transação de teste antes de confirmar isso e, se possível, use o Método 1.
      </p>
    </Tab>

  </Tabs>
</div>

Uma vez feito isso, você **não poderá mais alterar seu endereço de retirada de RPL usando o comando `set-rpl-withdrawal-address`**.
Para alterá-lo, você precisará enviar uma transação assinada de seu endereço de retirada de RPL **ativo** (aquele para o qual você acabou de mudar).
O site do Rocket Pool tem uma função para ajudá-lo a fazer isso.

Se você quiser desconfigurar seu endereço de retirada de RPL, o processo é bem simples. Primeiro, você vai querer navegar de volta para a página RPL Withdrawal Address no site do Rocket Pool.

<div className="p-3">
  <Tabs>
    <Tab label="Hoodi Testnet">https://testnet.node.rocketpool.net/rpl-withdrawal-address</Tab>
    <Tab label="Mainnet">https://node.rocketpool.net/rpl-withdrawal-address</Tab>
  </Tabs>
</div>

Se você estiver conectado com o endereço de retirada de RPL do nó, você deverá poder clicar no botão **unset** à direita aqui:

<img src="./images/unset_rpl_withdrawal.png" width="100%" height="auto" />

Clicar em **unset** levará você a uma página onde pode confirmar os detalhes. Se estiver satisfeito com o que vê, clique no botão laranja **unset** para enviar a transação para a rede.

Isso é tudo o que há para definir seu endereço de retirada de RPL! Esperamos que você tenha achado o processo rápido e fácil.

Sinta-se à vontade para visitar [nosso servidor Discord](https://discord.gg/G46XgK264a) para nos dizer o que achou e acompanhar o projeto à medida que evolui.
