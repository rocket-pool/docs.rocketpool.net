import { Tab, Tabs } from "@rspress/core/theme";
import nodeAddress from "./images/node_address.png";
import rplWithdrawalConfirmation from "./images/rpl_withdrawal_confirmation.png";

# Установка адреса вывода RPL

Важно понимать разницу между вашим [основным адресом вывода](../../node-staking/prepare-node#setting-your-primary-withdrawal-address) и вашим адресом вывода RPL. По умолчанию ваш адрес вывода RPL не установлен, и ваш основной адрес вывода - это место, куда будут отправлены все ваши награды checkpoint RPL, ваш staked RPL и Beacon Chain ETH.

Вы можете установить [отдельный адрес вывода для вашего RPL](https://rpips.rocketpool.net/RPIPs/RPIP-31) при желании. Ваш адрес вывода RPL, если установлен, сможет инициировать и получать RPL из наград от инфляции и не будет влиять на награды консенсуса ETH или что-либо связанное с ETH. В этом случае ваш основной адрес вывода больше не будет иметь никаких полномочий в отношении действий, связанных с RPL.

Это создает некоторые интересные возможности, когда RPL может быть предоставлен организацией оператору ноды, который не хочет иметь подверженность RPL. Эта организация может затем получать награды RPL за предоставление требуемого страхового залога для ноды. Другими словами, это позволяет разным участникам предоставлять каждый тип залога.

::: warning ПРИМЕЧАНИЕ
При первоначальной настройке ноды ваш адрес вывода RPL по умолчанию не установлен.
Если вы решите установить адрес вывода RPL, **крайне важно установить его на другой адрес, контролируемый холодным кошельком.**
Холодный кошелек может быть аппаратным кошельком (таким как [Ledger](https://www.ledger.com/), [Trezor](https://trezor.io/) или [Grid+](https://gridplus.io/)) или кошельком Smart Contract (таким как [Safe](https://app.safe.global/welcome)).

Мы **настоятельно рекомендуем** НЕ использовать горячий кошелек, такой как MetaMask, в качестве адреса вывода RPL.

Таким образом, если ваш кошелек ноды будет скомпрометирован, атакующий не получит доступ к вашему staked RPL, заставляя вас выйти, потому что все эти средства будут отправлены на ваш отдельный холодный кошелек (к которому они, надеюсь, не имеют доступа).

Адреса вывода RPL устанавливаются на уровне оператора ноды.
Если вы создадите несколько minipools, все они будут ссылаться на один и тот же адрес вывода RPL, поэтому вам нужно выполнить эту настройку только один раз.

[См. здесь](https://ethereum.org/en/security/#wallet-security) некоторые основы безопасности кошелька от Ethereum Foundation.
:::

Есть два разных способа сделать это.
Пожалуйста, прочитайте оба варианта ниже, чтобы определить, какой из них применим к вам.

<div className="p-3">
  <Tabs>
    <Tab label="Метод 1">
      *Используйте этот метод, если ваш новый адрес вывода RPL может быть использован для подписи транзакций через MetaMask или WalletConnect.**

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">ПРИМЕЧАНИЕ</p>
        Этот метод потребует от вас **отправить транзакцию** с вашего нового адреса вывода RPL, поэтому **у вас должна быть небольшая сумма ETH на этом адресе.**
      </p>

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">ПРИМЕЧАНИЕ</p>
        Для пользователей аппаратных кошельков **Ledger** обратите внимание, что Ledger Live пока не поддерживает MetaMask или WalletConnect нативно.
        Вместо этого вам нужно будет использовать MetaMask и подключить его к вашему Ledger.
        Следуйте [официальным инструкциям Ledger](https://www.ledger.com/academy/security/the-safest-way-to-use-metamask), чтобы сделать это.

        Для работы с веб-сайтом Rocket Pool вам нужно будет подключить Ledger, разблокировать его и открыть приложение ETH.
        Вам также нужно будет **включить "blind signing"** для текущей сессии; вы можете найти это в разделе Settings приложения ETH на устройстве.
        Bind signing будет автоматически отключен после закрытия сессии.

        Если вы используете Hoodi Testnet и хотите использовать свой Ledger в качестве адреса вывода RPL, **вы должны сначала создать новый кошелек Ethereum на вашем Ledger**, чтобы не подключать ваш живой адрес к тестовой сети, что обычно вызывает путаницу.
        Убедитесь, что вы выбрали **Hoodi Testnet** в выпадающем списке выбора сети при подключении вашего Ledger к MetaMask.
        Обратите внимание, что Ledger Live не покажет ваш баланс в тестовой сети, но другие приложения, которые поддерживают тестовую сеть (такие как MetaMask и Etherscan), смогут его отобразить.
      </p>

      1. Запустите `rocketpool node set-rpl-withdrawal-address 'your cold wallet address or ENS name'`. Ваш новый адрес вывода RPL будет помечен как "pending". Пока вы не подтвердите его, **ваш старый адрес вывода RPL все еще будет использоваться**.
      2. Чтобы подтвердить его, вы должны отправить специальную транзакцию **с вашего нового адреса вывода RPL** в контракт minipool, чтобы подтвердить, что вы владеете адресом вывода RPL.
      1. Самый простой способ сделать это - перейти на сайт адреса вывода RPL Rocket Pool (для [Hoodi Testnet](https://testnet.node.rocketpool.net/rpl-withdrawal-address) или для [Mainnet](https://node.rocketpool.net/rpl-withdrawal-address)).
      3. Если вы еще не подключили Metamask или WalletConnect к веб-сайту Rocket Pool, сделайте это сейчас. Нажмите кнопку **select wallet** в центре экрана и выберите MetaMask или WalletConnect в зависимости от того, какой кошелек вы хотите использовать. Затем вам будет предложено подтвердить подключение. Например, используя MetaMask:

      Нажмите **Next**, затем нажмите **Confirm**, чтобы разрешить веб-сайту Rocket Pool использовать ваш кошелек. 3. Выберите **RPL Withdrawal Address** из верхнего меню (или из меню гамбургера слева, если вы на мобильном устройстве). 4. Вы увидите это приглашение:

      4. Введите **адрес кошелька вашей ноды** здесь и нажмите на оранжевую кнопку **Find**, чтобы продолжить.

      <img src={nodeAddress} width="100%" height="auto"/>

      1.  Вам будет предложено подтвердить ожидающий адрес вывода RPL. Это должен быть тот же адрес, который вы использовали при запуске этой команды ранее: `rocketpool node set-rpl-withdrawal-address` Выберите **Confirm Pending**, когда будете готовы.
      2.  Теперь в вашем кошельке должно появиться новое диалоговое окно подтверждения. Снова, используя MetaMask в качестве примера, нажмите на значок MetaMask, чтобы открыть его, и вы должны увидеть что-то вроде этого:

      Нажмите **Confirm**, чтобы отправить транзакцию в сеть. Это займет некоторое время, пока она не будет включена в блок, но как только это произойдет, вы увидите диалоговое окно подтверждения:

      <img src={rplWithdrawalConfirmation} width="100%" height="auto"/>

      5. Ваш новый адрес вывода RPL теперь будет подтвержден и активирован. Вы можете просмотреть это с помощью `rocketpool node status`.
    </Tab>
    <Tab label="Метод 2">
      **Используйте этот метод только если ваш адрес вывода RPL _не может_ быть использован для подписи транзакций через MetaMask или WalletConnect.**

      В этом методе вы запустите:

      ```shell
      rocketpool node set-rpl-withdrawal-address --force `your cold wallet address`
      ```

      Вам будет предложена возможность отправить тестовую транзакцию перед подтверждением, чтобы убедиться, что у вас правильный адрес.
      Если вы подтвердите эту команду при запросе, ваш новый адрес вывода RPL будет установлен немедленно.


      <p className="rspress-directive danger">
        Делая это, вы обходите меру безопасности, связанную с Методом 1, которая требует от вас доказать, что вы владеете новым адресом.
        Если вы сделаете опечатку здесь, нет способа отменить это, и **награды вашего minipool будут потеряны навсегда**.

        Мы **настоятельно** рекомендуем вам использовать механизм тестовой транзакции перед подтверждением, и, если возможно, использовать Метод 1 вместо этого.
      </p>
    </Tab>

  </Tabs>
</div>

После этого вы **больше не сможете изменить свой адрес вывода RPL с помощью команды `set-rpl-withdrawal-address`**.
Чтобы изменить его, вам нужно будет отправить подписанную транзакцию с вашего **активного** адреса вывода RPL (того, на который вы только что переключились).
Веб-сайт Rocket Pool имеет функцию, которая поможет вам это сделать.

Если вы хотите отменить установку адреса вывода RPL, процесс довольно прост. Во-первых, вы захотите вернуться на страницу RPL Withdrawal Address на веб-сайте Rocket Pool.

<div className="p-3">
  <Tabs>
    <Tab label="Hoodi Testnet">https://testnet.node.rocketpool.net/rpl-withdrawal-address</Tab>
    <Tab label="Mainnet">https://node.rocketpool.net/rpl-withdrawal-address</Tab>
  </Tabs>
</div>

Если вы вошли с адреса вывода RPL ноды, вы должны увидеть кнопку **unset** справа здесь:

<img src="./images/unset_rpl_withdrawal.png" width="100%" height="auto" />

Нажатие **unset** переведет вас на страницу, где вы можете подтвердить детали. Если вы довольны тем, что видите, нажмите оранжевую кнопку **unset**, чтобы отправить транзакцию в сеть.

Вот и все, что касается установки адреса вывода RPL! Мы надеемся, что вы нашли процесс быстрым и простым.

Не стесняйтесь заглянуть на [наш сервер Discord](https://discord.gg/G46XgK264a), чтобы сообщить нам, что вы об этом думаете, и следить за развитием проекта.
