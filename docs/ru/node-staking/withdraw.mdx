---
next:
  text: Спасение распущенного Minipool
  link: "/ru/node-staking/rescue-dissolved"
---

# Закрытие Minipool

## Выход вашего валидатора

Когда вы решили, что больше не хотите запускать minipool и хотите получить доступ к полному балансу, заблокированному в Beacon Chain, вам необходимо выполнить несколько шагов:

1. Отправить запрос на добровольный выход для валидатора minipool из Beacon Chain.
2. Дождаться выхода вашего валидатора.
3. Дождаться вывода баланса вашего валидатора в ваш minipool на уровне исполнения.
4. Закрыть minipool для распределения вознаграждений и доступа к средствам

Мы рассмотрим каждый шаг ниже.

### Отправка запроса на выход

Если вы хотите вывести валидатора, привязанного к minipool, выполните следующую команду:

```shell
rocketpool minipool exit
```

Вам будет представлен список minipools, которые можно вывести:

```
Please select a minipool to exit:
1: All available minipools
2: 0x7E5700bcd65B1770bA68abB288D3f53814d376aC (staking since 2023-02-08, 06:33 +0000 UTC)
3: 0xd8E804cFA64ADb386F52DB20717810130c90f674 (staking since 2023-02-08, 06:33 +0000 UTC)
```

После того как вы подтвердите, что хотите выйти, ваша нода отправит запрос на добровольный выход в Beacon Chain.
Это **не** обычная транзакция уровня исполнения, поэтому вам не нужно платить за газ.

Если вам нужен публичный ключ валидатора для только что выведенного minipool, вы можете получить его с помощью `rocketpool minipool status`.
Вы можете просмотреть статус выхода вашего валидатора в обозревателе Beacon Chain, таком как [https://beaconcha.in](https://beaconcha.in) (или [https://hoodi.beaconcha.in](https://hoodi.beaconcha.in) для тестовой сети Hoodi).
Потребуется некоторое время для обновления вашего статуса, но как только это произойдет, вы увидите его в состоянии "exiting":

<img src="./images/exiting.png" width="100%" height="auto" />

Здесь вы можете видеть, что статус `Exiting`, эпоха, в которую он выйдет, выделена (5224), и иконка "Exited" будет мигать зеленым, указывая на то, что операция выполняется.
Может потребоваться некоторое время для выхода вашего валидатора, _особенно_ если большое количество валидаторов выходит из Beacon Chain одновременно; протокол разработан таким образом, чтобы разрешать выход только небольшому количеству валидаторов за эпоху, поэтому вам, возможно, придется подождать своей очереди.

После того как ваша эпоха выхода прошла, ваш валидатор официально выйдет из цепи и больше не будет аттестовать или предлагать блоки.
Вы можете подтвердить это в логах вашего клиента валидатора или в обозревателе:

<img src="./images/exited.png" width="100%" height="auto" />

Статус изменился на `Exited`, и под ним есть текст, указывающий вашу **эпоху вывода** (которая должна быть через 256 эпох после выхода, или примерно через 27 часов).
Beaconcha.in также удобно предоставляет локальные временные метки для того, когда ваш валидатор выйдет и когда он станет доступным для вывода.

Как только он войдет в состояние **withdrawable**, ваш валидатор будет поставлен в очередь Beacon Chain для распределения вознаграждений.
Эта очередь зависит от того, сколько валидаторов в настоящее время выводят средства.
Когда придет ваша очередь, Beacon Chain _автоматически_ отправит ваш баланс на адрес вашего minipool на уровне исполнения.
В этот момент вы можете получить к нему доступ, используя Smartnode CLI для выполнения распределения.

### Распределение полных вознаграждений

::: tip ПРИМЕЧАНИЕ
Этот процесс требует, чтобы ваш валидатор был выведен из Beacon Chain, а баланс вашего валидатора был переведен в контракт minipool.
Если вам нужно напоминание о том, как это сделать, пожалуйста, смотрите раздел [**Выход вашего валидатора**](#выход-вашего-валидатора) выше - вернитесь сюда, когда закончите.
:::

Если вы вывели своего валидатора из Beacon Chain и ваш баланс был внесен в контракт minipool, вы можете безопасно вывести все одной командой.
В отличие от [ручного распределения](./skimming#manual-distribution), этот процесс фактически **завершит** ваш minipool, что закрывает его и делает неактивным.
После того как ваш баланс был выведен из Beacon Chain и вы пройдете следующий процесс для доступа к средствам, обязанность minipool закончена.

Чтобы получить средства и закрыть minipool, выполните следующую команду:

```shell
rocketpool minipool close
```

Это представит вам список minipools, которые подходят для закрытия:

```
Please select a minipool to close:
1: All available minipools
2: 0xd8E804cFA64ADb386F52DB20717810130c90f674 (32.007209 ETH available, 8.002559 ETH is yours plus a refund of 0.000000 ETH)
```

Здесь вы можете видеть общий баланс для каждого подходящего minipool, сколько из этого баланса будет распределено вам, и сколько из этого баланса зарезервировано для вас в качестве возврата (который обходит распределение).

Выберите, какой minipool вы хотели бы распределить и закрыть из списка, подтвердите действие и дождитесь подтверждения вашей транзакции.
Как только это произойдет, ваша доля баланса minipool (и ваш возврат) будет отправлена на ваш адрес для вывода, а minipool войдет в состояние `finalized`.

Вы можете проверить это, посмотрев на транзакцию в обозревателе блоков; например, смотрите [транзакцию закрытия вышеуказанного minipool (тестовая сеть Goerli)](https://goerli.etherscan.io/tx/0xe81415b3b66f9b42d43ac17a0983e792725726c9fdd35ac855745bd12a053509).

### Анстейкинг RPL

На этом этапе ваш эффективный RPL будет обновлен, чтобы удалить этот minipool из расчета.
Теперь вы можете анстейкнуть любой RPL, который у вас есть, что поставит вас выше порога 60% залоговых ETH.

Чтобы анстейкнуть RPL против ноды, выполните следующую команду:

```shell
rocketpool node withdraw-rpl
```

::: tip ПРИМЕЧАНИЕ
Существует два ограничения на вывод RPL:

RPL нельзя вывести в течение 28 дней после стейкинга (или рестейкинга) RPL. Будьте осторожны, если вы заявляете эти вознаграждения перед закрытием вашего minipool, если вы рестейкните любое количество вознаграждений RPL, вы не сможете вывести никакое количество RPL в течение 28 дней с момента последнего действия стейкинга.

RPL можно вывести до 60% от вашего общего залогового ETH. При полном выходе это означает, что все можно вывести; для частичных выходов планируйте с учетом этого ограничения.
:::

## Примечание о старом делегате

**Оригинальный делегат minipool**, назначенный каждому minipool с момента запуска Rocket Pool до развертывания Atlas, был создан с учетом двух предположений:

1. Единственный раз, когда ваш minipool будет иметь баланс, это после того, как валидатор вышел из Beacon Chain.
2. Oracle DAO изменит состояние вашего minipool с "staking" на "withdrawable" после того, как баланс был переведен из Beacon Chain в контракт minipool.

Первый пункт явно больше не актуален теперь, когда Ethereum обновляется для поддержки skimming.
Второй пункт _также_ больше не является истинным, потому что Oracle DAO **больше не** будет отмечать "withdrawable" minipools.
Это было преднамеренным решением проектирования, чтобы уменьшить власть, которую Oracle DAO имеет над операторами нод Rocket Pool, и позволить им получать доступ к вознаграждениям без каких-либо дополнительных требований к доверенным сторонам.

Из-за этих недостатков Smartnode CLI **больше не поддерживает** выводы или распределение средств на оригинальном делегате minipool.
Если вы хотите получить доступ к своим вознаграждениям, вы **должны** обновиться до делегата Atlas, который поддерживает новые условия вывода, перечисленные выше.

::: danger ОПАСНОСТЬ
Если вы опытный пользователь и обходите CLI, чтобы вызвать функциональность распределения в контракте напрямую через сторонний инструмент, имейте в виду следующее:

1. Функция распределения делегата вернет ошибку, если баланс minipool **ниже 16 ETH**. Балансы ниже 16 ETH **не могут быть доступны.**
2. Если minipool имеет **от 16 до 32 ETH** на балансе, распределение оригинальным делегатом будет предполагать, что ваш валидатор был **наказан**. Он вернет 16 ETH в пул стейкинга и даст вам все, что осталось. Он будет функционировать правильно _только_ если баланс minipool выше 32 ETH.
3. Minipool никогда не войдет в состояние `finalized`, потому что Oracle DAO никогда не пометит его как `withdrawable`, поэтому, даже если вы сможете получить доступ к своим ETH, **ваш RPL будет заблокирован** до тех пор, пока вы не обновитесь до делегата Atlas.

Из-за этих пунктов мы **настоятельно рекомендуем** вам просто обновиться до делегата Atlas в первую очередь и полностью избежать их.
:::
