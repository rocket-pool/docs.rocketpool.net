import tui_select_ec from "./images/tui-select-ec.png";
import tui_confirm_ec from "./images/tui-confirm-ec.png";
import tui_select_cc from "./images/tui-select-cc.png";
import tui_checkpoint_sync from "./images/tui-checkpoint-sync.png";
import tui_confirm_cc from "./images/tui-confirm-cc.png";

# Изменение Execution или Consensus Client

При нормальных обстоятельствах вы, вероятно, просто выберете Execution и Consensus client при первом создании вашей ноды Rocket Pool и позволите им успешно работать на протяжении всей жизни вашей ноды.
Однако есть несколько ситуаций, когда вы можете захотеть изменить свой выбор client.
Вот несколько примеров:

- Ваш client получает [сверхбольшинство](https://clientdiversity.org/) долю в цепях Execution или Beacon, и вы хотите измениться ради общего здоровья сети
- Ошибка приводит к тому, что ваш client перестает функционировать корректно, и вам нужно быстро вернуться в онлайн, чтобы возобновить обязанности по валидации
- Вы хотите попробовать новую функцию, которую предлагает другой client
- Другой client лучше подходит для оборудования вашей ноды (например, некоторые client лучше работают на системах ARM, чем другие)

К счастью, стек Smartnode делает изменение client чрезвычайно простым.
Все, что нужно, — это несколько изменений в TUI конфигурации и некоторые дополнительные команды для резервного копирования существующих данных client перед их изменением.

## Изменение Execution Client

Перед изменением вашего Execution client стоит отметить следующие моменты:

- Данные цепи **не являются общими** между client. Вашему новому client потребуется повторно синхронизировать данные цепи Mainnet, что может занять некоторое время (хотя каждый client поддерживает snap sync, который Smartnode использует для ускорения повторной синхронизации).
- По умолчанию Smartnode оставит данные цепи вашего старого client на вашем диске на случай, если вы захотите вернуться к своему старому Execution client и продолжить с того места, где остановились. Возможно, вы захотите **экспортировать их в другое расположение** и удалить, чтобы освободить место перед изменением client, поскольку Execution client могут использовать сотни гигабайт. Ниже мы приводим шаги, как это сделать.
- Пока ваш новый client синхронизируется повторно, большинство функций CLI Smartnode будут офлайн, поскольку они зависят от Execution client. **У вас должен быть доступен резервный Execution client перед этим, чтобы смягчить простой вашего Smartnode.**

### (Необязательно) Экспорт базы данных вашего Execution Client

Первый шаг в процессе необязательный: если хотите, вы можете экспортировать существующие данные цепи для вашего текущего Execution client.
Это позволит вам освободить ценное дисковое пространство на вашей ноде для вашего нового Execution client, и вы сможете сохранить старые данные цепи на случай, если захотите вернуться к старому client и продолжить с того места, где остановились.

Пожалуйста, обратитесь к руководству [Резервное копирование вашей ноды](./backups##резервное-копирование-данных-цепи-execution) для подробностей.

### Измените ваш выбранный Execution Client

Чтобы изменить выбранный client, выполните `rocketpool service config` для входа в пользовательский интерфейс конфигурации.
Перейдите в раздел `Execution Client (ETH1)` и выберите выпадающий список `Execution Client`:

<img src={tui_select_ec} width="100%" height="auto" />

Откройте выпадающий список с помощью `Enter`, используйте клавиши со стрелками для навигации к выбранному вами client и снова нажмите `Enter`, чтобы подтвердить выбор.

Обратите внимание, что каждый client имеет свои уникальные опции, поэтому вы можете увидеть некоторые дополнительные настройки на этом экране после выбора другого client.
Не стесняйтесь изучать их, чтобы увидеть, как они влияют на работу.

Когда вы будете довольны своим выбором, нажмите `Esc`, чтобы вернуться в главное меню, затем `Tab`, чтобы выделить кнопку `Review Changes and Save`.
Вам будет представлен экран просмотра, который покажет изменение выбора вашего client:

<img src={tui_confirm_ec} width="100%" height="auto" />

Нажмите `Enter`, чтобы принять изменения, и готово!
Ваш новый Execution client начнет синхронизацию немедленно.
Как обычно, вы можете следить за этим с помощью `rocketpool service logs eth1`.
**Мы рекомендуем вам сделать это, чтобы убедиться, что нет ошибок и что все работает правильно.**

::: danger ПРИМЕЧАНИЕ
Теперь, когда уровни Execution и Consensus объединились, остановка вашего Execution client _также_ остановит ваш Consensus client до тех пор, пока ваш Execution client не завершит повторную синхронизацию.
Это означает, что ваша нода **прекратит аттестацию и предложение блоков, и будет терять ETH вместо того, чтобы зарабатывать его!**

Чтобы избежать этого и продолжить валидацию во время повторной синхронизации вашего Execution client, **пожалуйста, настройте [резервную ноду](./fallback)**.
:::

### (Рекомендуется) Удалите ваши старые данные цепи

Это не обязательный шаг, но мы **настоятельно рекомендуем** вам удалить данные цепи вашего старого client теперь, когда вы переключились на новый, чтобы освободить дисковое пространство для него.

Чтобы сделать это, просто выполните следующую команду:

```shell
rocketpool service resync-eth1
```

Это удалит все данные вашего Execution client и начнет заново.

::: tip СОВЕТ
Поскольку вы только что выбрали новый Execution client, это не повлияет на него — по сути, все, что он сделает, — это удалит ваши старые данные цепи.
Вы должны сделать это как можно скорее после переключения client, чтобы предотвратить ненужную потерю прогресса на вашем новом client.
:::

## Изменение Consensus Client

Изменение Consensus client еще проще, чем Execution client, благодаря [Checkpoint Sync](./config-docker#beacon-chain-checkpoint-syncing).
Эта функция позволяет немедленно синхронизировать новый Consensus client с сетью, поэтому нет необходимости сохранять старые данные цепи.

Начните с использования пользовательского интерфейса `rocketpool service config` и перейдите в раздел `Consensus Client (ETH2)`.
Далее выберите выпадающий список `Consensus Client`:

<img src={tui_select_cc} width="100%" height="auto" />

Откройте выпадающий список с помощью `Enter`, используйте клавиши со стрелками для навигации к выбранному вами client и снова нажмите `Enter`, чтобы подтвердить выбор.

Обратите внимание, что каждый client имеет свои уникальные опции, поэтому вы можете увидеть некоторые дополнительные настройки на этом экране после выбора другого client.
Не стесняйтесь изучать их, чтобы увидеть, как они влияют на работу.

Далее убедитесь, что вы используете провайдера Checkpoint Sync:

<img src={tui_checkpoint_sync} width="100%" height="auto" />

Если у вас не настроен провайдер Checkpoint Sync, [вы можете легко сделать это бесплатно, используя инструкции отсюда](./config-docker#beacon-chain-checkpoint-syncing)!

Когда вы будете довольны своим выбором, нажмите `Esc`, чтобы вернуться в главное меню, затем `Tab`, чтобы выделить кнопку `Review Changes and Save`.
Вам будет представлен экран просмотра, который покажет изменение выбора вашего client:

<img src={tui_confirm_cc} width="100%" height="auto" />

Нажмите `Enter`, чтобы принять изменения, и готово!
Ваш новый Consensus client начнет синхронизацию немедленно.
Как обычно, вы можете следить за этим с помощью `rocketpool service logs eth2`.
**Мы рекомендуем вам сделать это, чтобы убедиться, что нет ошибок и что все работает правильно.**
