import { Tab, Tabs } from "@rspress/core/theme";

# Участие в on-chain предложениях pDAO

Любая нода с ненулевой силой голоса может выдвинуть или участвовать в предложении pDAO в любое время. Предложения могут быть одного из следующих типов:

- Изменение настроек pDAO
- Одноразовые расходы казначейства
- Повторяющиеся расходы казначейства (комитеты управления)
- Членство в Security Council

Для получения более подробной информации и обоснования обратитесь к [типам предложений](https://rpips.rocketpool.net/RPIPs/RPIP-33#proposal-types).
Важно понимать, что предложение pDAO — это on-chain сущность, которая существует для выполнения изменений на уровне протокола.

## Процесс управления

Предложение должно быть предсказано процессом управления до того, как оно окажется on-chain.

Изменения в протоколе Rocket Pool предлагаются, голосуются и выполняются с использованием строгого, но прозрачного процесса управления. Процесс начинается с неформального обсуждения идеи в сообществе Discord. Затем эта идея переходит к формальным обсуждениям в канале [#governance](https://discordapp.com/channels/405159462932971535/774497904559783947) в Discord и на [DAO Forum](https://dao.rocketpool.net/), где она подвергается тщательному исследованию, моделированию и проверке при подготовке к [Rocket Pool Improvement Proposal (RPIP)](https://rpips.rocketpool.net/). После этого готовится черновик RPIP и проверяется назначенными рецензентами RPIP, чтобы обеспечить его качество и готовность к представлению DAO.
Черновик предложения затем представляется DAO на форуме для дальнейшего рассмотрения, обратной связи и внесения необходимых изменений. Как только предложение будет доработано на основе вклада сообщества, на форуме DAO проводится опрос для оценки готовности к завершению текста RPIP. Если опрос проходит, указывая на одобрение сообщества, RPIP помечается как окончательный и готов к голосованию Protocol DAO, которое проводится через Snapshot, чтобы определить, следует ли внедрять предложение.

Отсюда Oracle DAO выдвинет on-chain предложение. Есть окно, в течение которого Protocol DAO, Oracle DAO и сообщество могут рассмотреть предложение. Если достигается консенсус, предложение выполняется, и изменения применяются к протоколу.

Удобное визуальное представление этого процесса можно найти на [сайте Rocket Pool](https://rocketpool.net/governance/process).

## Предварительное условие

Пожалуйста, прочитайте [жизненный цикл предложения](./pdao#lifecycle-of-a-pdao-proposal) перед продолжением. Это объяснит различия между всеми периодами голосования и действиями, которые можно предпринять в течение каждого периода.

Остальная часть этой страницы проведёт вас через шаги, необходимые для участия в on-chain предложениях pDAO.

## Инициализация голосования

Если вы оператор ноды, который зарегистрировался до обновления Houston, вам нужно инициализировать голосование, чтобы разблокировать силу голоса. Имейте в виду, что наличие хотя бы одного minipool является требованием для обладания силой голоса.

```shell
rocketpool pdao initialize-voting
```

Эта команда вызовет приглашение ниже. Пожалуйста, прочтите его внимательно:

```
Thanks for initializing your voting power!

You have two options:

1. Vote directly (delegate vote power to yourself)
   This will allow you to vote on proposals directly,
   allowing you to personally shape the direction of the protocol.

2. Delegate your vote
   This will delegate your vote power to someone you trust,
   giving them the power to vote on your behalf. You will have the option to override.

You can see a list of existing public delegates at https://delegates.rocketpool.net,
however, you can delegate to any node address.

Learn more about how this all works via: /ru/pdao/participate#participating-in-on-chain-pdao-proposals

Please type `direct` or `delegate` to continue:
```

- Если вы ответите `direct`, сила голоса будет инициализирована для вашей ноды, и вы сможете голосовать напрямую по предложениям Protocol DAO.
- Если вы ответите `delegate`, у вас будет возможность сэкономить немного газа, инициализируя голосование и [устанавливая делегата](./participate#delegating-voting-power) в рамках одной транзакции.

Вам нужно сделать это только один раз. Это настраивает начальную информацию snapshot для ноды. После инициализации голосования каждое предпринятое действие будет обновлять информацию snapshot вашей ноды. Как только ваша сила голоса инициализирована, вы можете проверить, сколько у вас её, используя следующую команду smartnode:

```shell
rocketpool pdao status
```

:::tip ПРИМЕЧАНИЕ
Когда создаётся новое предложение, дерево голосования, представляющее snapshot силы голоса и информации о делегатах сети, создаётся вместе с новым предложением. Это означает, что сила голоса вашей ноды не будет включена в предложение, если оно было выдвинуто до того, как вы инициализировали голосование. `rocketpool pdao status` отобразит силу голоса вашей ноды на последнем блоке, которая может быть репрезентативной или не репрезентативной для вашей силы голоса по конкретному предложению.
:::

## Автоматическая инициализация силы голоса

Smartnode версии `1.13.8` вводит новую функцию **Auto Initialize Vote Power**, которая предназначена для автоматической инициализации силы голоса на нодах, которые ещё этого не сделали. Автоматически инициализированная сила голоса делегируется самому себе.
Эту функцию можно настроить в настройках Smartnode, выполнив `rocketpool service config` и перейдя в раздел **Smartnode and TX Fees**.

<img src="./images/auto_init_vp.png" width="100%" height="auto" />

**Auto-Init Vote Power Gas Threshold** — это лимит (в gwei) на эту автоматическую транзакцию. Вы можете отказаться от этой задачи, установив порог на 0. Не стесняйтесь отказываться, если ваша нода была зарегистрирована после обновления Houston или если сила голоса уже включена.

## Установка вашего адреса сигнализации Snapshot

Установка вашего адреса сигнализации Snapshot позволит вам участвовать в голосованиях Snapshot на браузере или мобильном устройстве без необходимости раскрывать ключи ноды горячему кошельку.

Необходимо подготовить несколько вещей:

- Адрес вашей ноды
- Адрес, который вы хотите использовать для голосования в snapshot (адрес сигнализации)

Вы будете подписывать сообщение, говорящее, что адрес вашей ноды может делегировать новому адресу. Это сообщение заявляет о вашем намерении использовать адрес вашего кошелька в качестве адреса сигнализации Snapshot.

Выберите, какую сеть вы используете, из одной из вкладок ниже.

<div className="p-3">
  <Tabs>
    <Tab label="Hoodi Testnet">Если вы пробуете это в тестовой сети Hoodi, вы можете подписать на этой странице: https://testnet.node.rocketpool.net/signalling-address</Tab>
    <Tab label="Mainnet">Если вы готовы настроить это в mainnet, перейдите сюда: https://node.rocketpool.net/signalling-address</Tab>
  </Tabs>
</div>

:::danger ПРЕДУПРЕЖДЕНИЕ
Не загружайте приватный ключ вашей ноды в горячий кошелёк. Пожалуйста, выберите другой аккаунт в качестве адреса сигнализации.
После установки адреса сигнализации вы можете использовать его для голосования в Snapshot с силой голоса вашей ноды.
:::

Начните с **подключения адреса, который вы хотите использовать в качестве адреса сигнализации**, к веб-сайту, используя MetaMask, WalletConnect или любой из других методов, которые поддерживает веб-сайт. Затем вам будет представлен этот диалог для поиска адреса вашей ноды.

Далее вы введёте адрес вашей ноды, а затем нажмёте оранжевую кнопку "Find". Это проверит, является ли адрес зарегистрированной нодой, а затем перейдёт к следующему шагу.

:::tip СОВЕТ
**Убедитесь, что у вас правильный адрес ноды, прежде чем делать это!** Если вам нужно подтвердить адрес вашей ноды, вы можете быстро получить его через CLI, используя команду `rocketpool node status`.
:::

Как только вы войдёте и подтвердите адрес вашей ноды, вы увидите ваш **адрес сигнализации Snapshot**. Он должен совпадать с аккаунтом, в который вы вошли на сайт. Дважды проверьте, что это правильно, прежде чем продолжить. Как только вы уверены, что вы вошли в желаемый аккаунт, нажмите оранжевую кнопку "Sign Message". Вы увидите запрос в вашем приложении расширения кошелька для подписи следующего сообщения:

```
`snapshot signalling address` may delegate to me for Rocket Pool governance
```

Подпись не будет стоить вам газа, но установка будет стоить. После того, как вы подпишете, интерфейс даст вам команду для вставки в smartnode. Вставьте её в CLI вашего smartnode и следуйте предложенным шагам. Команда должна выглядеть примерно так:

```shell
rocketpool pdao set-signalling-address
`snapshot signalling address`
`EIP712 signature`
```

Если вы видите это сообщение в вашем CLI, всё готово!

```
The node's signalling address was successfully set to `snapshot signalling address`
```

:::tip СОВЕТ
Не беспокойтесь, если вы случайно закроете сайт или потеряете команду. Вы можете просто повторить шаги и **подписать снова, используя тот же адрес ноды и адрес сигнализации**. Интерфейс использует `signer.Signmessage()` из библиотеки ethers, что означает, что ваша подпись детерминирована при одинаковом входе.
Нажмите [здесь](https://docs.ethers.org/v6/api/providers/#cid_865), чтобы узнать больше.
:::

Очистка вашего адреса сигнализации довольно проста, просто используйте эту команду в CLI:

```shell
rocketpool pdao clear-signalling-address
```

## Разрешение блокировки RPL

Вы можете проигнорировать этот шаг, если вас интересует только голосование по предложению. Разрешение блокировки RPL требуется только для тех, кто желает предложить или оспорить предложение.

Блокировка RPL требуется для предложения и оспаривания. По умолчанию блокировка RPL для любой цели будет отключена. Операторы нод будут соглашаться на выполнение действий управления, разрешая блокировку RPL со своей ноды или основного адреса вывода средств. Вы можете сделать это, используя эту команду в Smartnode:

```shell
rocketpool node allow-rpl-locking
```

Это предложит вам разрешить блокировку RPL при создании или оспаривании предложений управления. И наоборот, вы можете использовать следующую команду, чтобы отказаться от блокировки RPL:

```shell
rocketpool node deny-rpl-locking
```

::: tip ПРИМЕЧАНИЕ
Заблокированный RPL действует так же, как обычный застейканный RPL для целей вознаграждений, голосования и требований к обеспечению.
Заблокированный RPL не учитывается в пороговых значениях для вывода RPL.
:::

## Делегирование силы голоса

Оператор ноды может решить делегировать свою силу голоса другому оператору ноды. Единственное требование заключается в том, что ваш делегат является зарегистрированной нодой.

Чтобы делегировать on-chain силу голоса другой ноде, используйте следующую команду:

```shell
rocketpool pdao set-voting-delegate `address`
```

::: tip ПРИМЕЧАНИЕ
Если вы делегировали свою силу голоса другому оператору ноды, вы можете сбросить это, установив адрес делегата на адрес вашей собственной ноды.
:::

- Во время фазы 1 предложения: **Избиратели** и **Делегаты** могут отдать свой голос по предложению.
- Во время фазы 2 предложения: **Операторы нод**, которые делегировали свой голос, получают возможность отменить голос своего делегата, если они не согласны.

Если вы оператор ноды с делегированной силой голоса, вы должны голосовать во время фазы голосования 1, чтобы делегированная сила голоса учитывалась для предложения. Ваш голос в фазе 1 будет стоить вашу **локальную силу голоса + делегированную силу голоса**. Ваш голос в фазе 2 стоит только вашу **локальную силу голоса**.

## Создание предложения

Чтобы иметь право на предложение, нода должна соответствовать нескольким требованиям:

- Включена в снимки (либо путём [инициализации голосования](./participate#initializing-voting), либо путём регистрации после Houston)
- Должна иметь хотя бы один minipool
- Имеет ненулевую силу голоса
- Разрешила [блокировку RPL](./participate#allowing-rpl-locking)
- Имеет стейк RPL (за вычетом любого уже заблокированного RPL) больше, чем залог предложения

Предложения существуют для изменения параметров и выполнения кода на уровне протокола! Должно быть обсуждение и консенсус через процесс [управления](./participate#governance-process) до того, как предложение будет создано on-chain.

Используйте команду `rocketpool pdao propose`, чтобы вызвать меню опций

```
COMMANDS:
   rewards-percentages, rp      Propose updating the RPL rewards allocation percentages for node operators, the Oracle DAO, and the Protocol DAO
   one-time-spend, ots          Propose a one-time spend of the Protocol DAO's treasury
   recurring-spend, rs          Propose a recurring spend of the Protocol DAO's treasury
   recurring-spend-update, rsu  Propose an update to an existing recurring spend plan
   security-council, sc         Modify the security council
   setting, s                   Make a Protocol DAO setting proposal
```

Каждая из этих команд предложит вам список вводов для создания вашего желаемого предложения. В этом руководстве мы пригласим ноду в Security Council в качестве примера. Чтобы выдвинуть предложение о приглашении ноды в Security Council, вы бы использовали команду:

```shell
rocketpool pdao propose security-council invite
```

Имейте в виду, что этот шаг будет иметь некоторые незначительные вариации в зависимости от типа предложения. Эта конкретная команда:
`rocketpool pdao propose security-council invite` предложит вам ввести ID, а затем адрес участника.

```
Please enter an ID for the member you'd like to invite: (no spaces)
test-member

Please enter the member's address:
0xBdbcb42DD8E39323a395B2B72d2c8E7039f1F145

... gas estimations ...

Are you sure you want to propose inviting test-member (0xBdbcb42DD8E39323a395B2B72d2c8E7039f1F145) to the security council? [y/n]
```

После того, как это будет включено в блок, будет создано предложение pDAO! Предложение войдёт в [период задержки голосования](./pdao#vote-delay-period) при создании.

## Просмотр состояния предложения

Каждому предложению присваивается `proposalID`. В этом случае наше предложение пригласить `0xBdbc...` в Security Council представлено `ID 71`. Есть несколько способов просмотреть состояние предложения. Один метод отобразит список каждого предложения pdao вместе с их состоянием (ожидание, успех, выполнено и т. д.). Второй метод отображает подробную информацию о конкретном предложении.

<div className="p-3">
  <Tabs>
    <Tab label="Просмотр списка предложений">
      Чтобы перечислить все предложения, используйте следующую команду:

      ```shell
      rocketpool pdao proposals list
      ```

      Это отобразит список всех предложений и их состояние

      ```
      1 Pending proposal(s):

      71: invite test-member (0xBdbcb42DD8E39323a395B2B72d2c8E7039f1F145) to the security council - Proposed by:
      0x681B8BBf08708e64694005c7Dc307b381b4D1A7D

      Succeeded proposal(s):

      Executed proposal(s):

      Destroyed proposal(s):

      Quorum not Met proposal(s):

      Defeated proposal(s):

      Expired proposal(s):

      ```

      Здесь мы можем видеть, что наше предложение `invite test-member` имеет ID 71 и находится в состоянии ожидания. В этом состоянии [оспаривающие](/ru/pdao/pdao#challenge-process) могут оспорить действительность pollard дерева Меркла (используемого для расчёта силы голоса), предоставленного предлагателем. Когда `proposal.vote.delay.time` закончится, предложение перейдёт в активные фазы голосования. Не стесняйтесь просмотреть [жизненный цикл предложения](./pdao#lifecycle-of-a-pdao-proposal) для обновления.
    </Tab>
    <Tab label="Просмотр деталей предложения">
      Теперь, когда у вас есть ID предложения, вы можете просмотреть статус вашего предложения, используя эту команду:

      ```shell
      rocketpool pdao proposals details `proposal-id`
      ```

      Здесь вы можете просмотреть всю информацию о конкретном предложении. Например, полезную нагрузку выполнения, в какой фазе находится предложение и направление голосования.

      ```
      Proposal ID: 71
      Message: invite test-member (0xBdbcb42DD8E39323a395B2B72d2c8E7039f1F145) to the security council
      Payload: proposalSecurityInvite(test-member,0xBdbcb42DD8E39323a395B2B72d2c8E7039f1F145)
      Payload (bytes):
      f944c19f0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000bdbcb42dd8e39323a395b2b72d2c8e7039f1f145000000000000000000000000000000000000000000000000000000000000000b746573742d6d656d626572000000000000000000000000000000000000000000
      Proposed by: 0x681B8BBf08708e64694005c7Dc307b381b4D1A7D
      Created at: 12 Mar 24 06:15 UTC
      State: Pending
      Voting start: 12 Mar 24 06:20 UTC
      Challenge window: 30m0s
      Voting power required: 90943818825
      Voting power for: 0
      Voting power against: 0
      Voting power abstained: 0
      Voting power against: 0
      Node has voted: no
      ```

      <p className="rspress-directive tip">
        <p className="rspress-directive-title">ПРИМЕЧАНИЕ</p>
        Состояние этого примера предложения — `Pending`. Это указывает на то, что предложение может быть оспорено перед переходом к `Active (Phase 1)`. Голосование не может происходить в состоянии `Pending`.
      </p>
    </Tab>

  </Tabs>
</div>

## Голосование по предложению

Во время периода голосования **Операторы нод** и **Делегаты** могут отдать голос с одним из четырёх вариантов:

```
1. Abstain: Сила голоса избирателя вносит вклад в кворум, но не является ни за, ни против предложения.
2. For: Избиратель голосует за выполнение предложения.
3. Against: Избиратель голосует против выполнения предложения.
4. Veto: Избиратель голосует против предложения, а также указывает, что считает предложение спамом или вредоносным.
```

Их сила голоса будет применена к выбранному ими варианту. Сила голоса является функцией "эффективного стейка RPL".
Более подробное чтение можно найти в [репозитории rocketpool-research](https://github.com/rocket-pool/rocketpool-research/blob/master/Protocol%20DAO/kane/pDAO%20Replacement/pDAO.md#overview-of-on-chain-voting).

::: tip ПРИМЕЧАНИЕ
Если вы оператор ноды с делегированной силой голоса, вы должны голосовать во время фазы голосования 1, чтобы делегированная сила голоса учитывалась для предложения. Ваш голос в фазе 1 будет стоить вашу локальную силу голоса + делегированную силу голоса. Ваш голос в фазе 2 стоит только вашу локальную силу голоса. Пожалуйста, имейте в виду, что нода может голосовать один и только один раз по предложению, поэтому выбирайте тщательно.
:::

Используйте эту команду для голосования:

```shell
rocketpool pdao proposals vote
```

Вам будет предложено выбрать предложение для голосования, если есть хотя бы одно предложение в активной фазе голосования.
Меню должно отображать все предложения, по которым ваша нода имеет право голосовать:

```
1: proposal 71 (message: 'invite test-member', payload: proposalSecurityInvite(test-member,0xBdbcb42DD8E39323a395B2B72d2c8E7039f1F145), phase 1 end: 14 Mar 24 05:40 UTC, vp required: 0.00, for: 0.00, against: 0.00, abstained: 0.00, veto: 0.00, proposed by: 0x681B8BBf08708e64694005c7Dc307b381b4D1A7D)
2: proposal 72 (message: 'replace langers-not-his-eoa (0xaC1396c21Eaf6630113516C69d63b7CB59B98b3E) on the security council with tpan (0x6E9E4Cc0A8172349E049128574E1fb85B8D3CE9E)', payload: proposalSecurityReplace(0xaC1396c21Eaf6630113516C69d63b7CB59B98b3E,tpan,0x6E9E4Cc0A8172349E049128574E1fb85B8D3CE9E), phase 1 end: 14 Mar 24 05:40 UTC, vp required: 0.00, for: 0.00, against: 0.00, abstained: 0.00, veto: 0.00, proposed by: 0xe2fC31d61E28BB16c0857D4682AB3616FA7A793d)
3: proposal 73 (message: 'set proposal.vote.delay.time', payload: proposalSettingUint(rocketDAOProtocolSettingsProposals,proposal.vote.delay.time,60), phase 1 end: 14 Mar 24 05:41 UTC, vp required: 0.00, for: 0.00, against: 0.00, abstained: 0.00, veto: 0.00, proposed by: 0x681B8BBf08708e64694005c7Dc307b381b4D1A7D)
```

После выбора варианта вас спросят, как вы хотите отдать свой голос.

```
How would you like to vote on the proposal?
1: Abstain
2: In Favor
3: Against
4: Veto
```

Выбор варианта затем отобразит вашу силу голоса, а затем предложит вам отправить транзакцию:

```
Your current voting power: 20123617964

+============== Suggested Gas Prices ==============+
| Avg Wait Time |  Max Fee  |    Total Gas Cost    |
| 15 Seconds    | 76 gwei   | 0.0176 to 0.0265 ETH |
| 1 Minute      | 56 gwei   | 0.0127 to 0.0190 ETH |
| 3 Minutes     | 56 gwei   | 0.0127 to 0.0190 ETH |
| >10 Minutes   | 56 gwei   | 0.0127 to 0.0190 ETH |
+==================================================+
These prices include a maximum priority fee of 2.00 gwei.
Please enter your max fee (including the priority fee) or leave blank for the default of 56 gwei:
```

Вы успешно проголосовали по предложению, как только транзакция будет включена в блок! В этот момент вы можете использовать `rocketpool pdao proposal details <proposal-id>`, чтобы просмотреть состояние предложения. Предложению необходимо достичь `proposal.quorum` **требуемой силы голоса** и большинства **силы голоса за**, чтобы оно было успешным.

```
Voting power required:  140970562215
Voting power for:       197980809837
Voting power against:   0
Voting power abstained: 0
Voting power against:   0
Node has voted:         In Favor
```

Чтобы приведённый выше пример прошёл, сила голоса должна превышать кворум `140970562215` силы голоса. Есть `197980809837` силы голоса за и нет голосов против или воздержавшихся. Предложение готово к успеху и готово к выполнению к концу `proposal.vote.phase2.time`.

## Выполнение успешного предложения

Поздравляем! Ваше предложение прошло! Теперь всё, что осталось сделать, — это выполнить предложение. Имейте в виду, что кто угодно может быть исполнителем предложения. Чтобы выполнить успешное предложение, введите команду:

```shell
rocketpool pdao execute
```

Выбор варианта предложит вам отправить транзакцию. Как только эта транзакция будет включена в блок, изменение будет применено к протоколу Rocket Pool!

```
Please select a proposal to execute:
1: All available proposals
2: proposal 71 (invite test-member (0xBdbcb42DD8E39323a395B2B72d2c8E7039f1F145) to the security council)',
proposalSecurityInvite(test-member,0xBdbcb42DD8E39323a395B2B72d2c8E7039f1F145)
```

## Получение залогов и вознаграждений

Предлагатели или оспаривающие могут получить свои залоги по завершении предложения. В зависимости от результата предложения предлагатель или оспаривающий может или не может получить свои `proposal.bond` и `proposal.challenge.bond`.

Вот несколько правил, которые диктуют условия, при которых залоги могут быть получены:

- Если предложение отклонено, предлагатель теряет свой залог, который делится пропорционально между оспаривающими, которые способствовали отклонению предложения. Все остальные оспаривающие получают обратно только свой залог.
- Вклад в отклонение предложения означает, что оспаривающий представил индекс, который позже был доказан как неверный из-за неспособности предлагателя ответить на вызов. Возможно, что существует несколько неправильных индексов, но только те, которые привели к отклонению предложения, разделяют вознаграждение. Все остальные оспаривающие получают обратно только свой залог.
- Если оспаривающий оспаривает ноду, предлагатель отвечает, и предложение не отклоняется. Предлагатель может получить залоги вызова из недействительных вызовов.
- Если предложение отклонено, предлагатель теряет свой залог, который делится пропорционально между оспаривающими, которые способствовали отклонению предложения.

Используйте эту команду для получения залогов:

```shell
rocketpool pdao claim-bonds
```

Это отобразит каждое предложение, из которого вы имеете право получить залоги. Вы можете либо получить залоги из указанного предложения, либо вы можете получить залоги и вознаграждения из всех подходящих предложений.

```
Please select a proposal to unlock bonds / claim rewards from:
1: All available proposals
2: Proposal 42 (proposer: true, unlockable: 21.00 RPL, rewards: 0.00 RPL)
3: Proposal 43 (proposer: true, unlockable: 21.00 RPL, rewards: 0.00 RPL)
4: Proposal 44 (proposer: true, unlockable: 21.00 RPL, rewards: 0.00 RPL)
5: Proposal 46 (proposer: true, unlockable: 21.00 RPL, rewards: 0.00 RPL)
6: Proposal 47 (proposer: true, unlockable: 21.00 RPL, rewards: 0.00 RPL)
7: Proposal 48 (proposer: true, unlockable: 21.00 RPL, rewards: 0.00 RPL)
8: Proposal 49 (proposer: true, unlockable: 21.00 RPL, rewards: 0.00 RPL)
```

Как только вы выбрали вариант, вам будут представлены текущие рекомендации по стоимости газа в сети; подтвердите выбор цены на газ и следуйте остальным подсказкам.

```
+============== Suggested Gas Prices ==============+
| Avg Wait Time |  Max Fee  |    Total Gas Cost    |
| 15 Seconds    | 26 gwei   | 0.1591 to 0.2387 ETH |
| 1 Minute      | 21 gwei   | 0.1261 to 0.1891 ETH |
| 3 Minutes     | 21 gwei   | 0.1261 to 0.1891 ETH |
| >10 Minutes   | 21 gwei   | 0.1261 to 0.1891 ETH |
+==================================================+

These prices include a maximum priority fee of 2.00 gwei.
Please enter your max fee (including the priority fee) or leave blank for the default of 21 gwei:


Using a max fee of 21.00 gwei and a priority fee of 2.00 gwei.
Are you sure you want to claim bonds and rewards from 7 proposals? [y/n]
```

Обратите внимание, что если вы выберете первый вариант для получения всех доступных предложений, они будут выполняться индивидуально, а не как одна транзакция.

## Создание повторяющегося расхода казначейства

Вам нужно подготовить несколько вводов для создания повторяющегося расхода казначейства:

- Имя контракта
- Адрес получателя
- Количество RPL для отправки за период
- Время начала для повторяющегося платежа (как временная метка UNIX)
- Длительность каждого периода оплаты в часах / минутах / секундах (например, 168h0m0s)
- Количество периодов оплаты

::: tip ИНФО
Получателю нужно будет запомнить имя контракта, чтобы получить платежи. Не беспокойтесь, так как эта информация хранится и может быть получена с помощью команды `rocketpool pdao proposals details <proposal-id>`
:::

Чтобы выдвинуть предложение о настройке повторяющегося расхода казначейства, используйте следующую команду smartnode и следуйте подсказкам:

```shell
rocketpool pdao propose recurring-spend
```

Вот как это выглядит все вместе:

```
Please enter a contract name for this recurring payment:
test-recurring-spend

Please enter a recipient address for this recurring payment:
0x681B8BBf08708e64694005c7Dc307b381b4D1A7D

Please enter an amount of RPL to send to 0x681B8BBf08708e64694005c7Dc307b381b4D1A7D per period:
1

Your value will be multiplied by 10^18 to be used in the contracts, which results in:

[1000000000000000000]

Please make sure this is what you want and does not have any floating-point errors.

Is this result correct? [y/n]
y

Please enter the time that the recurring payment will start (as a UNIX timestamp):
1717935233

The provided timestamp corresponds to 2024-06-09 12:13:53 +0000 UTC - is this correct? [y/n]
y

Please enter the length of each payment period in hours / minutes / seconds (e.g., 168h0m0s):
720h

Please enter the total number of payment periods:
24
```

Как только вы введёте все необходимые вводы, будет выдвинуто предложение о создании повторяющегося платежа. Когда pDAO примет и выполнит это предложение, получатель получит `1 RPL`, начиная с `2024-06-09 12:13:53 +0000 UTC` каждые `720 часов` в течение `24 платежей`.

## Получение повторяющегося расхода казначейства

Получение повторяющихся платежей должно быть довольно простым! Перейдите к нашему инструменту интерфейса [здесь](https://node.rocketpool.net/claim-recurring-payments), чтобы сделать это. Если вы пробуете это в тестовой сети Hoodi, используйте [эту](https://testnet.node.rocketpool.net/stake-rpl-on-behalf-of-node) ссылку вместо этого.

Как только вы на сайте, нажмите кнопку **подключить кошелёк**. Пожалуйста, прочтите и примите Условия обслуживания и Политику конфиденциальности, это позволит различные способы подключения, затем нажмите подключить **metamask**.

MetaMask предложит вам выбрать аккаунт для подключения к веб-сайту. После того, как вы войдёте, вам нужно будет ввести **имя контракта**. Это отобразит все соответствующие детали. Убедитесь, что вы дважды проверили адрес получателя. Любой может вызвать функцию получения, но каждый контракт оплаты будет иметь назначенного получателя для распределения RPL.

<img src="./images/claim_recurring1.png" width="100%" height="auto" />

Вы можете получить свои платежи в любое время, вы просто получите общий невостребованный RPL до самого последнего периода.
Альтернативно, вы можете дождаться, пока пройдут все периоды, чтобы собрать всё сразу и сэкономить на газе.

Просто нажмите большую оранжевую кнопку получения, когда будете готовы, и просмотрите транзакцию в metamask (или в вашем предпочитаемом кошельке). Как только это будет сделано, всё готово!
