import { Tab, Tabs } from "@rspress/core/theme";

# Стейкинг через децентрализованную биржу на уровне 2

Напоминаем, что вам не нужно обменивать ETH на rETH напрямую через Rocket Pool, чтобы пользоваться преимуществами децентрализованного стейкинга.
Все, что вам нужно сделать, это держать rETH, так как он по своей природе растет в цене - не имеет значения, как вы его получили!

При этом одна из основных проблем (особенно в последнее время) - это стоимость газа, связанная со стейкингом или обменом ETH на rETH.

Чтобы помочь снизить это, сеть Ethereum начала внедрять использование [роллапов](https://www.youtube.com/watch?v=7pWxCklcNsU) - также известных как **уровень 2**.

Уровень 2 включает в себя несколько отдельных сетей, которые существуют под Ethereum, выполняя множество транзакций, как обычно делал бы Ethereum, но сворачивая все их в одну единую "мега" транзакцию и публикуя _ее_ в основной цепи Ethereum вместо этого.
В идеале это означает, что вы получите все преимущества безопасности, связанные с децентрализованной природой Ethereum, но будете наслаждаться **гораздо более низкими комиссиями за газ** для ваших транзакций, поскольку затраты на выполнение и хранение на уровне 2 могут быть намного ниже, и только часть ваших транзакций должна храниться на уровне 1, где состояние намного дороже.

Rocket Pool в настоящее время поддерживает две сети уровня 2: [Optimism](https://www.optimism.io/) и [Arbitrum](https://arbitrum.io/).
У обеих из них есть работающие версии [Uniswap](https://docs.uniswap.org/protocol/introduction), наиболее широко используемого протокола децентрализованного обмена.
С Uniswap вы можете быстро и легко обменять ETH на rETH.

Преимущество использования этого подхода заключается в том, что **комиссии за газ будут значительно ниже**, чем при других методах.
Если это важно для вас, потому что вы хотите застейкать небольшое количество ETH, то использование сети уровня 2, вероятно, будет вашим выбором.

Недостаток заключается в том, что вы можете не получить лучшую сделку на rETH.
Uniswap требует небольшую комиссию, которая передается его поставщикам ликвидности, а крупные транзакции потребуют больших пулов ликвидности для получения хороших сделок без слишком большого влияния на цену.
Сети уровня 2 обычно имеют более низкую ликвидность rETH, чем основная сеть Ethereum.

Поэтому мы рекомендуем вам сравнить общее количество rETH, которое вы получите в сети уровня 2, с тем, что вы получите с помощью других методов, чтобы определить, имеет ли смысл для вас идти по этому пути.

Вы можете просмотреть текущие балансы ETH и rETH в [пуле Optimism](https://info.uniswap.org/#/optimism/pools/0xaefc1edaede6adadcdf3bb344577d45a80b19582) и [пуле Arbitrum](https://info.uniswap.org/#/arbitrum/pools/0xaac7de2b91293ba1791503d9127d2bdf2159db65), чтобы определить, достаточно ли у них rETH для покрытия вашего обмена.

В следующем примере мы продемонстрируем, как взаимодействовать с сетями уровня 2 и использовать Uniswap для обмена ETH на rETH.

::: warning ПРИМЕЧАНИЕ
В настоящее время этот метод доступен только на Mainnet.
Если вы хотите попрактиковаться на тестовой сети Hoodi, вы должны [обменять напрямую с Rocket Pool](./via-rp).

**В остальной части этого руководства предполагается, что вы находитесь на Mainnet.**
:::

Этот процесс можно выполнить с помощью любого кошелька, совместимого с web3.
В демонстрационных целях мы будем использовать [MetaMask](https://metamask.io/), так как это один из наиболее популярных вариантов кошелька.

**Вы сможете следовать аналогичным шагам с другим кошельком, если выберете - просто найдите сопоставимую функцию в вашем кошельке для каждого шага.**

## Настройка MetaMask на Mainnet

Начните с установки [MetaMask](https://metamask.io/), если вы еще этого не сделали.
Следуйте инструкциям на их сайте, чтобы установить расширение, создать учетную запись и войти.

Затем откройте панель MetaMask, используя его значок на панели инструментов вашего браузера.
Нажмите на **выпадающий список сети** на панели инструментов вверху и убедитесь, что выбран **Ethereum Mainnet**:

<img src="./images/mm_network_main.png" width="100%" height="auto" />

Адрес непосредственно под этим - ваш **адрес кошелька Ethereum**.

Прежде чем идти дальше, вам нужно будет пополнить этот кошелек ETH.
Если у вас еще нет ETH в учетной записи от предыдущего использования, вы можете сделать это, переведя ETH с существующей учетной записи на этот адрес кошелька.

## Перевод ETH с уровня 1 на уровень 2 через Hop

Существует несколько способов перевести ETH из Ethereum Mainnet в сеть уровня 2.
В этой демонстрации мы будем использовать протокол [Hop](https://docs.hop.exchange/faq) - простой и надежный способ переместить ETH (и несколько других монет) с уровня 1 на несколько сетей уровня 2 или между сетями уровня 2.

Перейдите на сайт биржи Hop здесь:

[https://app.hop.exchange/send?token=ETH](https://app.hop.exchange/send?token=ETH)

Домашний экран должен выглядеть так:

<img src="./images/hop.png" width="100%" height="auto" />

Начните с нажатия кнопки **Connect a Wallet** в правом верхнем углу.
Вам будет предложен экран с вопросом, какого провайдера кошелька вы хотите использовать.
Для этого примера выберите **MetaMask**.

::: tip ПРИМЕЧАНИЕ
Если вы не используете MetaMask, один из других провайдеров, таких как WalletConnect, скорее всего, будет совместим с вашим кошельком.
:::

Нажав эту кнопку, MetaMask откроет подсказку с просьбой выбрать, какие учетные записи вы хотите использовать.
Предполагая, что у вас есть только одна, ваша учетная запись уже должна быть выбрана.
Нажмите **Next**.

Затем он спросит, хотите ли вы предоставить Hop доступ для просмотра адресов ваших учетных записей:

<img src="./images/hop_connect.png" width="100%" height="auto" />

Нажмите **Connect**, и после короткой паузы ваш кошелек будет подключен к Hop.
Теперь вы должны увидеть его баланс ETH в правом верхнем углу экрана.

Теперь вы можете использовать два выпадающих списка в полях **From** и **To (estimated)**, чтобы выбрать свои сети, и ввести количество ETH, которое вы хотите отправить, в поле **From**.

Например, вот как это будет выглядеть для отправки 0.1 ETH с уровня 1 на Arbitrum:

<img src="./images/hop_send.png" width="100%" height="auto" />

::: warning ПРИМЕЧАНИЕ
Напоминаем, что Uniswap (и, следовательно, стейкинг Rocket Pool) в настоящее время **поддерживается только на Optimism и Arbitrum**.
Вы должны выбрать одну из этих сетей.
:::

Когда будете готовы, нажмите кнопку **Send**.
Metamask откроет диалоговое окно подтверждения, которое покажет вам комиссию за газ, связанную с транзакцией:

<img src="./images/hop_confirm.png" width="100%" height="auto" />

Если вас устраивают эти комиссии за газ, нажмите **Confirm**, чтобы начать транзакцию.
Через несколько мгновений MetaMask откроет сообщение об успешном подтверждении транзакции, и ваш ETH теперь будет доступен в выбранной вами сети уровня 2!

## Подключение к Uniswap на уровне 2

Теперь, когда ваш кошелек настроен и пополнен, перейдите по этому URL, который откроет Uniswap и автоматически покажет обмен ETH на rETH:

[https://app.uniswap.org/#/swap?inputCurrency=eth](https://app.uniswap.org/#/swap?inputCurrency=eth)

Изначально страница будет выглядеть так:

<img src="./images/uni_connect.png" width="100%" height="auto" />

Нажмите на одну из кнопок `Connect Wallet`, например, выделенную в правом верхнем углу.
Вам будет предложен экран с вопросом, какого провайдера кошелька вы хотите использовать.
Для этого примера выберите **MetaMask**.

::: tip ПРИМЕЧАНИЕ
Если вы не используете MetaMask, один из других провайдеров, таких как WalletConnect, скорее всего, будет совместим с вашим кошельком.
:::

Нажав эту кнопку, MetaMask откроет еще одну подсказку с просьбой выбрать, какие учетные записи вы хотите использовать, точно так же, как это было с Hop.
Оставьте свою учетную запись выбранной, нажмите **Next**, а затем нажмите **Connect**, как вы делали с Hop ранее.
После короткой паузы ваш кошелек будет подключен к Uniswap.
Теперь вы должны увидеть его баланс ETH в правом верхнем углу экрана.

Первое, что нужно сделать, это изменить вашу сеть с основной сети Ethereum на уровень 2, на который вы только что обменяли.
Нажмите на выпадающий список сети в правом верхнем углу экрана (здесь выделен красным):

<img src="./images/uni_network.png" width="100%" height="auto" />

Как только вы это сделаете, MetaMask предложит вам подтвердить, что вы хотите добавить пользовательскую сеть:

<img src="./images/uni_net_confirm.png" width="100%" height="auto" />

Нажмите **Approve**, а затем нажмите **Switch Network**.
Это изменит MetaMask на использование новой сети уровня 2 вместо основной сети Ethereum для транзакций.

::: warning ПРИМЕЧАНИЕ
Перед тем как совершать какие-либо транзакции с MetaMask, _всегда_ проверяйте, какую сеть он в данный момент использует, открывая MetaMask и просматривая выпадающий список сети вверху!
Легко случайно переключиться на другую сеть и забыть об этом!
:::

## Добавление rETH в MetaMask

Следующий шаг - добавить токен rETH в MetaMask, чтобы вы могли видеть свой баланс и получить к нему доступ для торговли.
Нажмите вкладку **Assets**, затем нажмите **Add Token**:

<img src="./images/mm_add_token.png" width="100%" height="auto" />

Убедитесь, что в этом диалоговом окне выбран **Custom Token**, и выберите соответствующую вкладку для выбранной вами сети уровня 2 ниже:

<div className="p-3">
  <Tabs>
    <Tab label="Optimism">
      В поле **Token Contract Address** введите следующее значение:

      ```shell
      0x9bcef72be871e61ed4fbbc7630889bee758eb81d
      ```

      **Token Symbol** должен автоматически заполниться значением `rETH`, а **Decimals of Precision** должен автоматически заполниться значением `18`.

      Примите остальные подсказки, и тогда вы увидите токен rETH в вашем списке.
    </Tab>
    <Tab label="Arbitrum">
      В поле **Token Contract Address** введите следующее значение:

      ```shell
      0xec70dcb4a1efa46b8f2d97c310c9c4790ba5ffa8
      ```

      **Token Symbol** должен автоматически заполниться значением `rETH`, а **Decimals of Precision** должен автоматически заполниться значением `18`.

      Примите остальные подсказки, и тогда вы увидите токен rETH в вашем списке.
    </Tab>

  </Tabs>
</div>

## Обмен ETH на rETH с помощью Uniswap

Финальный шаг процесса - совершить обмен!

Нажмите на выпадающий список **Select a token** и введите адрес rETH, который вы только что добавили в MetaMask (вы также можете просто ввести rETH, но **убедитесь, что это правильный токен, а не токен-самозванец или мошеннический токен**, предварительно проверив его адрес).

::: warning ПРИМЕЧАНИЕ
Изначально вам может быть показано предупреждение, которое выглядит так:

<img src="./images/unknown_token.jpg" width="100%" height="auto" />

Это всего лишь временное предупреждение, пока Uniswap не добавит rETH в свой канонический список токенов на используемом вами уровне.
Пока адрес токена `0x9bcef72be871e61ed4fbbc7630889bee758eb81d` на Optimism или `0xec70dcb4a1efa46b8f2d97c310c9c4790ba5ffa8` на Arbitrum, вы можете безопасно добавить его.
:::

Затем введите количество ETH, которое вы хотите обменять, и пользовательский интерфейс Uniswap покажет вам количество rETH, которое вы получите взамен:

<img src="./images/arb_swap.png" width="100%" height="auto" />

::: warning ПРИМЕЧАНИЕ
Обратите внимание, что количество rETH, которое вы получите, будет **меньше**, чем количество ETH, которое вы вложили.
Это нормально, потому что **rETH стоит больше, чем ETH** и постоянно растет в цене.
Вы можете увидеть это в обменном курсе, выделенном внизу скриншота.
:::

Теперь нажмите **Swap**, чтобы увидеть детали сделки, включая минимальную сумму, которую вы можете получить из-за проскальзывания.
Если вас все устраивает, нажмите **Confirm Swap**.
Это отправит запрос в MetaMask, где вы сможете проверить общую стоимость транзакции перед ее подтверждением:

<img src="./images/arb_gas.png" width="100%" height="auto" />

::: tip ПРИМЕЧАНИЕ
Обратите **пристальное внимание** на предполагаемую комиссию за газ здесь.
Вы, вероятно, заметите, что с точки зрения комиссий за газ **примерно в 10 раз дешевле** совершить этот обмен в сети уровня 2, чем в основной сети Ethereum!
:::

Если вы довольны комиссиями за газ относительно общей суммы rETH, которую вы получите, нажмите **Confirm**, чтобы отправить транзакцию.
Через короткое время вы должны увидеть уведомление от MetaMask о том, что операция успешно завершена, и теперь вы увидите токен rETH в своем кошельке.

Вот и все! Теперь вы стейкаете с Rocket Pool. Все, что вам нужно сделать, это держать ваш rETH, и вы будете автоматически получать вознаграждения за стейкинг по мере роста стоимости токена rETH.
