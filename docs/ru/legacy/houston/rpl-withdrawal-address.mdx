import { Tab, Tabs } from "@rspress/core/theme";
import nodeAddress from "./images/node_address.png";
import rplWithdrawalConfirmation from "./images/rpl_withdrawal_confirmation.png";

# Установка адреса вывода RPL

Важно понимать разницу между вашим [основным адресом вывода](../../node-staking/prepare-node#setting-your-primary-withdrawal-address) и адресом вывода RPL. По умолчанию ваш адрес вывода RPL не установлен, и ваш основной адрес вывода — это место, куда будут отправлены все ваши вознаграждения контрольной точки RPL, ваш стейкнутый RPL и ETH Beacon Chain.

Вы можете установить [отдельный адрес вывода для вашего RPL](https://rpips.rocketpool.net/RPIPs/RPIP-31), если хотите. Ваш адрес вывода RPL, если установлен, сможет инициировать и получать RPL из вознаграждений инфляции и не будет влиять на вознаграждения консенсуса ETH или что-либо, связанное с ETH. В этом случае ваш основной адрес вывода больше не будет иметь какого-либо авторитета над действиями, связанными с RPL.

Это создаёт некоторые интересные возможности, когда RPL может быть предоставлен сущностью оператору узла, который не желает иметь подверженность RPL. Эта сущность затем может получать вознаграждения RPL за предоставление необходимого страхового обеспечения для узла. Другими словами, это позволяет различным участникам предоставлять каждый тип обеспечения.

::: warning ПРИМЕЧАНИЕ
При первой настройке вашего узла адрес вывода RPL по умолчанию не установлен.
Если вы решите установить адрес вывода RPL, **критически важно установить это на другой адрес, контролируемый холодным кошельком.**
Холодным кошельком может быть аппаратный кошелёк (такой как [Ledger](https://www.ledger.com/), [Trezor](https://trezor.io/) или [Grid+](https://gridplus.io/)), или кошелёк смарт-контракта (такой как [Safe](https://app.safe.global/welcome)).

Мы **настоятельно рекомендуем** НЕ использовать горячий кошелёк, такой как MetaMask, в качестве адреса вывода RPL.

Таким образом, если кошелёк вашего узла скомпрометирован, злоумышленник не получит доступ к вашему стейкнутому RPL, заставив вас выйти, потому что все эти средства будут отправлены на ваш отдельный холодный кошелёк (к которому у них, надеюсь, нет доступа).

Адреса вывода RPL устанавливаются на уровне оператора узла.
Если вы создадите несколько минипулов, все они будут ссылаться на один и тот же адрес вывода RPL, поэтому вам нужно выполнить эту настройку только один раз.

[См. здесь](https://ethereum.org/en/security/#wallet-security) основы безопасности кошелька от Ethereum Foundation.
:::

Есть два разных способа сделать это.
Пожалуйста, прочитайте оба варианта ниже, чтобы определить, какой из них применим к вам.

<div className="p-3">
  <Tabs>
    <Tab label="Метод 1">
      *Используйте этот метод, если ваш новый адрес вывода RPL может быть использован для подписания транзакций через MetaMask или WalletConnect.**

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">ПРИМЕЧАНИЕ</p>
        Этот метод потребует от вас **отправить транзакцию** с вашего нового адреса вывода RPL, поэтому **у вас должна быть небольшая сумма ETH на этом адресе уже.**
      </p>

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">ПРИМЕЧАНИЕ</p>
        Для пользователей аппаратных кошельков **Ledger** обратите внимание, что Ledger Live пока не поддерживает MetaMask или WalletConnect нативно.
        Вам нужно будет использовать MetaMask и подключить его к вашему Ledger вместо этого.
        Следуйте [официальным инструкциям Ledger](https://www.ledger.com/academy/security/the-safest-way-to-use-metamask), чтобы сделать это.

        Для работы с веб-сайтом Rocket Pool вам нужно будет иметь ваш Ledger подключённым, разблокированным и открытым приложением ETH.
        Вам также нужно будет **включить "blind signing"** для текущей сессии; вы можете найти это в разделе Настройки приложения ETH на устройстве.
        Bind signing будет автоматически отключён после закрытия сессии.

        Если вы используете Hoodi Testnet и хотите использовать ваш Ledger в качестве адреса вывода RPL, **вы должны создать новый кошелёк Ethereum на вашем Ledger** сначала, чтобы убедиться, что вы не подключаете ваш реальный адрес к тестовой сети, что обычно вызывает путаницу.
        Убедитесь, что вы выбрали **Hoodi Testnet** в выпадающем списке выбора сети при подключении вашего Ledger к MetaMask.
        Обратите внимание, что Ledger Live не будет показывать ваш баланс в тестовой сети, но другие приложения, которые поддерживают тестовую сеть (такие как MetaMask и Etherscan), смогут его отобразить.
      </p>

      1. Запустите `rocketpool node set-rpl-withdrawal-address 'your cold wallet address or ENS name'`. Ваш новый адрес вывода RPL будет помечен как "ожидающий". До тех пор, пока вы не подтвердите его, **ваш старый адрес вывода RPL всё ещё будет использоваться**.
      2. Чтобы подтвердить его, вы должны отправить специальную транзакцию **с вашего нового адреса вывода RPL** в контракт минипула, чтобы подтвердить, что вы владеете адресом вывода RPL.
      1. Самый простой способ сделать это — перейти на сайт адреса вывода RPL Rocket Pool (для [Hoodi Testnet](https://testnet.node.rocketpool.net/rpl-withdrawal-address) или для [Mainnet](https://node.rocketpool.net/rpl-withdrawal-address)).
      3. Если вы ещё не подключили Metamask или WalletConnect к веб-сайту Rocket Pool, сделайте это сейчас. Нажмите кнопку **select wallet** в центре экрана и выберите MetaMask или WalletConnect в зависимости от того, какой кошелёк вы хотите использовать. Затем вам будет предложено подтвердить подключение. Например, используя MetaMask:

      Нажмите **Next**, затем нажмите **Confirm**, чтобы разрешить веб-сайту Rocket Pool использовать ваш кошелёк. 3. Выберите **RPL Withdrawal Address** из верхнего меню (или меню гамбургер слева, если вы на мобильном устройстве). 4. Вы увидите это приглашение:

      4. Введите здесь **адрес кошелька вашего узла** и нажмите оранжевую кнопку **Find**, чтобы продолжить.

      <img src={nodeAddress} width="100%" height="auto"/>

      1.  Вам будет предложено подтвердить ожидающий адрес вывода RPL. Это должен быть тот же адрес, который вы использовали при выполнении этой команды ранее: `rocketpool node set-rpl-withdrawal-address` Выберите **Confirm Pending**, когда будете готовы.
      2.  Теперь в вашем кошельке должно появиться новое диалоговое окно подтверждения. Опять же, используя MetaMask в качестве примера, нажмите на иконку MetaMask, чтобы открыть его, и вы должны увидеть что-то вроде этого:

      Нажмите **Confirm**, чтобы отправить транзакцию в сеть. Это займёт некоторое время, пока она не будет включена в блок, но как только это произойдёт, вы увидите диалог подтверждения:

      <img src={rplWithdrawalConfirmation} width="100%" height="auto"/>

      5. Ваш новый адрес вывода RPL теперь будет подтверждён и активирован. Вы можете просмотреть это с помощью `rocketpool node status`.
    </Tab>
    <Tab label="Метод 2">
      **Используйте этот метод только в том случае, если ваш адрес вывода RPL _не может_ быть использован для подписания транзакций через MetaMask или WalletConnect.**

      В этом методе вы запустите:

      ```shell
      rocketpool node set-rpl-withdrawal-address --force `your cold wallet address`
      ```

      Вам будет предоставлена возможность отправить тестовую транзакцию перед подтверждением этого, чтобы убедиться, что у вас правильный адрес.
      Если вы подтвердите эту команду, когда она попросит вас, ваш новый адрес вывода RPL будет установлен немедленно.


      <p className="rspress-directive danger">
        Делая это, вы обходите меру безопасности, связанную с методом 1, которая требует от вас доказать, что вы владеете новым адресом.
        Если вы сделаете опечатку здесь, нет способа отменить это, и **вознаграждения вашего минипула будут потеряны навсегда**.

        Мы **настоятельно** рекомендуем вам использовать механизм тестовой транзакции перед подтверждением этого, и если возможно, используйте метод 1 вместо этого.
      </p>
    </Tab>

  </Tabs>
</div>

Как только это будет сделано, вы **больше не сможете изменить адрес вывода RPL, используя команду `set-rpl-withdrawal-address`**.
Чтобы изменить его, вам нужно будет отправить подписанную транзакцию с вашего **активного** адреса вывода RPL (того, на который вы только что переключились).
Веб-сайт Rocket Pool имеет функцию, чтобы помочь вам сделать это.

Если вы хотите сбросить адрес вывода RPL, процесс довольно прост. Первое, что вам нужно сделать, — это вернуться на страницу адреса вывода RPL на веб-сайте Rocket Pool.

<div className="p-3">
  <Tabs>
    <Tab label="Hoodi Testnet">https://testnet.node.rocketpool.net/rpl-withdrawal-address</Tab>
    <Tab label="Mainnet">https://node.rocketpool.net/rpl-withdrawal-address</Tab>
  </Tabs>
</div>

Если вы вошли с адресом вывода RPL узла, вы должны иметь возможность нажать кнопку **unset** справа здесь:

<img src="./images/unset_rpl_withdrawal.png" width="100%" height="auto" />

Нажатие **unset** приведёт вас на страницу, где вы можете подтвердить детали. Если вы довольны тем, что видите, нажмите оранжевую кнопку **unset**, чтобы отправить транзакцию в сеть.

Вот и всё, что нужно для установки адреса вывода RPL! Мы надеемся, что вы нашли процесс быстрым и лёгким.

Не стесняйтесь заглянуть на [наш Discord-сервер](https://discord.gg/G46XgK264a), чтобы сообщить нам, что вы об этом думаете, и следить за развитием проекта.
