import nimbus_dashboard from "./images/nimbus-dashboard.png";
import tui_checkbox_checked from "./images/tui-checkbox-checked.png";
import tui_checkbox_unchecked from "./images/tui-checkbox-unchecked.png";
import tui_dropdown_closed from "./images/tui-dropdown-closed.png";
import tui_dropdown_open from "./images/tui-dropdown-open.png";
import tui_native_cc_url from "./images/tui-native-cc-url.png";
import tui_native_cc from "./images/tui-native-cc.png";
import tui_native_ec from "./images/tui-native-ec.png";
import tui_native_finished from "./images/tui-native-finished.png";
import tui_native_metrics from "./images/tui-native-metrics.png";
import tui_native_mev from "./images/tui-native-mev.png";
import tui_native_network from "./images/tui-native-network.png";
import tui_native_welcome from "./images/tui-native-welcome.png";
import tui_native_other from "./images/tui-native-other.png";
import tui_native_review from "./images/tui-native-review.png";
import tui_native_settings_home from "./images/tui-native-settings-home.png";
import tui_native_smartnode from "./images/tui-native-smartnode.png";
import tui_textbox from "./images/tui-textbox.png";

# Configurazione dello Smart Node Stack (Modalità Nativa)

In questa sezione, esamineremo i vari metodi per configurare lo Smart Node se stai utilizzando la **configurazione nativa** che non utilizza affatto Docker.

::: warning NOTA
Se stai utilizzando una configurazione basata su Docker, visita invece la [guida alla configurazione Docker](./config-docker).
:::

Ci sono tre modi per configurarlo:

- Tramite l'[interfaccia del wizard](#configurazione-tramite-il-wizard) - questo è il modo più semplice. Ti pone solo alcune domande di base e utilizza impostazioni predefinite ben testate per il resto. Questo è ciò che ti verrà presentato quando esegui `rocketpool service config` per la prima volta.
- Tramite l'[interfaccia del gestore delle impostazioni](#configurazione-tramite-il-gestore-delle-impostazioni) - questo ti dà accesso a tutte le impostazioni dello Smart Node in modo da poter personalizzare tutto quanto desideri.
- In modo headless tramite la [riga di comando](#configurazione-tramite-la-riga-di-comando) - questa è un'opzione per le persone che eseguono lo Smart Node in un ambiente headless (non interattivo) e hanno bisogno di configurarlo automaticamente.

Scegli quale modalità desideri approfondire dall'elenco qui sopra, oppure scorri semplicemente ciascuna opzione qui sotto.

## Configurazione tramite il Wizard

Per configurare lo Smart Node, esegui il comando di configurazione:

```shell
rp service config
```

Questo avvierà un'interfaccia utente basata su terminale che ti permetterà di configurare rapidamente e facilmente il tuo nodo, oltre a fornire un controllo opzionale granulare sulle impostazioni rilevanti per la modalità nativa.

::: tip NOTA
Se hai già configurato lo Smart Node, verrai invece accolto dal [gestore delle impostazioni](#configurazione-tramite-il-gestore-delle-impostazioni).
Puoi scegliere di riaprire il wizard da lì se lo preferisci, e tutte le tue impostazioni esistenti saranno preselezionate per te.
:::

Quando esegui l'interfaccia di configurazione per la prima volta (o se scegli di eseguire nuovamente il wizard in seguito), ti verrà presentata una schermata simile a questa:

<img src={tui_native_welcome} width="100%" height="auto" />

::: tip SUGGERIMENTO
Per utilizzare il wizard, **premi i `tasti freccia` (su/giù/sinistra/destra) per navigare tra elementi come pulsanti (scelte) o caselle di testo**.
Puoi anche usare `Tab` e `Shift+Tab` se preferisci - farà la stessa cosa.

Per i pulsanti, **quello attualmente selezionato sarà evidenziato in verde**.
Quelli in nero non sono selezionati.
Nello screenshot sopra, `Next` è attualmente selezionato e `Quit` non lo è.

**Premi `Invio` o `Spazio` per selezionare un pulsante**, analogo al clic del mouse.

**Premi `Escape` per tornare alla finestra precedente** se hai cambiato idea su qualcosa.
Questo tornerà utile man mano che procedi attraverso le varie pagine del wizard.

**Tieni premuto `Ctrl` e premi `C` in qualsiasi momento per uscire dal wizard senza salvare nulla**.

Ad esempio, nella schermata sopra, potresti premere i tasti freccia `sinistra` e `destra` per spostarti tra i pulsanti `Next` e `Quit`.

Premere `Invio` mentre `Next` è selezionato procederà alla schermata successiva.
Premere `Invio` mentre `Quit` è selezionato uscirà dal wizard senza salvare.
:::

Quando sei pronto per iniziare, premi `Next`.

### Scelta di una rete

Nella schermata successiva, ti verrà chiesto di scegliere quale rete vuoi utilizzare:

<img src={tui_native_network} width="100%" height="auto" />

Puoi evidenziare le diverse scelte con i tasti freccia `Su` e `Giù` (o `Tab` e `Shift+Tab`).
Quando cambi scelta, la casella **Descrizione** a destra ti mostrerà una breve descrizione di ciascuna opzione.
Questo è vero per tutte le pagine basate su scelte nel wizard, non solo per la selezione della rete, quindi vedrai questo stile di pagina frequentemente.

Se vuoi esercitarti nell'esecuzione di un nodo Rocket Pool sulla rete di test Hoodi con ETH e RPL falsi che puoi ottenere gratuitamente, seleziona **Hoodi Testnet**.

Se sei pronto per creare un vero nodo Rocket Pool sulla Mainnet per guadagnare ricompense reali, seleziona **Mainnet**.

### Configurazione del client di esecuzione

La schermata successiva ti chiederà l'URL dell'API RPC basata su HTTP del tuo client di esecuzione:

<img src={tui_native_ec} width="100%" height="auto" />

Inserisci qui `http://127.0.0.1:8545` se prevedi di eseguire un client di esecuzione sulla stessa macchina dello Smart Node (nel resto di questa guida, assumeremo che questo è ciò che prevedi di fare).
Tuttavia, se hai già un client di esecuzione configurato altrove, usa invece il suo URL qui.

Nota che puoi sempre cambiarlo eseguendo di nuovo `rp service config` in seguito.

### Configurazione del client di consenso

Successivamente, ti verrà chiesto quale client di consenso stai utilizzando (o prevedi di utilizzare).
Poiché ogni client di consenso ha un comportamento leggermente diverso, lo Smart Node deve sapere quale stai utilizzando in modo da poter adattare di conseguenza il proprio comportamento.
Scegli il tuo client dall'elenco nella seguente schermata:

<img src={tui_native_cc} width="100%" height="auto" />

Successivamente, vedrai una schermata che ti chiede l'URL dell'API del tuo client:

<img src={tui_native_cc_url} width="100%" height="auto" />

Inserisci qui `http://127.0.0.1:5052` se prevedi di eseguire il Beacon Node del tuo client di consenso sulla stessa macchina dello Smart Node (nel resto di questa guida, assumeremo che questo è ciò che prevedi di fare).
Tuttavia, se hai già un Beacon Node configurato altrove, usa invece il suo URL qui.

### Altre impostazioni

La schermata successiva avrà alcune altre impostazioni varie:

<img src={tui_native_other} width="100%" height="auto" />

Lascia queste come opzioni predefinite a meno che tu non abbia deciso di utilizzare una directory diversa da `/srv/rocketpool` per la tua installazione dello Smart Node.

### Client di fallback

A partire dalla versione 1.5.0 dello stack Smart Node, puoi fornire una coppia di client di esecuzione e client di consenso di "fallback" che possono sostituire i tuoi client primari se dovessero mai andare offline (ad esempio perché usi Geth e devi eseguire il pruning).
In questa situazione, la tua macchina nodo primaria sarà ancora responsabile dell'attestazione e della proposta di blocchi con le chiavi validator dei tuoi minipool, ma si connetterà a una macchina esterna per interagire con il livello di esecuzione e le blockchain Beacon.

[Per saperne di più sui nodi di fallback, consulta questa sezione](./fallback) e torna qui quando hai finito.

### Metriche

Rocket Pool ha la capacità di integrarsi con Prometheus e Grafana per produrre comodi dashboard basati sul web che ti permettono di osservare a colpo d'occhio la salute del tuo nodo:

<img src={nimbus_dashboard} width="100%" height="auto" />

L'ultima domanda nel wizard ti chiederà se vuoi abilitare questo:

<img src={tui_native_metrics} width="100%" height="auto" />

Se scegli di abilitarlo, imparerai di più su come configurarlo e come usarlo nella sezione [Configurazione del dashboard Grafana](./grafana.mdx) più avanti nel processo.

::: warning NOTA
Tutti i dati raccolti da questo sistema **rimangono sulla tua macchina**.
Rocket Pool non raccoglie nessuna telemetria né la invia a un servizio separato.
È lì puramente per permetterti di monitorare il tuo nodo!
:::

### Configurazione MEV

Dalla fusione dei livelli di esecuzione e consenso nel settembre 2022, i validatori Ethereum ora hanno la capacità di guadagnare commissioni di priorità e partecipare al Maximal Extractable Value (o MEV in breve).

A partire da Smart Node v1.7.0, MEV è ora _opt-out_ quindi una notifica sulla sua configurazione viene presentata come parte della configurazione iniziale, come vedi nella schermata successiva:

<img src={tui_native_mev} width="100%" height="auto" />

[Leggi la nostra guida MEV per saperne di più su MEV, la sua configurazione e cosa fare in questa sezione del wizard.](./mev.mdx)
Torna qui quando hai finito.

### Completamento

Dopo questa domanda, hai finito di configurare lo Smart Node.
Vedrai la seguente finestra:

<img src={tui_native_finished} width="100%" height="auto" />

Se sei soddisfatto della tua configurazione e sei pronto ad avviare lo Smart Node, fai clic su `Save and Exit` qui.

Se non hai ancora finito di installare Rocket Pool, torna ora alla guida di configurazione nativa.
Altrimenti, il passo successivo è riavviare i tuoi servizi daemon con:

```shell
sudo systemctl restart rp-node rp-watchtower
```

Se desideri rivedere tutte le impostazioni e personalizzare molte impostazioni aggiuntive che non erano incluse nel wizard, fai clic su `Review All Settings` e vai alla [sezione successiva](#configurazione-tramite-il-gestore-delle-impostazioni).

## Configurazione tramite il gestore delle impostazioni

Se hai già eseguito `rp service config`, invece di essere accolto dal wizard, vedrai la schermata del **gestore delle impostazioni**:

<img src={tui_native_settings_home} width="100%" height="auto" />

Ci sono tre caratteristiche principali di questa schermata:

1. L'**elenco delle categorie**, che ti permette di approfondire le impostazioni per ciascuna categoria dello stack Smart Node rilevante per la modalità nativa
2. Il pulsante **Review Changes and Save**, che puoi utilizzare quando sei pronto per vedere quali impostazioni hai modificato e salvare la configurazione aggiornata
3. Il pulsante **Open the Config Wizard**, che ti porterà al [wizard di configurazione](#configurazione-tramite-il-wizard) se preferisci quell'interfaccia

::: tip SUGGERIMENTO
Per utilizzare il gestore delle impostazioni, **premi i `tasti freccia` (su/giù/sinistra/destra) per navigare tra le opzioni nella home page**.

Premi `Tab` per spostarti **tra l'elenco delle categorie (1) e i pulsanti (2 e 3)** nella parte inferiore dello schermo.
Il pulsante attualmente selezionato sarà **evidenziato in verde**.

**Premi `Invio` o `Spazio` per selezionare un pulsante**, analogo al clic del mouse.

**Tieni premuto `Ctrl` e premi `C` in qualsiasi momento per uscire dal gestore delle impostazioni senza salvare nulla**.
:::

Mentre scorri l'elenco delle categorie, ogni opzione avrà una descrizione utile che appare nella **casella di descrizione** a destra dello schermo.
Sentiti libero di esplorarle; nulla di ciò che fai verrà salvato fino a quando non passi attraverso la finestra di revisione tramite il pulsante **Review Changes and Save**, e puoi premere **Ctrl+C** in qualsiasi momento per uscire senza salvare, quindi non rovinerai accidentalmente qualcosa giocando con le impostazioni qui.

### Configurazione delle impostazioni

Dalla schermata iniziale, seleziona una qualsiasi delle categorie con il tasto `Invio` per visualizzare le impostazioni per quella categoria.
Ad esempio, ecco la schermata per la categoria **Smartnode and TX Fees**:

<img src={tui_native_smartnode} width="100%" height="auto" />

Usa i `tasti freccia` per spostarti su e giù tra le impostazioni.
Quella attualmente selezionata avrà un quadrato bianco alla fine (se è una casella di testo o una casella di controllo), o sarà evidenziata in bianco (se è un menu a discesa).

Premi `Escape` per tornare alla schermata iniziale del gestore delle impostazioni quando hai finito.

Mentre scorri le impostazioni, ognuna mostrerà una breve descrizione di cosa fa nella **casella di descrizione** a destra.
Mostrerà anche il **valore predefinito** lì nel caso tu voglia ripristinarlo alla sua impostazione standard.

In questo esempio, l'impostazione **RPL Claim Gas Threshold** è attualmente selezionata (evidenziata con una casella verde sul lato sinistro dello schermo).
È stata modificata a `40`, ma puoi vedere che ha un valore predefinito di `150` nell'angolo in alto a destra (nella parte superiore della **casella di descrizione**).

::: tip SUGGERIMENTO
Come promemoria, nulla verrà salvato su disco fino a quando non passi attraverso la finestra di revisione tramite il pulsante **Review Changes and Save**.
Sei incoraggiato a esplorare tutte le impostazioni per conoscerle.
:::

### I tipi di impostazioni e come usarli

Il gestore delle impostazioni utilizza i seguenti tipi di impostazioni ed elementi dell'interfaccia utente:

#### Caselle di testo

Le caselle di testo vengono utilizzate per inserire stringhe arbitrarie di testo o numeri.
Hanno questo aspetto:

<img src={tui_textbox} width="100%" height="auto" />

Inserisci i valori desiderati, quindi **premi `Invio` o usa i `tasti freccia` per navigare verso un'impostazione diversa per preservare le tue modifiche.**
Se non lo fai, il gestore delle impostazioni assumerà che stai ancora aggiornando quell'impostazione e non la contrassegnerà ancora come modificata.

#### Menu a discesa

I menu a discesa vengono utilizzati per selezionare un'opzione da un elenco di scelte.
Hanno questo aspetto (quando sono aperti):

<img src={tui_dropdown_open} width="100%" height="auto" />

L'elemento **verde** è quello attualmente selezionato.
Usa i `tasti freccia` per cambiare opzioni - mentre lo fai, la **casella di descrizione** a destra si aggiornerà per dirti di più sull'opzione attualmente selezionata.
Quando sei soddisfatto della tua scelta, premi `Invio` per scegliere l'opzione selezionata e il menu a discesa si chiuderà, rivelando l'opzione attualmente selezionata:

<img src={tui_dropdown_closed} width="100%" height="auto" />

#### Caselle di controllo

Le caselle di controllo vengono utilizzate per semplici domande Sì/No.
Hanno questo aspetto:

<img src={tui_checkbox_checked} width="100%" height="auto" />

Quando sono selezionate, avranno una `X` al centro come vedi sopra.
Quando sono _deselezionate_, saranno semplicemente vuote così:

<img src={tui_checkbox_unchecked} width="100%" height="auto" />

Per modificare l'impostazione, selezionala semplicemente e premi `Invio`.

### Salvataggio delle modifiche

Quando sei soddisfatto delle tue modifiche e desideri rivederle prima di salvare, premi il pulsante **Review Changes and Save** nella schermata iniziale.
Come promemoria, per raggiungerlo, premi il tasto `Tab`.

Ti verrà presentata una vista simile a questa:

<img src={tui_native_review} width="100%" height="auto" />

La **casella di revisione** qui presenterà tutte le impostazioni che hai modificato, mostrando i vecchi valori e quelli nuovi.
Ad esempio, la prima riga qui mostra che il **RPL Claim Gas Threshold** era `150`, ed è stato modificato a `40`.

::: tip NOTA
A questo punto, le tue modifiche **non sono ancora state salvate**.
Se vuoi tornare indietro e modificare qualcosa, premi `Escape` per tornare alla schermata iniziale.
:::

Quando sei soddisfatto delle modifiche, premi `Invio` per salvare la nuova configurazione su disco.
Uscirai quindi dall'interfaccia del terminale e ti verrà presentato questo messaggio:

```
Your changes have been saved!
Please restart your daemon service for them to take effect.
```

Se non hai ancora finito di installare Rocket Pool, torna ora alla guida di configurazione nativa.
Altrimenti, ora puoi riavviare i tuoi servizi daemon con:

```shell
sudo systemctl restart rp-node rp-watchtower
```

## Configurazione tramite la riga di comando

Se utilizzi lo Smart Node in un ambiente headless in cui non puoi interagire con l'interfaccia del terminale, puoi configurare il tuo nodo tramite la riga di comando invece.

Il comando `rocketpool service config` accetta, come argomenti, ogni impostazione che può normalmente essere configurata tramite l'interfaccia del terminale.
Esegui il seguente comando per vederne un elenco (nota che è piuttosto lungo):

```
rocketpool service config --help
```

L'output sarà simile a questo:

```
NAME:
   rocketpool service config - Configure the Rocket Pool service

USAGE:
   rocketpool service config

OPTIONS:
   --executionClientMode value  Choose which mode to use for your Execution client - locally managed (Docker Mode), or externally managed (Hybrid Mode).
                                Type: choice
                                Options: local, external
 (default: "local")
   --executionClient value  Select which Execution client you would like to run.
                            Type: choice
                            Options: geth, infura, pocket
 (default: "geth")
   --useFallbackExecutionClient         Enable this if you would like to specify a fallback Execution client, which will temporarily be used by the Smartnode and your Consensus client if your primary Execution client ever goes offline.
                                        Type: bool

...
```

Ogni opzione avrà il suo nome, il suo tipo, il suo valore predefinito e (se è un parametro di scelta) le sue opzioni.
Utilizzando questo testo, puoi trovare l'opzione o le opzioni che desideri impostare e specificarle tramite gli argomenti appropriati.

::: tip NOTA
Questo comando si basa sulla tua configurazione esistente, quindi se hai già alcune impostazioni salvate e vuoi solo modificarne altre, non è necessario ripeterle.
Aggiornerà solo le impostazioni che includi come argomenti di questo comando.
:::

Se non hai ancora finito di installare Rocket Pool, torna ora alla guida di configurazione nativa.
Altrimenti, il passo successivo è riavviare i tuoi servizi daemon con:

```shell
sudo systemctl restart rp-node rp-watchtower
```
