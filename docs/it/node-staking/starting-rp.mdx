import { Tab, Tabs } from "@rspress/core/theme";

# Avvio di Rocket Pool

A questo punto, dovresti avere l'intera infrastruttura Rocket Pool in esecuzione, incluso lo stack Smartnode, un client Execution e un client Consensus.
Dovresti anche aver protetto il tuo sistema operativo dagli attacchi esterni.
Se hai completato entrambi questi passaggi, sei pronto per creare un nodo Rocket Pool e iniziare lo staking.
In caso contrario, rivedi le sezioni precedenti e torna qui una volta completati tali passaggi.

## Avvio e Arresto dei Servizi Rocket Pool

<div className="p-3">
  <Tabs>
    <Tab label="Modalità Docker (Predefinita)">
      Ora che hai installato lo Smartnode, avviare lo stack è semplice.
      Inserisci semplicemente il seguente comando:

      ```shell
      rocketpool service start
      ```

      Questo comando creerà tutte le immagini Docker necessarie se non esistono già, assicurerà che la rete Docker di Rocket Pool e i volumi di archiviazione siano stati inizializzati e aggiornerà eventuali container se non corrispondono più alle impostazioni di configurazione dell'interfaccia utente di `rocketpool service config`.

      La prima volta che lo esegui, l'output dovrebbe apparire così:

      ```
      $ rocketpool service start

      Creating network "rocketpool_net" with the default driver
      Creating volume "rocketpool_eth1clientdata" with default driver
      Creating volume "rocketpool_eth2clientdata" with default driver
      Creating rocketpool_eth1 ...
      Creating rocketpool_eth1 ... done
      Creating rocketpool_eth2 ...
      Creating rocketpool_api  ...
      Creating rocketpool_api  ... done
      Creating rocketpool_eth2 ... done
      Creating rocketpool_watchtower ...
      Creating rocketpool_mev-boost   ...
      Creating rocketpool_mev-boost   ... done
      Creating rocketpool_node       ...
      Creating rocketpool_validator  ...
      Creating rocketpool_validator  ... done
      Creating rocketpool_node       ... done
      Creating rocketpool_watchtower ... done
      ```

      Se è così, allora lo stack Smartnode è stato inizializzato con successo ed è ora in esecuzione.

      Se hai mai bisogno di arrestare i servizi (ad esempio, durante un aggiornamento o perché devi eseguire la manutenzione), puoi usare `rocketpool service stop` per spegnere tutto.
      L'output dovrebbe apparire così:

      ```
      $ rocketpool service stop

      Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized! [y/n]
      y

      Stopping rocketpool_node       ...
      Stopping rocketpool_validator  ...
      Stopping rocketpool_watchtower ...
      Stopping rocketpool_mev-boost  ...
      Stopping rocketpool_eth2       ...
      Stopping rocketpool_api        ...
      Stopping rocketpool_eth1       ...
      Stopping rocketpool_validator  ... done
      Stopping rocketpool_node       ... done
      Stopping rocketpool_watchtower ... done
      Stopping rocketpool_api        ... done
      Stopping rocketpool_mev-boost  ... done
      Stopping rocketpool_eth2       ... done
      Stopping rocketpool_eth1       ... done
      ```

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Una volta eseguito questo comando, Rocket Pool **non** si avvierà automaticamente dopo un riavvio del sistema.
        Dovrai chiamare `rocketpool service start` per avviare tutti i container Docker e riabilitare l'avvio automatico al riavvio.
      </p>
    </Tab>
    <Tab label="Modalità Ibrida">
      Ora che hai installato lo Smartnode, avviare lo stack è semplice.
      Inserisci semplicemente il seguente comando:

      ```shell
      rocketpool service start
      ```

      Questo comando creerà tutte le immagini Docker necessarie se non esistono già, assicurerà che la rete Docker di Rocket Pool e i volumi di archiviazione siano stati inizializzati e aggiornerà eventuali container se non corrispondono più alle impostazioni di configurazione dell'interfaccia utente di `rocketpool service config`.

      La prima volta che lo esegui, l'output dovrebbe apparire così:

      ```
      $ rocketpool service start

      Creating network "rocketpool_net" with the default driver
      Creating rocketpool_api  ...
      Creating rocketpool_api  ... done
      Creating rocketpool_watchtower ...
      Creating rocketpool_node       ...
      Creating rocketpool_validator  ...
      Creating rocketpool_validator  ... done
      Creating rocketpool_node       ... done
      Creating rocketpool_watchtower ... done
      ```

      Se è così, allora lo stack Smartnode è stato inizializzato con successo ed è ora in esecuzione.

      Nota che i tuoi client Execution e/o Consensus esterni non saranno elencati qui, poiché Rocket Pool non li gestisce e quindi non può avviarli.
      Dovrai assicurarti di averli avviati separatamente, utilizzando qualunque meccanismo li abbia originariamente creati.

      Se hai mai bisogno di arrestare i servizi (ad esempio, durante un aggiornamento o perché devi eseguire la manutenzione), puoi usare `rocketpool service stop` per spegnere tutto.
      L'output dovrebbe apparire così:

      ```
      $ rocketpool service stop

      Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized! [y/n]
      y

      Stopping rocketpool_node       ...
      Stopping rocketpool_validator  ...
      Stopping rocketpool_watchtower ...
      Stopping rocketpool_api        ...
      Stopping rocketpool_validator  ... done
      Stopping rocketpool_node       ... done
      Stopping rocketpool_watchtower ... done
      Stopping rocketpool_api        ... done
      ```

      Ancora una volta, sarai responsabile di assicurarti manualmente che i tuoi client Execution e Consensus siano arrestati in modo appropriato, se desideri che vengano arrestati.

      <p className="rspress-directive tip">
        <p className="rspress-directive-title">NOTA</p>
        Una volta eseguito questo comando, Rocket Pool non si avvierà automaticamente dopo un riavvio del sistema.
        Dovrai chiamare `rocketpool service start` per avviare tutti i container Docker e riabilitare l'avvio automatico al riavvio.
      </p>

    </Tab>
    <Tab label="Modalità Nativa">
      In modalità nativa, hai già configurato e avviato i servizi Smartnode come parte della sezione [Configurazione di un Nodo Rocket Pool Nativo senza Docker](./native).

      Supponendo che tu li abbia configurati come servizi `systemd`, puoi avviarli con `sudo systemctl start ...`.
      Ad esempio, se stai utilizzando Geth per Execution e Teku per Consensus:

      ```shell
      sudo systemctl start geth teku-bn teku-vc rp-node rp-watchtower
      ```

      Arrestarli è lo stesso processo, ma utilizzando `sudo systemctl stop ...`.

      Nota che arrestare i servizi **non disabilita l'avvio automatico**; i processi si avvieranno automaticamente al riavvio.

    </Tab>

  </Tabs>
</div>

## Conferma della Versione e della Rete Corrette

Una volta che i container o i servizi sono attivi, un buon primo passo è confermare di avere le versioni corrette dei client e di essere sulla rete che ti aspetti.
Puoi farlo con il seguente comando:

```shell
rocketpool service version
```

L'output apparirà così **(nota che potresti avere una versione più recente di quella visualizzata qui, questo è solo un esempio)**:

```
Your Smartnode is currently using the Ethereum Mainnet.

Rocket Pool client version: 1.6.4
Rocket Pool service version: 1.6.4
Selected Eth 1.0 client: Geth (Locally managed)
Image: ethereum/client-go:v1.10.25
Selected Eth 2.0 client: Lighthouse (Locally managed)
Image: sigp/lighthouse:v3.1.0
```

La prima riga ti dirà se il tuo Smartnode è configurato per la mainnet Ethereum o per la testnet Hoodi.

::: warning NOTA
**Per gli utenti Docker / Ibridi:**
Se non sei sulla rete che ti aspetti, torna alla sezione Installazione di Rocket Pool e rivedi le istruzioni di installazione - potresti aver saltato la parte che ha istruzioni diverse a seconda della rete che vuoi utilizzare.

**Per gli utenti Nativi:**
Se hai accettato le impostazioni predefinite quando hai eseguito per la prima volta `rp service config`, è possibile che la rete riportata qui sia errata.
Semplicemente cambiala nella TUI di `rp service config`, nella sezione `Smartnode`, sulla rete corretta e riavvia i tuoi servizi `node` e `watchtower`.
:::

Il secondo gruppo di righe ti dirà quali client stai utilizzando e quali versioni di essi sono definite nella configurazione di Rocket Pool.

## Controllo dello Stato del Servizio e dei Log

Ora che i servizi Smartnode sono stati avviati, è una buona idea controllare che stiano funzionando correttamente senza errori.

<div className="p-3">
  <Tabs>
    <Tab label="Modalità Docker (Predefinita)">
      La prima cosa da controllare è se i container Docker stanno funzionando bene o se si stanno riavviando costantemente a causa di un errore.
      Esegui il seguente comando:

      ```shell
      docker ps
      ```

      I risultati dovrebbero apparire così:

      ```
      CONTAINER ID   IMAGE                         COMMAND                  CREATED       STATUS      PORTS                                                                                                         NAMES
      4c1de08a352b   prom/prometheus:v2.37.0       "/bin/prometheus --w…"   9 days ago    Up 9 days   9090/tcp                                                                                                      rocketpool_prometheus
      56940decdd1f   sigp/lighthouse:v2.5.1        "sh /setup/start-bn.…"   9 days ago    Up 9 days   0.0.0.0:9001->9001/tcp, 0.0.0.0:9001->9001/udp, :::9001->9001/tcp, :::9001->9001/udp                          rocketpool_eth2
      bd061e632535   grafana/grafana:8.5.9         "/run.sh"                9 days ago    Up 9 days   3000/tcp, 0.0.0.0:3100->3100/tcp, :::3100->3100/tcp                                                           rocketpool_grafana
      5c4db92762fb   ethereum/client-go:v1.10.21   "sh /setup/start-ec.…"   9 days ago    Up 9 days   8545-8546/tcp, 0.0.0.0:30303->30303/tcp, 0.0.0.0:30303->30303/udp, :::30303->30303/tcp, :::30303->30303/udp   rocketpool_eth1
      e20c560861fc   rocketpool/smartnode:v1.5.0   "/bin/sleep infinity"    9 days ago    Up 9 days                                                                                                                 rocketpool_api
      4cf8d364fb90   rocketpool/smartnode:v1.5.0   "/go/bin/rocketpool …"   9 days ago    Up 9 days                                                                                                                 rocketpool_watchtower
      9eb944c29997   rocketpool/smartnode:v1.5.0   "/go/bin/rocketpool …"   9 days ago    Up 9 days                                                                                                                 rocketpool_node
      2ca5d3dcb471   sigp/lighthouse:v2.5.1        "sh /setup/start-vc.…"   9 days ago    Up 9 days                                                                                                                 rocketpool_validator
      dedc577fe361   prom/node-exporter:v1.3.1     "/bin/node_exporter …"   2 weeks ago   Up 9 days                                                                                                                 rocketpool_exporter
      ```

      La cosa principale da controllare è la colonna `STATUS`.
      Se nessuna delle voci indica `Restarting...`, allora i container dovrebbero funzionare correttamente (vedi la nota qui sotto per un'eccezione riguardo al container `rocketpool_validator`).


      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Se stai utilizzando Prysm o Lodestar come client Consensus, probabilmente noterai che il container `rocketpool_validator` si sta riavviando costantemente.
        Questo è normale!
        Il container del validator fallirà fino a quando non verrà creato un nuovo validator utilizzando il comando `rocketpool node deposit`, che tratteremo nella sezione [Creazione di un Minipool (Validator)](./create-validator).
        Una volta fatto questo, il container funzionerà correttamente - fino ad allora, ignoralo.
      </p>

      Comunque, potrebbe essere utile controllare i log dei vari servizi.

      Per controllare i log, usa il comando `rocketpool service logs container`, dove `container` è uno di `eth1`, `eth2`, `validator`, `api`, `node` o `watchtower`.

      Ad esempio, per controllare i log del tuo client ETH1:

      ```
      $ rocketpool service logs eth1

      Attaching to rocketpool_eth1
      eth1_1        | INFO [06-17|05:17:19.052] Imported new block receipts              count=25   elapsed=26.651ms    number=247,000   hash=6583ec..35eb1c age=2y3mo2w  size=15.72KiB
      eth1_1        | INFO [06-17|05:17:19.098] Imported new block headers               count=192  elapsed=18.515ms    number=247,551   hash=b7d5e4..d49faf age=2y3mo2w
      eth1_1        | INFO [06-17|05:17:19.334] Imported new block receipts              count=371  elapsed=46.450ms    number=247,371   hash=dd3240..1ed173 age=2y3mo2w  size=266.59KiB
      eth1_1        | INFO [06-17|05:17:19.354] Imported new state entries               count=1271 elapsed=2.866ms     processed=374,695 pending=3134  trieretry=0   coderetry=0  duplicate=0 unexpected=0
      eth1_1        | INFO [06-17|05:17:19.441] Imported new block headers               count=384  elapsed=35.331ms    number=247,935   hash=4c4dba..5bf8b6 age=2y3mo2w
      eth1_1        | INFO [06-17|05:17:19.460] Imported new block receipts              count=180  elapsed=33.648ms    number=247,551   hash=b7d5e4..d49faf age=2y3mo2w  size=128.73KiB
      eth1_1        | INFO [06-17|05:17:19.480] Imported new block headers               count=192  elapsed=19.122ms    number=248,127   hash=aa70b9..40d139 age=2y3mo1w
      eth1_1        | INFO [06-17|05:17:19.486] Imported new block receipts              count=6    elapsed=26.042ms    number=247,557   hash=fd6656..ca2439 age=2y3mo2w  size=3.77KiB
      ```

      Dovresti farlo sia per `eth1` che per `eth2` per assicurarti che entrambi i client funzionino senza errori.
    </Tab>
    <Tab label="Modalità Ibrida">
      La prima cosa da controllare è se i container Docker stanno funzionando bene o se si stanno riavviando costantemente a causa di un errore.
      Esegui il seguente comando:

      ```shell
      docker ps
      ```

      I risultati dovrebbero apparire così:

      ```
      CONTAINER ID   IMAGE                               COMMAND                  CREATED       STATUS         NAMES
      a3c22f54eff0   rocketpool/smartnode:v1.0.0-rc3     "/go/bin/rocketpool …"   2 hours ago   Up 2 minutes   rocketpool_node
      0d5818868ef6   sigp/lighthouse:v1.4.0              "sh /setup/start-val…"   2 hours ago   Up 2 minutes   rocketpool_validator
      88bea525fa89   rocketpool/smartnode:v1.0.0-rc3     "/go/bin/rocketpool …"   2 hours ago   Up 2 minutes   rocketpool_watchtower
      62314e5a0ecf   rocketpool/smartnode:v1.0.0-rc3     "/bin/sleep infinity"    2 hours ago   Up 2 minutes   rocketpool_api
      ```

      La cosa principale da controllare è la colonna `STATUS`.
      Se nessuna delle voci indica `Restarting...`, allora i container dovrebbero funzionare correttamente (vedi la nota qui sotto per un'eccezione riguardo al container `rocketpool_validator`).

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Se stai utilizzando **Lodestar** o **Prysm** come client Consensus, probabilmente noterai che il container `rocketpool_validator` si sta riavviando costantemente.
        Questo è normale!
        Il container del validator fallirà fino a quando non verrà creato un nuovo validator utilizzando il comando `rocketpool node deposit`, che tratteremo nella sezione [Creazione di un Minipool (Validator)](./create-validator).
        Una volta fatto questo, il container funzionerà correttamente - fino ad allora, ignoralo.
      </p>

      Comunque, potrebbe essere utile controllare i log dei vari servizi.

      Per controllare i log, usa il comando `rocketpool service logs container`, dove `container` è uno di `eth1`, `eth2`, `validator`, `api`, `node` o `watchtower`.

      Puoi ignorare `eth1` e/o `eth2` in base a quali stai gestendo esternamente, ma se stai lasciando che Rocket Pool ne gestisca uno, dovresti controllarne lo stato ora utilizzando questo comando.
    </Tab>
    <Tab label="Modalità Nativa">
      Il modo più semplice per controllare lo stato e i log in modalità nativa è utilizzare gli script di logging che hai creato quando hai configurato per la prima volta i servizi Smartnode.

      Ad esempio, per controllare il log di Geth, eseguiresti semplicemente:

      ```shell
      /srv/geth/log.sh
      ```

      Dovresti vedere che sta procedendo lentamente senza errori.
      Fallo per i tuoi client Execution e Consensus ora per verificare che stiano funzionando correttamente.
    </Tab>

  </Tabs>
</div>

::: tip SUGGERIMENTO
Quando hai finito di guardare i log, puoi uscire e tornare al prompt dei comandi usando `Ctrl + C`.
:::

## Attesa della Sincronizzazione dei Tuoi Client ETH

Ora che i tuoi client sono stati avviati, dovrai attendere che i tuoi client Execution e Consensus abbiano terminato la sincronizzazione con la rete prima di procedere.

Un modo semplice per controllarne lo stato è con il seguente comando:

```shell
rocketpool node sync
```

Questo comando mostrerà quanto sono avanti i tuoi client Execution e Consensus nel processo di sincronizzazione, in modo simile a questo:

```shell
$ rocketpool node sync

Your Smartnode is currently using the Hoodi Test Network.

Your eth2 client is on the correct network.

Your primary execution client is fully synced.
You do not have a fallback execution client enabled.
Your consensus client is still syncing (99.69%).
```

Puoi chiamare questo comando occasionalmente per tenere traccia dei progressi dei tuoi client.

Per ottenere un effettivo ETA del tempo di sincronizzazione, è più facile guardare i log dei tuoi client con `rocketpool service logs eth1` e `rocketpool service logs eth2` rispettivamente (o i comandi di script di log equivalenti se stai utilizzando le modalità ibride / native.)
Ogni client generalmente fornisce un ETA sullo stato di sincronizzazione nell'output del suo log.

::: tip NOTA
Possono volerci **giorni** per sincronizzare completamente sia ETH1 che ETH2 a seconda della selezione del client e del profilo hardware della tua macchina.
**Questo è previsto**.
Siediti, rilassati e aspetta che entrambi finiscano.
:::

::: warning NOTA
Se il tuo nodo non si sta sincronizzando affatto o non ha peer, potrebbe essere perché il tuo router sta bloccando le porte 30303 e 9001. Se sono chiuse, dovrai configurare il port forwarding sul tuo router. Inoltre, assicurati che il tuo nodo abbia un indirizzo IP locale statico in modo che il port forwarding non si interrompa a causa del fatto che il tuo nodo ottiene un nuovo indirizzo.
:::

## Passaggi Successivi

Una volta che i tuoi client si sono sincronizzati, sei pronto a [creare un nuovo wallet](./wallet-init) se questo è il tuo primo nodo, o [recuperare un wallet esistente](./recovering-rp) se stai ripristinando da un backup o migrando da un altro provider come Allnodes al tuo hardware.

Seleziona quale vorresti saperne di più e segui i passaggi nella guida corrispondente.
