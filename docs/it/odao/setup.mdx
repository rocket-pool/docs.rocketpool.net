import { Tab, Tabs } from "@rspress/core/theme";
import tuiOdao from "./images/tui-odao.png";

# Configurazione di un Nodo Oracle DAO

Come minimo indispensabile, un nodo standard di Rocket Pool esegue quanto segue:

- La CLI Smartnode
- Il daemon API Smartnode
- Il daemon `node` Smartnode
- Il daemon `watchtower` Smartnode

Facoltativamente, il nodo può anche eseguire i seguenti componenti:

- Un Execution Client
- Un Beacon Node
- Un Validator Client
- MEV-Boost
- Prometheus
- Il Prometheus Node Exporter
- Grafana

Ciascuno di questi componenti può essere eseguito come container Docker nella configurazione standard, come servizi `systemd` nella configurazione "Native Mode", o eseguito come entità gestite esternamente a cui lo Smartnode può connettersi tramite le rispettive route API.

Convenientemente, i nodi Oracle DAO sono gli stessi dei normali nodi Rocket Pool, ma il daemon `watchtower` svolge i compiti supplementari dell'Oracle DAO e vengono raccolte più metriche Prometheus per scopi di monitoraggio delle prestazioni.

## Configurazione Iniziale del Nodo

Il modo migliore per iniziare è seguire [le istruzioni di configurazione standard](../node-staking/platform) per un normale nodo Rocket Pool.
Questo processo ti aiuterà a determinare come desideri configurare ed eseguire il tuo nodo.

Se desideri eseguire minipool (validator) sul tuo nodo, segui la normale documentazione del nodo dall'inizio alla fine e torna qui quando hai finito.

Se _non_ intendi eseguire minipool e invece lo utilizzerai esclusivamente per i compiti dell'Oracle DAO, puoi saltare tutti i passaggi relativi allo staking di RPL e alla creazione di minipool.
Gli altri passaggi come la registrazione del nodo, stabilire una buona postura di sicurezza, monitorare la salute e le prestazioni del nodo e aggiornare lo Smartnode dopo un aggiornamento si applicano ancora a te e dovresti esaminarli attentamente prima di procedere.
Torna qui quando hai finito.

## Configurazione Aggiuntiva dell'Oracle DAO

Ci sono due impostazioni aggiuntive che devi configurare per soddisfare le tue responsabilità dell'Oracle DAO.
Seleziona la modalità che usi per configurare il tuo nodo dalle schede seguenti.

<div className="p-3">
  <Tabs>
    <Tab label="(service config) UI Interattiva">
      Apri la TUI `rocketpool service config` e vai alla sezione `Smartnode and TX Fees`.
      Qui vedrai due opzioni in fondo:

      <img src={tuiOdao} width="100%" height="auto"/>

      L'`Archive-Mode EC URL` deve essere l'endpoint HTTP della RPC API per il tuo Archive Execution Client.
      **Nota che se stai già utilizzando il tuo Archive EC come client primario in modalità Externally-Managed, puoi ignorare questa impostazione.**
    </Tab>
    <Tab label="(service config) Headlessly">

      Esegui il seguente comando per configurare il tuo nodo headlessly:

      ```shell
      rocketpool service config --smartnode-archiveECUrl "http://your Archive EC URL"
      ```

      Dove:

      `--smartnode-archiveECUrl` deve essere l'endpoint HTTP della RPC API per il tuo Archive Execution Client.
      **Nota che se stai già utilizzando il tuo Archive EC come client primario in modalità Externally-Managed, puoi ignorare questa impostazione.**

      Infine, riavvia il tuo daemon `watchtower` (ad esempio, con `docker restart rocketpool_watchtower` in modalità Docker o Hybrid, o `sudo systemctl restart rp_watchtower` in modalità Native) affinché le impostazioni abbiano effetto.
    </Tab>
    <Tab label="File di Configurazione Diretto">
      Apri il file `user-settings.yml` nella directory Smartnode (`~/.rocketpool` per impostazione predefinita) in un editor di testo.
      Scorri verso il basso fino alla sezione `smartnode`:

      ```
      smartnode:
      archiveECUrl: http://your Archive EC URL
      dataPath: /home/user/.rocketpool/data
      manualMaxFee: "0"
      minipoolStakeGasThreshold: "150"
      network: mainnet
      priorityFee: "2"
      projectName: rocketpool
      rewardsTreeMode: generate
      ```

      Sostituisci i valori nel campo `archiveECUrl`, dove:

      `archiveECUrl` deve essere l'endpoint HTTP della RPC API per il tuo Archive Execution Client.
      **Nota che se stai già utilizzando il tuo Archive EC come client primario in modalità Externally-Managed, puoi ignorare questa impostazione.**

      Infine, riavvia il tuo daemon `watchtower` (ad esempio, con `docker restart rocketpool_watchtower` in modalità Docker o Hybrid, o `sudo systemctl restart rp_watchtower` in modalità Native) affinché le impostazioni abbiano effetto.
    </Tab>

  </Tabs>
</div>

## Comandi Smartnode dell'Oracle DAO

Il gruppo di comandi `odao` della CLI Smartnode viene utilizzato per interagire con i contratti e i compiti dell'Oracle DAO on-chain:

```
NAME:
   rocketpool odao - Manage the Rocket Pool oracle DAO

USAGE:
   rocketpool odao command [command options] [arguments...]

COMMANDS:
   status, s             Get oracle DAO status
   members, m            Get the oracle DAO members
   member-settings, b    Get the oracle DAO settings related to oracle DAO members
   proposal-settings, a  Get the oracle DAO settings related to oracle DAO proposals
   minipool-settings, i  Get the oracle DAO settings related to minipools
   propose, p            Make an oracle DAO proposal
   proposals, o          Manage oracle DAO proposals
   join, j               Join the oracle DAO (requires an executed invite proposal)
   leave, l              Leave the oracle DAO (requires an executed leave proposal)

OPTIONS:
   --help, -h  show help
```

### status

Il comando `status` riassume semplicemente alcuni dettagli sull'Oracle DAO come il numero di membri e il numero di proposte:

```
The node is a member of the oracle DAO - it can create unbonded minipools, vote on DAO proposals and perform watchtower duties.

There are currently 8 member(s) in the oracle DAO.

There are 29 oracle DAO proposal(s) in total:
- 22 proposal(s) have passed and been executed
- 7 proposal(s) were cancelled, defeated, or have expired
```

### members

Il comando `members` stampa informazioni dettagliate su ciascun membro dell'Oracle DAO, incluso il loro handle, le informazioni di contatto, l'indirizzo del nodo, il bond RPL e l'ultima volta che hanno presentato una proposta per la votazione:

```
The oracle DAO has 8 members:

--------------------

Member ID:            kermit-2
URL:                  https://www.rocketpool.net
Node address:         0x04ddB06D1429578691F630B67A53916445DA38bE
Joined at:            31 Jul 21 23:32 EDT
Last proposal:        27 Sep 22 21:18 EDT
RPL bond amount:      5000.000000
Unbonded minipools:   0
...
```

### member-settings

`member-settings` mostra i valori correnti per ciascuno dei parametri configurabili relativi all'appartenenza all'Oracle DAO:

```
ODAO Voting Quorum Threshold: 51.000000%
Required Member RPL Bond: 1750.000000 RPL
Max Number of Unbonded Minipools: 250
Consecutive Challenge Cooldown: 300 Blocks
Challenge Meeting Window: 900 Blocks
Cost for Non-members to Challenge Members: 1.000000 ETH
```

Questo comando è descritto in maggiore dettaglio nella sezione [Proposte dell'Oracle DAO](./proposals).

### proposal-settings

`proposal-settings` mostra i valori correnti per ciascuno dei parametri configurabili relativi alle proposte su cui l'Oracle DAO può votare:

```
Cooldown Between Proposals: 1h0m0s
Proposal Voting Window: 168h0m0s
Delay Before Voting on a Proposal is Allowed: 15m0s
Window to Execute an Accepted Proposal: 168h0m0s
Window to Act on an Executed Proposal: 168h0m0s
```

Questo comando è descritto in maggiore dettaglio nella sezione [Proposte dell'Oracle DAO](./proposals).

### minipool-settings

`minipool-settings` mostra i valori correnti per ciascuno dei parametri configurabili relativi ai minipool sulla rete Rocket Pool:

```
Scrub Period: 1h0m0s
```

### propose

Il comando `propose` viene utilizzato per presentare proposte di governance su cui il resto dell'Oracle DAO può votare.
Queste possono comportare la modifica di un'impostazione o la modifica dei membri dell'Oracle DAO (ad esempio, invitare o rimuovere altri membri).

Questo comando è descritto in maggiore dettaglio nella sezione [Proposte dell'Oracle DAO](./proposals).

### proposals

Il comando `proposals` viene utilizzato per interagire con le proposte di governance esistenti dell'Oracle DAO.
Può visualizzarle, revocare proposte che hai fatto, votarle ed eseguirle (se applicabile) facendole entrare in vigore dopo che sono state approvate dagli altri membri:

```
NAME:
   rocketpool odao proposals - Manage oracle DAO proposals

USAGE:
   rocketpool odao proposals command [command options] [arguments...]

COMMANDS:
   list, l     List the oracle DAO proposals
   details, d  View proposal details
   cancel, c   Cancel a proposal made by the node
   vote, v     Vote on a proposal
   execute, x  Execute a proposal

OPTIONS:
   --help, -h  show help

```

Questo comando è descritto in maggiore dettaglio nella sezione [Proposte dell'Oracle DAO](./proposals).

### join / leave

I comandi `join` e `leave` vengono utilizzati per unirti all'Oracle DAO una volta che sei stato invitato, o lasciare l'Oracle DAO una volta che gli altri membri hanno approvato la tua richiesta di dimissioni.

## Unirsi all'Oracle DAO

### Il Bond RPL

Per unirti all'Oracle DAO, il wallet del tuo nodo avrà bisogno di abbastanza RPL per coprire il bond di appartenenza richiesto.
Questo verrà bloccato nel vault di Rocket Pool come parte del processo di adesione.
L'importo esatto di RPL richiesto per il bond sarà determinato al momento del tuo invito e ti verrà comunicato dagli altri membri dell'Oracle DAO prima di effettuare il tuo onboarding.

::: warning NOTA
A differenza di tutte le altre ricompense ETH e RPL, il bond RPL _non_ viene inviato al withdrawal address del tuo nodo quando esci dall'Oracle DAO.
Viene restituito al wallet del tuo nodo stesso.
Considera questo come un incentivo extra per proteggere il wallet del tuo nodo da compromissioni.
:::

### Accettare un Invito

Una volta che il tuo nodo è configurato e sei stato invitato a unirti all'Oracle DAO dai membri esistenti, puoi utilizzare il comando `rocketpool odao join` per accettare l'invito.
Questo comporterà due transazioni:

- Una per bloccare gli RPL richiesti per il tuo bond
- Una per unirti all'Oracle DAO quando il bond è stato ricevuto

Una volta che ti sei unito, il tuo daemon `watchtower` inizierà automaticamente a svolgere i suoi compiti richiesti.
Puoi verificarlo guardando i suoi log (ad esempio `rocketpool service logs watchtower` per le installazioni standard basate su Docker); il watchtower esegue il suo ciclo di compiti ogni 4-6 minuti e noterai un cambiamento distinto nel suo output una volta che ti sarai unito all'Oracle DAO.

### Prossimi Passi

Ora che ti sei unito all'Oracle DAO, dai un'occhiata alla sezione successiva per imparare come testare il tuo nodo in questo ruolo.
