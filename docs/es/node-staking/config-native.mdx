import nimbus_dashboard from "./images/nimbus-dashboard.png";
import tui_checkbox_checked from "./images/tui-checkbox-checked.png";
import tui_checkbox_unchecked from "./images/tui-checkbox-unchecked.png";
import tui_dropdown_closed from "./images/tui-dropdown-closed.png";
import tui_dropdown_open from "./images/tui-dropdown-open.png";
import tui_native_cc_url from "./images/tui-native-cc-url.png";
import tui_native_cc from "./images/tui-native-cc.png";
import tui_native_ec from "./images/tui-native-ec.png";
import tui_native_finished from "./images/tui-native-finished.png";
import tui_native_metrics from "./images/tui-native-metrics.png";
import tui_native_mev from "./images/tui-native-mev.png";
import tui_native_network from "./images/tui-native-network.png";
import tui_native_welcome from "./images/tui-native-welcome.png";
import tui_native_other from "./images/tui-native-other.png";
import tui_native_review from "./images/tui-native-review.png";
import tui_native_settings_home from "./images/tui-native-settings-home.png";
import tui_native_smartnode from "./images/tui-native-smartnode.png";
import tui_textbox from "./images/tui-textbox.png";

# Configuración del Stack de Smartnode (Modo Nativo)

En esta sección, repasaremos los distintos métodos para configurar Smartnode si estás usando la **configuración nativa** que no usa Docker en absoluto.

::: warning NOTA
Si estás usando una configuración basada en Docker, visita la [guía de configuración de Docker](./config-docker) en su lugar.
:::

Hay tres formas de configurarlo:

- A través de la [Interfaz del Asistente](#configuración-a-través-del-asistente) - esta es la forma más fácil. Solo te hace unas pocas preguntas básicas y usa valores predeterminados bien probados para el resto. Esto es lo que se te presentará cuando ejecutes `rocketpool service config` por primera vez.
- A través de la [Interfaz del Administrador de Configuración](#configuración-a-través-del-administrador-de-configuración) - esto te da acceso a todas las configuraciones de Smartnode para que puedas personalizar todo tanto como quieras.
- Sin interfaz a través de la [Línea de Comandos](#configuración-a-través-de-la-línea-de-comandos) - esta es una opción para personas que ejecutan Smartnode en un entorno sin interfaz (no interactivo) y necesitan configurarlo automáticamente.

Elige qué modo te gustaría conocer más de la lista anterior, o simplemente desplázate por cada opción a continuación.

## Configuración a través del Asistente

Para configurar Smartnode, ejecuta el comando de configuración:

```shell
rp service config
```

Esto lanzará una interfaz de usuario basada en terminal que te permitirá configurar tu nodo de manera rápida y fácil, además de proporcionar un control opcional de grano fino sobre las configuraciones que son relevantes para el modo nativo.

::: tip NOTA
Si ya has configurado Smartnode, en su lugar serás recibido con el [Administrador de Configuración](#configuración-del-stack-de-smartnode-a-través-del-administrador-de-configuración).
Puedes elegir volver a abrir el Asistente desde allí si lo prefieres, y todas tus configuraciones existentes estarán preseleccionadas para ti.
:::

Cuando ejecutes la interfaz de configuración por primera vez (o si eliges ejecutar el Asistente nuevamente más tarde), se te presentará una pantalla que se ve así:

<img src={tui_native_welcome} width="100%" height="auto" />

::: tip CONSEJO
Para usar el Asistente, **presiona las `Teclas de Flecha` (arriba/abajo/izquierda/derecha) para navegar entre cosas como botones (opciones) o cuadros de texto**.
También puedes usar `Tab` y `Shift+Tab` si lo prefieres - hará lo mismo.

Para los botones, **el que esté actualmente seleccionado estará resaltado en verde**.
Los que están en negro no están seleccionados.
En la captura de pantalla anterior, `Next` está actualmente seleccionado y `Quit` no lo está.

**Presiona `Enter` o `Space` para seleccionar un botón**, análogo a hacer clic en él con el ratón.

**Presiona `Escape` para volver al cuadro de diálogo anterior** si cambiaste de opinión sobre algo.
Esto será útil a medida que avances por las distintas páginas del Asistente.

**Mantén presionado `Ctrl` y presiona `C` en cualquier momento para salir del Asistente sin guardar nada**.

Por ejemplo, en la pantalla de arriba, podrías presionar las teclas de flecha `izquierda` y `derecha` para moverte entre los botones `Next` y `Quit`.

Presionar `Enter` mientras `Next` está seleccionado procederá a la siguiente pantalla.
Presionar `Enter` mientras `Quit` está seleccionado cerrará el Asistente sin guardar.
:::

Cuando estés listo para comenzar, presiona `Next`.

### Elegir una Red

En la siguiente pantalla, se te pedirá que elijas qué red quieres usar:

<img src={tui_native_network} width="100%" height="auto" />

Puedes resaltar las diferentes opciones con las teclas de flecha `Arriba` y `Abajo` (o `Tab` y `Shift+Tab`).
Cuando cambies de opción, el cuadro de **Descripción** a la derecha te mostrará una breve descripción de cada opción.
Esto es cierto para todas las páginas basadas en opciones del Asistente, no solo la selección de red, por lo que verás este estilo de página con frecuencia.

Si quieres practicar ejecutando un nodo Rocket Pool en la red de prueba Hoodi con ETH y RPL falsos que puedes obtener gratis, selecciona **Hoodi Testnet**.

Si estás listo para crear un nodo Rocket Pool real en Mainnet para ganar recompensas reales, selecciona **Mainnet**.

### Configuración del Cliente de Ejecución

La siguiente pantalla te pedirá la URL de la API RPC basada en HTTP de tu cliente de Ejecución:

<img src={tui_native_ec} width="100%" height="auto" />

Ingresa `http://127.0.0.1:8545` aquí si planeas ejecutar un cliente de Ejecución en la misma máquina que Smartnode (en el resto de esta guía, asumiremos que esto es lo que planeas hacer).
Sin embargo, si ya tienes un cliente de Ejecución configurado en otro lugar, usa su URL aquí en su lugar.

Ten en cuenta que siempre puedes cambiar esto ejecutando `rp service config` nuevamente más tarde.

### Configuración del Cliente de Consenso

A continuación, se te preguntará qué cliente de Consenso estás usando (o planeas usar).
Debido a que cada cliente de Consenso tiene un comportamiento ligeramente diferente, Smartnode necesita saber cuál estás usando para que pueda adaptar su propio comportamiento en consecuencia.
Elige tu cliente de la lista en la siguiente pantalla:

<img src={tui_native_cc} width="100%" height="auto" />

A continuación, verás una pantalla que te pide la URL de la API de tu cliente:

<img src={tui_native_cc_url} width="100%" height="auto" />

Ingresa `http://127.0.0.1:5052` aquí si planeas ejecutar el Beacon Node de tu cliente de Consenso en la misma máquina que Smartnode (en el resto de esta guía, asumiremos que esto es lo que planeas hacer).
Sin embargo, si ya tienes un Beacon Node configurado en otro lugar, usa su URL aquí en su lugar.

### Otras Configuraciones

La siguiente pantalla tendrá algunas otras configuraciones misceláneas:

<img src={tui_native_other} width="100%" height="auto" />

Deja estas como las opciones predeterminadas a menos que hayas decidido usar un directorio que no sea `/srv/rocketpool` para tu instalación de Smartnode.

### Clientes de Respaldo

A partir de la versión 1.5.0 del stack de Smartnode, puedes proporcionar un par de cliente de Ejecución y cliente de Consenso de "respaldo" que puede tomar el control de tus clientes principales si alguna vez se desconectan (como porque usas Geth y necesitas podarlo).
En esta situación, tu máquina de nodo principal aún será responsable de atestar y proponer bloques con las claves de validador de tus minipools, pero se conectará a una máquina externa para interactuar con la capa de Ejecución y las cadenas Beacon.

[Para aprender más sobre los nodos de respaldo, consulta esta sección](./fallback) y regresa aquí cuando hayas terminado.

### Métricas

Rocket Pool tiene la capacidad de integrarse con Prometheus y Grafana para producir paneles convenientes basados en web que te permiten observar la salud de tu nodo de un vistazo:

<img src={nimbus_dashboard} width="100%" height="auto" />

La pregunta final en el Asistente te preguntará si quieres habilitar esto:

<img src={tui_native_metrics} width="100%" height="auto" />

Si eliges habilitarlo, aprenderás más sobre cómo configurarlo y cómo usarlo en la sección [Configurar el Panel de Grafana](./grafana.mdx) más adelante en el proceso.

::: warning NOTA
Todos los datos recopilados por este sistema **permanecen en tu máquina**.
Rocket Pool no recopila ninguna telemetría ni la envía a un servicio separado.
¡Está ahí puramente para que la uses y puedas monitorear tu propio nodo!
:::

### Configuración de MEV

Desde la fusión de las capas de Ejecución y Consenso en septiembre de 2022, los validadores de Ethereum ahora tienen la capacidad de ganar tarifas prioritarias y participar en el Valor Extraíble Máximo (o MEV para abreviar).

A partir de Smartnode v1.7.0, MEV ahora es _opt-out_, por lo que se presenta una notificación sobre configurarlo como parte de la configuración inicial, como ves en la siguiente pantalla:

<img src={tui_native_mev} width="100%" height="auto" />

[Lee nuestra guía de MEV para aprender más sobre MEV, su configuración y qué hacer en esta sección del asistente.](./mev.mdx)
Regresa aquí cuando hayas terminado.

### Finalización

Después de esta pregunta, has terminado de configurar la configuración de Smartnode.
Verás el siguiente cuadro de diálogo:

<img src={tui_native_finished} width="100%" height="auto" />

Si estás satisfecho con tu configuración y estás listo para iniciar Smartnode, haz clic en `Save and Exit` aquí.

Si aún no has terminado de instalar Rocket Pool, regresa a la guía de configuración nativa ahora.
De lo contrario, el siguiente paso es reiniciar tus servicios daemon con:

```shell
sudo systemctl restart rp-node rp-watchtower
```

Si te gustaría revisar todas las configuraciones y personalizar muchas configuraciones adicionales que no se incluyeron en el Asistente, haz clic en `Review All Settings` y ve a la [siguiente sección](#configuración-a-través-del-administrador-de-configuración).

## Configuración a través del Administrador de Configuración

Si ya has ejecutado `rp service config`, en lugar de ser recibido por el Asistente, verás la pantalla del **Administrador de Configuración**:

<img src={tui_native_settings_home} width="100%" height="auto" />

Hay tres características principales de esta pantalla:

1. La **Lista de Categorías**, que te permite profundizar en las configuraciones de cada categoría del stack de Smartnode que es relevante para el modo nativo
2. El botón **Review Changes and Save**, que puedes usar cuando estés listo para ver qué configuraciones has cambiado y guardar la configuración actualizada
3. El botón **Open the Config Wizard**, que te llevará al [Asistente de Configuración](#configuración-del-stack-de-smartnode-a-través-del-asistente) si prefieres esa interfaz

::: tip CONSEJO
Para usar el Administrador de Configuración, **presiona las `Teclas de Flecha` (arriba/abajo/izquierda/derecha) para navegar entre opciones en la página de inicio**.

Presiona `Tab` para ir **entre la lista de categorías (1) y los botones (2 y 3)** en la parte inferior de la pantalla.
El botón que está actualmente seleccionado estará **resaltado en verde**.

**Presiona `Enter` o `Space` para seleccionar un botón**, análogo a hacer clic en él con el ratón.

**Mantén presionado `Ctrl` y presiona `C` en cualquier momento para salir del Administrador de Configuración sin guardar nada**.
:::

A medida que te desplazas por la lista de categorías, cada opción tendrá una descripción útil que aparecerá en el **Cuadro de Descripción** a la derecha de la pantalla.
Siéntete libre de explorarlas; nada de lo que hagas se guardará hasta que pases por el cuadro de diálogo de Revisión a través del botón **Review Changes and Save**, y puedes presionar **Ctrl+C** en cualquier momento para salir sin guardar, así que no estropearás accidentalmente algo jugando con las configuraciones aquí.

### Configurar las Configuraciones

Desde la pantalla de inicio, selecciona cualquiera de las categorías con la tecla `Enter` para ver las configuraciones de esa categoría.
Por ejemplo, aquí está la pantalla para la categoría **Smartnode and TX Fees**:

<img src={tui_native_smartnode} width="100%" height="auto" />

Usa las `Teclas de Flecha` para moverte arriba y abajo entre las configuraciones.
La actualmente seleccionada tendrá un cuadrado blanco al final (si es un cuadro de texto o una casilla de verificación), o estará resaltada en blanco (si es un menú desplegable).

Presiona `Escape` para volver a la pantalla de inicio del Administrador de Configuración cuando hayas terminado.

A medida que te desplazas por las configuraciones, cada una mostrará una breve descripción de lo que hace en el **Cuadro de Descripción** a la derecha.
También mostrará el **valor predeterminado** allí en caso de que quieras revertirlo a su configuración predeterminada.

En este ejemplo, la configuración **RPL Claim Gas Threshold** está actualmente seleccionada (resaltada con un cuadro verde en el lado izquierdo de la pantalla).
Se ha cambiado a `40`, pero puedes ver que tiene un valor predeterminado de `150` en la esquina superior derecha (la parte superior del **Cuadro de Descripción**).

::: tip CONSEJO
Como recordatorio, nada se guardará en el disco hasta que pases por el cuadro de diálogo de Revisión a través del botón **Review Changes and Save**.
Se te anima a explorar todas las configuraciones para aprender sobre ellas.
:::

### Los Tipos de Configuración y Cómo Usarlos

El administrador de configuración usa los siguientes tipos de configuración y elementos de interfaz de usuario:

#### Cuadros de Texto

Los cuadros de texto se usan para ingresar cadenas arbitrarias de texto o números.
Se ven así:

<img src={tui_textbox} width="100%" height="auto" />

Ingresa los valores deseados en ellos, luego **presiona `Enter` o usa las `Teclas de Flecha` para navegar a una configuración diferente para preservar tus cambios.**
Si no lo haces, el Administrador de Configuración asumirá que todavía estás actualizando esa configuración y no la marcará como cambiada todavía.

#### Menús Desplegables

Los menús desplegables se usan para seleccionar una opción de una lista de opciones.
Se ven así (cuando están abiertos):

<img src={tui_dropdown_open} width="100%" height="auto" />

El elemento **verde** es el que está actualmente seleccionado.
Usa las `Teclas de Flecha` para cambiar opciones - a medida que lo haces, el **Cuadro de Descripción** a la derecha se actualizará para decirte más sobre la opción actualmente seleccionada.
Cuando estés satisfecho con tu elección, presiona `Enter` para elegir la opción seleccionada y el menú desplegable se cerrará, revelando la opción que está actualmente seleccionada:

<img src={tui_dropdown_closed} width="100%" height="auto" />

#### Casillas de Verificación

Las casillas de verificación se usan para preguntas simples de Sí/No.
Se ven así:

<img src={tui_checkbox_checked} width="100%" height="auto" />

Cuando están marcadas, tendrán una `X` en el medio como ves arriba.
Cuando están _no marcadas_, simplemente estarán en blanco como esto:

<img src={tui_checkbox_unchecked} width="100%" height="auto" />

Para cambiar la configuración, simplemente selecciónala y presiona `Enter`.

### Guardar Cambios

Cuando estés satisfecho con tus cambios y te gustaría revisarlos antes de guardar, presiona el botón **Review Changes and Save** en la pantalla de inicio.
Como recordatorio, para llegar a él, presiona la tecla `Tab`.

Se te presentará una vista que se ve así:

<img src={tui_native_review} width="100%" height="auto" />

El **Cuadro de Revisión** aquí presentará todas las configuraciones que has cambiado, mostrando los valores antiguos y los nuevos.
Por ejemplo, la primera línea aquí muestra que el **RPL Claim Gas Threshold** solía ser `150`, y se ha cambiado a `40`.

::: tip NOTA
En este punto, tus cambios **aún no se han guardado**.
Si quieres volver atrás y modificar algo, presiona `Escape` para volver a la pantalla de inicio.
:::

Cuando estés satisfecho con los cambios, presiona `Enter` para guardar la nueva configuración en el disco.
Luego saldrás de la interfaz de terminal y se te presentará este mensaje:

```
Your changes have been saved!
Please restart your daemon service for them to take effect.
```

Si aún no has terminado de instalar Rocket Pool, regresa a la guía de configuración nativa ahora.
De lo contrario, ahora puedes reiniciar tus servicios daemon con:

```shell
sudo systemctl restart rp-node rp-watchtower
```

## Configuración a través de la Línea de Comandos

Si usas Smartnode en un entorno sin interfaz donde no puedes interactuar con la interfaz de terminal, puedes configurar tu nodo a través de la línea de comandos en su lugar.

El comando `rocketpool service config` acepta, como argumentos, cada configuración que normalmente se puede configurar a través de la interfaz de terminal.
Ejecuta el siguiente comando para ver una lista de ellas (nota que es bastante larga):

```
rocketpool service config --help
```

La salida se verá así:

```
NAME:
   rocketpool service config - Configure the Rocket Pool service

USAGE:
   rocketpool service config

OPTIONS:
   --executionClientMode value  Choose which mode to use for your Execution client - locally managed (Docker Mode), or externally managed (Hybrid Mode).
                                Type: choice
                                Options: local, external
 (default: "local")
   --executionClient value  Select which Execution client you would like to run.
                            Type: choice
                            Options: geth, infura, pocket
 (default: "geth")
   --useFallbackExecutionClient         Enable this if you would like to specify a fallback Execution client, which will temporarily be used by the Smartnode and your Consensus client if your primary Execution client ever goes offline.
                                        Type: bool

...
```

Cada opción tendrá su nombre, su tipo, su valor predeterminado y (si es un parámetro de elección) sus opciones.
Usando este texto, puedes encontrar la(s) opción(es) que deseas establecer y especificarlas a través de los argumentos apropiados.

::: tip NOTA
Este comando se basa en tu configuración existente, por lo que si ya tienes algunas configuraciones guardadas y solo quieres modificar otras, no necesitas repetirlas.
Solo actualizará las configuraciones que incluyas como argumentos de este comando.
:::

Si aún no has terminado de instalar Rocket Pool, regresa a la guía de configuración nativa ahora.
De lo contrario, el siguiente paso es reiniciar tus servicios daemon con:

```shell
sudo systemctl restart rp-node rp-watchtower
```
