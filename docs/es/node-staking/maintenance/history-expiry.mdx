import { Tab, Tabs } from "@rspress/core/theme";

# Caducidad del Historial Pre-Merge

Todos los clientes de Ejecución ahora admiten la caducidad parcial del historial de acuerdo con [EIP-4444](https://eips.ethereum.org/EIPS/eip-4444). Los usuarios pueden reducir sustancialmente
los requisitos de almacenamiento de su nodo eliminando el historial de bloques pre-merge a partir de la versión `v1.17.0` del Smartnode. No dudes en consultar
esta publicación del blog para obtener más información sobre la caducidad parcial del historial: https://blog.ethereum.org/2025/07/08/partial-history-exp

::: tip NOTA

    Ten en cuenta que los pasos para eliminar el historial pre-merge dependen del cliente de Ejecución seleccionado en tu nodo:
    - Los usuarios de Nethermind necesitarán una resincronización completa para eliminar el historial pre-merge.
    - Los usuarios de Geth pueden usar el comando `rocketpool service prune-eth1` o realizar una resincronización completa.
    - Los usuarios de Besu y Reth pueden realizar una poda en línea mientras su nodo continúa atestando.

:::

Los siguientes pasos para eliminar el historial pre-merge son solo para nodos en modo Docker. Si estás utilizando un cliente externo en
modo Híbrido o modo Nativo, consulta la documentación proporcionada por tu cliente de Ejecución.

Comienza abriendo el Administrador de Configuración:

```shell
rocketpool service config
```

Para cambiar el modo de poda del Cliente de Ejecución, ve al menú `Execution Client (ETH1)` y selecciona la configuración `History Expiry` en el menú desplegable de `Pruning Mode`

![](../images/tui-history-expiry.png)

Después de haber realizado la selección, presiona `escape` para volver al menú principal, luego presiona `tab` para resaltar el botón `Review Changes and Save`. Presiona
la tecla `enter` para continuar. Se te presentará un menú para previsualizar los cambios en la configuración de tu cliente de Ejecución.

![](../images/tui-review-history-expiry.png)

Presiona la tecla `enter` en `Save Settings` para guardar y salir del Administrador de Configuración, luego ingresa `y` para reiniciar tu contenedor `rocketpool_eth1`.

```shell
Your changes have been saved!
The following containers must be restarted for the changes to take effect:
	rocketpool_eth1
Would you like to restart them automatically now? [y/n]
```

A partir de este punto, los pasos difieren según el cliente de Ejecución que estés usando:

<div className="p-3">
  <Tabs>

        <Tab label="Nethermind">
        Los nodos Nethermind requieren una resincronización completa para eliminar el historial pre-merge. Debes resincronizar tu cliente de Ejecución después de guardar
        la configuración `History Expiry` y reiniciar tu contenedor `eth1`.

        ::: warning ADVERTENCIA
        Si no tienes un nodo de respaldo configurado, tu nodo dejará de validar durante una resincronización. Un nodo de respaldo
        permitirá que tu nodo principal continúe atestando y proponiendo bloques durante una poda o resincronización. Haz clic [aquí](/es/node-staking/fallback)
        para aprender cómo configurar un nodo de respaldo.
        :::

        Usa el siguiente comando para resincronizar tu cliente de Ejecución:
        ```shell
        rocketpool service resync-eth1
        ```

        ¡Todo listo! El nodo ya no almacenará datos pre-merge, mejorando sustancialmente la viabilidad de ajustar un nodo en una unidad de 2 TB.
        Recomendamos monitorear el progreso usando el siguiente comando.
        ```shell
        rocketpool service logs eth1
        ```

    </Tab>

    <Tab label="Geth">

        Los nodos Geth requieren una poda sin conexión para eliminar el historial pre-merge. Debes podar tu cliente de Ejecución después de guardar
        la configuración `History Expiry` y reiniciar tu contenedor `eth1`. Alternativamente, puedes optar por realizar una resincronización completa para eliminar el historial pre-merge.

        ::: tip NOTA
        Recomendamos la poda sobre realizar una resincronización completa. Si deseas comenzar de nuevo con una base de datos Geth fresca o tienes un problema
        con la poda, puedes resincronizar el cliente de Ejecución usando `rocketpool service resync-eth1`. Ambas opciones deberían resultar en historial pre-merge caducado.
        :::

        ::: warning ADVERTENCIA
        Si no tienes un nodo de respaldo configurado, tu nodo dejará de validar durante una poda o resincronización. Un nodo de respaldo
        permitirá que tu nodo principal continúe atestando y proponiendo bloques durante una poda o resincronización. Haz clic [aquí](/es/node-staking/fallback)
        para aprender cómo configurar un nodo de respaldo.
        :::

        Ejecuta el siguiente comando para podar tu cliente de Ejecución:
        ```shell
        rocketpool service prune-eth1
        ```
        Puedes hacer clic [aquí](/es/node-staking/pruning#starting-a-prune) para obtener más información sobre la poda.

        ¡Todo listo! El nodo ya no almacenará datos pre-merge, mejorando sustancialmente la viabilidad de ajustar un nodo en una unidad de 2 TB.
        Recomendamos monitorear el progreso usando el siguiente comando.
        ```shell
        rocketpool service logs eth1
        ```

    </Tab>

    <Tab label="Besu">

        ¡Todo listo! Los nodos Besu realizarán una poda en línea mientras continúan atestando y proponiendo bloques.
        El nodo ya no almacenará datos pre-merge, mejorando sustancialmente la viabilidad de ajustar un nodo en una unidad de 2 TB.
        Recomendamos monitorear el progreso usando el siguiente comando.
        ```shell
        rocketpool service logs eth1
        ```

    </Tab>

    <Tab label="Reth">

        ¡Todo listo! Los nodos Reth realizarán una poda en línea mientras continúan atestando y proponiendo bloques.
        El nodo ya no almacenará datos pre-merge, mejorando sustancialmente la viabilidad de ajustar un nodo en una unidad de 2 TB.
        Recomendamos monitorear el progreso usando el siguiente comando.
        ```shell
        rocketpool service logs eth1
         ```

    </Tab>

  </Tabs>
</div>
