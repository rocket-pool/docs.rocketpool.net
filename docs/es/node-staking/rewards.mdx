import claim_rewards_gb from "./images/claim-rewards-gb.png";
import autostake from "./images/autostake.png";

# Reclamar Recompensas de Operador de Nodo

Como operador de nodo de Rocket Pool, tienes derecho a recompensas regulares que se proporcionarán en forma de tokens RPL y (si estás incluido en el Smoothing Pool) algo de ETH también.
Esta sección describirá cómo funcionan estas recompensas y cómo puedes reclamarlas.

## Recompensas y Puntos de Control

A intervalos regulares, Rocket Pool marcará un **punto de control** en la red.
Actualmente, los puntos de control ocurren **cada 28 días**.

En un nuevo punto de control, el Oracle DAO creará colectivamente una **instantánea verdadera** del estado de los operadores de nodo en la red de Rocket Pool, que utilizará para determinar las recompensas de RPL y ETH del Smoothing Pool para cada nodo durante ese intervalo. Ten en cuenta que la "comisión adicional" para los minipools Saturn 0 se distribuye usando las recompensas del smoothing pool (los minipools Saturn 0 son los creados después del 28/10/2024, que tienen una comisión de contrato del 5%).

Esta información se compila en un [Árbol de Merkle](https://en.wikipedia.org/wiki/Merkle_tree) - una forma extremadamente eficiente de hacer que todos los detalles estén disponibles para los contratos inteligentes.
El Árbol de Merkle se construye en un archivo JSON y se aloja en el [Sistema de Archivos InterPlanetario (IPFS)](https://en.wikipedia.org/wiki/InterPlanetary_File_System) y se refleja en [un repositorio de GitHub que mantenemos](https://github.com/rocket-pool/rewards-trees/).

Una vez que se envía el árbol, los contratos inteligentes de Rocket Pool acuñarán nuevos tokens RPL y los moverán, junto con el saldo completo de ETH del Smoothing Pool, a la bóveda de Rocket Pool para almacenamiento seguro.
Luego puedes ver cuántas recompensas de RPL y ETH ganaste durante ese intervalo y reclamar esas recompensas.

El sistema de recompensas tiene las siguientes características:

- Cada intervalo es independiente. La cantidad de RPL y ETH que ganaste en un intervalo no afecta las ganancias de intervalos posteriores.
- Puedes **dejar que las recompensas se acumulen** durante el tiempo que desees. No necesitas reclamar recompensas en un tiempo específico; siempre estarán disponibles para que las reclames, y siempre proporcionarán exactamente la misma cantidad de RPL y ETH **independientemente de cuándo las reclames**.
- Puedes reclamar un intervalo a la vez, o **múltiples intervalos** todos a la vez.
- Tu primera transacción de reclamación usa alrededor de 85k gas. Cada transacción de reclamación posterior cuesta alrededor de 55k gas.
  - Si estás reclamando múltiples intervalos a la vez, cada intervalo suplementario cuesta **6k gas**, por lo que es más rentable reclamar tantos como sea posible de una vez.
- Puedes **reestaquear parte (o todas) de tus recompensas de RPL** como parte de la transacción de reclamación, por lo que todo se realiza en una sola transacción (lo que reduce aún más los costos de gas).
- Actualmente, **todas tus reclamaciones deben estar en Mainnet**, pero tenemos la infraestructura para construir la capacidad de reclamar en redes de Capa 2 en una fecha posterior.

Para obtener más información sobre cómo se construye el Árbol de Merkle y cómo se calculan las recompensas, [visita nuestro repositorio `research` y consulta las especificaciones oficiales](https://github.com/rocket-pool/rocketpool-research/tree/master/Merkle%20Rewards%20System).
Hemos proporcionado una breve explicación de ellas a continuación.

### Recompensas de RPL

La tasa de recompensas actual de RPL es **5% de inflación por año** y las recompensas se pagan cada período de 28 días.
A partir del 21/10/2024, la inflación del último período fue de 77,533. Dado que el 70% se distribuye a los operadores de nodo de Rocket Pool, eso fue 54,273 RPL ese período.

Esta cantidad se dividirá entre todos los operadores de nodo en la red, según su [peso de nodo](https://rpips.rocketpool.net/RPIPs/RPIP-30#specification).
Los operadores de nodo ganan el APY máximo para posiciones de RPL estacadas que valen 0-15% del ETH prestado.
El stake de RPL más allá del 15% del ETH prestado aún gana recompensas adicionales, pero con un APY marginal reducido.

Si han pasado menos de 28 días entre el momento en que registraste tu nodo y el punto de control, tus recompensas en ese primer intervalo de recompensas serán **prorrateadas** para tener en cuenta eso. Por ejemplo, si te registraste el día 14 del intervalo, recibirías el 50% de las recompensas normales.

Después de ese primer intervalo, tu nodo habrá estado registrado el tiempo suficiente en intervalos posteriores para que recibas recompensas completas para todos ellos.

El comando `rocketpool node status` te mostrará tu índice de colateralización actual en cualquier momento. Este índice de colateralización se basará en los precios en el momento en que ejecutes el comando. Sin embargo, si quieres saber cuál será tu índice de colateralización en la próxima ronda de recompensas, sigue los siguientes pasos:

- Ejecuta el comando `/when` en el canal "random" del [Discord de Rocketpool](https://discord.com/channels/405159462932971535/405503016234385409), y mira cuántas horas faltan antes de que comience el próximo período de recompensas.
- El oDAO toma una instantánea de precio cada 19.2 horas (es decir, alrededor de 5760 bloques \* 12 segundos, excluyendo bloques perdidos). Por lo tanto, verificar el contrato de presentación de precios del oDAO en Etherscan te dirá si se tomó una instantánea de precio en las 19.2 horas anteriores antes del momento indicado en el punto anterior. Si ese es el caso, se tomó la instantánea de precio. Si no, aún está por hacerse y puedes estimar cuándo sucederá mirando la última ronda de presentaciones de precios del oDAO y agregando 19.2 horas.
- Para verificar qué ratio de precio RPL/ETH fue tomado como instantánea por el oDAO para la próxima ronda de recompensas, verifica el contrato de presentación de precios del oDAO en Etherscan (que puedes obtener ejecutando el comando `/get_address_of_contract contract:rocketNetworkPrices` en el canal "random" del Discord de Rocketpool). Luego, abre una o más de las transacciones enviadas por los miembros del oDAO. <a href="/images/node/rewards/rewards-1.png" target="_blank"><img src="/images/node/rewards/rewards-1.png" style={{ display: "block", margin: "0 auto" }} /></a>
- Desplázate hacia abajo y en la sección "More Details", haz clic en **"+ Click to show more"**, y luego haz clic en **"Decode Input Data"**. <a href="/images/node/rewards/rewards-2.png" target="_blank"><img src="/images/node/rewards/rewards-2.png" style={{ display: "block", margin: "0 auto" }} /></a>
- El precio de RPL (mostrado en unidades wei) que se muestra en el cuadro Input Data, dividido por 10^18 (para convertirlo a unidades ETH) multiplicado por el número de RPL estacado, debe ser >= 1.6 ETH (para minipools de 16 ETH) y >= 2.4 ETH (para LEB8s), multiplicado por el número de minipools de cada tipo que operas. <a href="/images/node/rewards/rewards-3.png" target="_blank"><img src="/images/node/rewards/rewards-3.png" style={{ display: "block", margin: "0 auto" }} /></a>
- Si tu ratio de colateral está por debajo de la cantidad requerida como se explicó en el punto anterior, puedes estaquear RPL adicional en el tiempo entre que el oDAO tomó la última instantánea de precio (ver punto 3 anterior) y el momento en que comience la próxima ronda de recompensas (ver puntos 1 y 2 anteriores), para devolver tu nodo a un ratio de colateralización >=10%.
- Una alternativa a verificar las presentaciones de precios del oDAO en etherscan es vigilar el canal "events" del discord de Rocketpool, y buscar el mensaje **RPL Price Update** del bot Rocket Watch (ver ejemplo a continuación) dentro de las últimas 19.2 horas antes de que comience el próximo período de recompensas. <a href="/images/node/rewards/rewards-4.png" target="_blank"><img src="/images/node/rewards/rewards-4.png" style={{ display: "block", margin: "0 auto" }} /></a>

### Recompensas de ETH del Smoothing Pool

Junto con las recompensas de RPL, el saldo completo de ETH del Smoothing Pool se distribuye durante los puntos de control de recompensas.
Del saldo total de recompensas del Smoothing Pool, el porcentaje que corresponde a los stakers del pool (50% para minipools de 16 ETH, o 75% para LEB8s), menos la comisión respectiva del nodo, se enviará al contrato rETH. Allí puede 1) quemarse por ETH de los stakers del pool que quieren salir, o 2) usarse para crear más minipools.
La porción restante se distribuirá entre los operadores de nodo elegibles.

Los nodos que estén incluidos en el smoothing pool durante el intervalo, incluso si solo es parte del tiempo, son elegibles para una porción del saldo total del Smoothing Pool.
El saldo se toma como instantánea en el punto de control de recompensas, y el Oracle DAO determina la porción de cada nodo elegible.
La porción se determina por los siguientes factores:

- Cantidad de tiempo en el Smoothing Pool este intervalo
- Rendimiento de atestación en la Beacon Chain para cada minipool
- La comisión de cada minipool

Si deseas saber más, consulta el repositorio `research` vinculado anteriormente para obtener un desglose completo de cómo se calculan las recompensas.

### (Opcional) Generando el Árbol de Recompensas

Cuando se alcanza un nuevo punto de control de recompensas, el Oracle DAO comenzará a construir el árbol de recompensas para ese intervalo.
Construir este árbol actualmente toma aproximadamente 2 horas, y las recompensas para el intervalo no están disponibles para reclamar hasta que el árbol haya sido construido y enviado.
Una vez que esté disponible, tu nodo descargará automáticamente este archivo y podrás ver y reclamar tus recompensas para ese intervalo.

Si deseas generar el árbol tú mismo en lugar de descargar el preconstruido del Oracle DAO, ¡puedes hacerlo!

- Ingresa al TUI de `rocketpool service config`.
- Navega a la sección `Smartnode and TX Fees`.
- Cambia el `Rewards Tree Mode` de `Download` a `Generate`.
- Si tu cliente de Ejecución principal no es un nodo de archivo, puedes agregar una URL para un nodo de archivo separado en el cuadro `Archive-Mode EC URL`.
  - Esto es necesario para generar árboles de recompensas históricos.
  - El EC de Archivo solo se usará para la generación de árboles; no se usará para ninguna otra tarea del Smartnode.
  - [Infura](https://infura.io/product/ethereum) y [Alchemy](https://www.alchemy.com/supernode) ofrecen acceso a nodos de archivo. **Ten en cuenta que los niveles gratuitos generalmente no son suficientes para manejar la generación de árboles, por lo que necesitarás uno de los niveles pagos.**

Ahora tu Smartnode construirá el árbol completamente independiente del Oracle DAO, usando solo los datos proporcionados por tus clientes de Ejecución y Consenso.
Puedes verlo durante un punto de control de intervalo de recompensas con `rocketpool service logs watchtower`.

Si deseas reconstruir árboles pasados de intervalos anteriores, puedes hacerlo con el siguiente comando:

```shell
rocketpool network generate-rewards-tree
```

Sigue las indicaciones y luego usa `rocketpool service logs watchtower` para ver su progreso.

## Reclamar Recompensas

Para ver tus recompensas pendientes no reclamadas, ejecuta el siguiente comando:

```shell
rocketpool node claim-rewards
```

A medida que pasan los intervalos y acumulas recompensas, la salida se verá así:

<img src={claim_rewards_gb} width="100%" height="auto" />

Aquí puedes ver rápidamente cuántas recompensas has ganado en cada intervalo y puedes decidir cuál(es) deseas reclamar.

También puedes especificar una cantidad que deseas reestaquear durante esta reclamación:

<img src={autostake} width="100%" height="auto" />

Esto te permitirá componer tus recompensas de RPL en una transacción, lo que ahorra en costos de gas.

Simplemente sigue las indicaciones, asegúrate de que tu billetera de nodo tenga suficiente ETH para pagar los costos de gas de reclamar, ¡y listo!
**Tus recompensas se enviarán a tu dirección de retiro.**

::: tip CONSEJO
Para ver las recompensas totales de tu nodo, incluidas las que ya has reclamado, usa el siguiente comando:

```shell
rocketpool node rewards
```

Esto proporcionará un desglose de cuánto RPL y ETH has reclamado hasta ahora, y cuánto aún no se ha reclamado:

```
=== ETH ===
You have earned 8.1935 ETH from the Beacon Chain (including your commissions) so far.
You have claimed 0.0634 ETH from the Smoothing Pool.
You still have 3.4788 ETH in unclaimed Smoothing Pool rewards.

=== RPL ===
The current rewards cycle started on 27 Sep 22 21:26 EDT.
It will end on 30 Sep 22 21:26 EDT (20h35m17s from now).
You currently have 675.616380 unclaimed RPL from staking rewards.

Your estimated RPL staking rewards for this cycle: 36.851544 RPL (this may change based on network activity).
Based on your current total stake of 6615.797278 RPL, this is approximately 67.77% APR.
Your node has received 208.551820 RPL staking rewards in total.

You may claim these rewards at any time. You no longer need to claim them within this interval.
```

:::

## Recompensas de Capa de Ejecución en tu Distribuidor de Tarifas

Si **no** estás incluido en el Smoothing Pool, la porción de Capa de Ejecución de tus recompensas de propuestas de bloque (incluidas las tarifas de transacción y MEV) se enviará al contrato [Distribuidor de Tarifas](./fee-distrib-sp#fee-distributors-and-the-smoothing-pool) de tu nodo en su lugar.

Para verificar el saldo de tu Distribuidor de Tarifas, puedes usar un explorador de cadena como [https://etherscan.io](https://etherscan.io) o simplemente ejecutar `rocketpool node status` - habrá una sección llamada **Fee Distributor and Smoothing Pool** que lo muestra:

```
=== Fee Distributor and Smoothing Pool ===
The node is not opted into the Smoothing Pool.
To learn more about the Smoothing Pool, please visit /es/legacy/redstone/whats-new.html#smoothing-pool.
The node's fee distributor 0xA0bfbFC582f5814585f8455Ed6D7B620eA9a9EE4 has a balance of 1.143598 ETH.
```

### Distribuyendo el Saldo

Para acceder al saldo del Distribuidor de Tarifas, lo **distribuirás** (de ahí el nombre, _Distribuidor de Tarifas_).
Esto calculará tu participación de las recompensas (según la comisión promedio de minipool de tu nodo) y la enviará a la dirección de retiro de tu nodo; el resto se envía al pool de staking.

La distribución se puede hacer **en cualquier momento**.
Puedes mantener el saldo y dejarlo acumular si lo deseas, o distribuirlo regularmente.

Para distribuir el saldo, ejecuta el siguiente comando:

```shell
rocketpool node distribute-fees
```

Esto mostrará cuánto va para ti y cuánto va para el pool de staking:

```
Your node's average commission is 15.00%.
Your fee distributor's balance of 1.143599 ETH will be distributed as follows:
 Your withdrawal address will receive 0.657569 ETH.
 rETH pool stakers will receive 0.486030 ETH.
```

Simplemente confirma el precio de gas que deseas y envía la transacción.
Una vez que se haya completado, tu parte de las recompensas estará disponible en la dirección de retiro de tu nodo.
