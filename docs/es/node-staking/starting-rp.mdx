import { Tab, Tabs } from "@rspress/core/theme";

# Iniciando Rocket Pool

En este punto, deberías tener la infraestructura completa de Rocket Pool funcionando, incluyendo el stack del Smartnode, un cliente de Ejecución y un cliente de Consenso.
También deberías haber endurecido tu sistema operativo contra atacantes externos.
Si has completado ambos pasos, estás listo para crear un nodo de Rocket Pool y comenzar a hacer staking.
Si no, por favor revisa las secciones anteriores y regresa aquí una vez que hayas completado esos pasos.

## Iniciando y Deteniendo los Servicios de Rocket Pool

<div className="p-3">
  <Tabs>
    <Tab label="Modo Docker (Predeterminado)">
      Ahora que tienes el Smartnode instalado, iniciar el stack es fácil.
      Simplemente ingresa el siguiente comando:

      ```shell
      rocketpool service start
      ```

      Este comando creará todas las imágenes de Docker necesarias si aún no existen, se asegurará de que la red docker de Rocket Pool y los volúmenes de almacenamiento hayan sido inicializados, y actualizará cualquier contenedor si ya no coincide con las configuraciones de la interfaz de usuario de `rocketpool service config`.

      La primera vez que lo hagas, la salida debería verse así:

      ```
      $ rocketpool service start

      Creating network "rocketpool_net" with the default driver
      Creating volume "rocketpool_eth1clientdata" with default driver
      Creating volume "rocketpool_eth2clientdata" with default driver
      Creating rocketpool_eth1 ...
      Creating rocketpool_eth1 ... done
      Creating rocketpool_eth2 ...
      Creating rocketpool_api  ...
      Creating rocketpool_api  ... done
      Creating rocketpool_eth2 ... done
      Creating rocketpool_watchtower ...
      Creating rocketpool_mev-boost   ...
      Creating rocketpool_mev-boost   ... done
      Creating rocketpool_node       ...
      Creating rocketpool_validator  ...
      Creating rocketpool_validator  ... done
      Creating rocketpool_node       ... done
      Creating rocketpool_watchtower ... done
      ```

      Si es así, entonces el stack del Smartnode ha sido inicializado exitosamente y ahora está funcionando.

      Si alguna vez necesitas detener los servicios (por ejemplo, durante una actualización o porque necesitas hacer mantenimiento), puedes usar `rocketpool service stop` para apagar todo.
      La salida debería verse así:

      ```
      $ rocketpool service stop

      Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized! [y/n]
      y

      Stopping rocketpool_node       ...
      Stopping rocketpool_validator  ...
      Stopping rocketpool_watchtower ...
      Stopping rocketpool_mev-boost  ...
      Stopping rocketpool_eth2       ...
      Stopping rocketpool_api        ...
      Stopping rocketpool_eth1       ...
      Stopping rocketpool_validator  ... done
      Stopping rocketpool_node       ... done
      Stopping rocketpool_watchtower ... done
      Stopping rocketpool_api        ... done
      Stopping rocketpool_mev-boost  ... done
      Stopping rocketpool_eth2       ... done
      Stopping rocketpool_eth1       ... done
      ```

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Una vez que ejecutes esto, Rocket Pool **no** se iniciará automáticamente después de un reinicio del sistema.
        Tendrás que llamar a `rocketpool service start` para iniciar todos los contenedores de Docker y habilitar el inicio automático al reiniciar nuevamente.
      </p>
    </Tab>
    <Tab label="Modo Híbrido">
      Ahora que tienes el Smartnode instalado, iniciar el stack es fácil.
      Simplemente ingresa el siguiente comando:

      ```shell
      rocketpool service start
      ```

      Este comando creará todas las imágenes de Docker necesarias si aún no existen, se asegurará de que la red docker de Rocket Pool y los volúmenes de almacenamiento hayan sido inicializados, y actualizará cualquier contenedor si ya no coincide con las configuraciones de la interfaz de usuario de `rocketpool service config`.

      La primera vez que lo hagas, la salida debería verse así:

      ```
      $ rocketpool service start

      Creating network "rocketpool_net" with the default driver
      Creating rocketpool_api  ...
      Creating rocketpool_api  ... done
      Creating rocketpool_watchtower ...
      Creating rocketpool_node       ...
      Creating rocketpool_validator  ...
      Creating rocketpool_validator  ... done
      Creating rocketpool_node       ... done
      Creating rocketpool_watchtower ... done
      ```

      Si es así, entonces el stack del Smartnode ha sido inicializado exitosamente y ahora está funcionando.

      Ten en cuenta que tus clientes de Ejecución y/o Consenso externos no se listarán aquí, ya que Rocket Pool no los gestiona y por lo tanto no puede iniciarlos.
      Tendrás que asegurarte de haberlos iniciado por separado, utilizando el mecanismo con el que los creaste originalmente.

      Si alguna vez necesitas detener los servicios (por ejemplo, durante una actualización o porque necesitas hacer mantenimiento), puedes usar `rocketpool service stop` para apagar todo.
      La salida debería verse así:

      ```
      $ rocketpool service stop

      Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized! [y/n]
      y

      Stopping rocketpool_node       ...
      Stopping rocketpool_validator  ...
      Stopping rocketpool_watchtower ...
      Stopping rocketpool_api        ...
      Stopping rocketpool_validator  ... done
      Stopping rocketpool_node       ... done
      Stopping rocketpool_watchtower ... done
      Stopping rocketpool_api        ... done
      ```

      Nuevamente, serás responsable de asegurarte manualmente de que tus clientes de Ejecución y Consenso también se detengan apropiadamente, si deseas que se detengan.

      <p className="rspress-directive tip">
        <p className="rspress-directive-title">NOTA</p>
        Una vez que ejecutes esto, Rocket Pool no se iniciará automáticamente después de un reinicio del sistema.
        Tendrás que llamar a `rocketpool service start` para iniciar todos los contenedores de Docker y habilitar el inicio automático al reiniciar nuevamente.
      </p>

    </Tab>
    <Tab label="Modo Nativo">
      En modo nativo, ya configuraste e iniciaste los servicios del Smartnode como parte de la sección [Configurando un Nodo Rocket Pool Nativo sin Docker](./native).

      Suponiendo que los configuraste como servicios `systemd`, puedes iniciarlos con `sudo systemctl start ...`.
      Por ejemplo, si estás usando Geth para Ejecución y Teku para Consenso:

      ```shell
      sudo systemctl start geth teku-bn teku-vc rp-node rp-watchtower
      ```

      Detenerlos es el mismo proceso, pero usando `sudo systemctl stop ...`.

      Ten en cuenta que detener los servicios **no deshabilita el inicio automático**; los procesos se iniciarán automáticamente después de un reinicio.

    </Tab>

  </Tabs>
</div>

## Confirmando la Versión y Red Correctas

Una vez que los contenedores o servicios estén activos, un buen primer paso es confirmar que tienes las versiones correctas de los clientes y estás en la red que esperas.
Puedes hacer esto con el siguiente comando:

```shell
rocketpool service version
```

La salida se verá así **(ten en cuenta que puedes tener una versión más reciente que la que se muestra aquí, esto es solo un ejemplo)**:

```
Your Smartnode is currently using the Ethereum Mainnet.

Rocket Pool client version: 1.6.4
Rocket Pool service version: 1.6.4
Selected Eth 1.0 client: Geth (Locally managed)
Image: ethereum/client-go:v1.10.25
Selected Eth 2.0 client: Lighthouse (Locally managed)
Image: sigp/lighthouse:v3.1.0
```

La primera línea te dirá si tu Smartnode está configurado para la mainnet de Ethereum o para la testnet Hoodi.

::: warning NOTA
**Para usuarios de Docker / Híbrido:**
Si no estás en la red que esperas, regresa a la sección de Instalación de Rocket Pool y revisa las instrucciones de instalación - es posible que hayas omitido la parte que tiene instrucciones diferentes dependiendo de qué red quieres usar.

**Para usuarios Nativos:**
Si aceptaste la configuración predeterminada cuando ejecutaste `rp service config` por primera vez, entonces es posible que la red reportada aquí sea incorrecta.
Simplemente cámbiala en la TUI de `rp service config`, en la sección `Smartnode`, a la red apropiada y reinicia tus servicios de `node` y `watchtower`.
:::

El segundo conjunto de líneas te dirá qué clientes estás usando y qué versiones de ellos están definidas en la configuración de Rocket Pool.

## Verificando el Estado del Servicio y los Registros

Ahora que los servicios del Smartnode se han iniciado, es una buena idea verificar que estén funcionando correctamente sin errores.

<div className="p-3">
  <Tabs>
    <Tab label="Modo Docker (Predeterminado)">
      Lo primero que debes verificar es si los contenedores de Docker están funcionando bien, o si están constantemente reiniciándose debido a un error.
      Ejecuta el siguiente comando:

      ```shell
      docker ps
      ```

      Los resultados deberían verse así:

      ```
      CONTAINER ID   IMAGE                         COMMAND                  CREATED       STATUS      PORTS                                                                                                         NAMES
      4c1de08a352b   prom/prometheus:v2.37.0       "/bin/prometheus --w…"   9 days ago    Up 9 days   9090/tcp                                                                                                      rocketpool_prometheus
      56940decdd1f   sigp/lighthouse:v2.5.1        "sh /setup/start-bn.…"   9 days ago    Up 9 days   0.0.0.0:9001->9001/tcp, 0.0.0.0:9001->9001/udp, :::9001->9001/tcp, :::9001->9001/udp                          rocketpool_eth2
      bd061e632535   grafana/grafana:8.5.9         "/run.sh"                9 days ago    Up 9 days   3000/tcp, 0.0.0.0:3100->3100/tcp, :::3100->3100/tcp                                                           rocketpool_grafana
      5c4db92762fb   ethereum/client-go:v1.10.21   "sh /setup/start-ec.…"   9 days ago    Up 9 days   8545-8546/tcp, 0.0.0.0:30303->30303/tcp, 0.0.0.0:30303->30303/udp, :::30303->30303/tcp, :::30303->30303/udp   rocketpool_eth1
      e20c560861fc   rocketpool/smartnode:v1.5.0   "/bin/sleep infinity"    9 days ago    Up 9 days                                                                                                                 rocketpool_api
      4cf8d364fb90   rocketpool/smartnode:v1.5.0   "/go/bin/rocketpool …"   9 days ago    Up 9 days                                                                                                                 rocketpool_watchtower
      9eb944c29997   rocketpool/smartnode:v1.5.0   "/go/bin/rocketpool …"   9 days ago    Up 9 days                                                                                                                 rocketpool_node
      2ca5d3dcb471   sigp/lighthouse:v2.5.1        "sh /setup/start-vc.…"   9 days ago    Up 9 days                                                                                                                 rocketpool_validator
      dedc577fe361   prom/node-exporter:v1.3.1     "/bin/node_exporter …"   2 weeks ago   Up 9 days                                                                                                                 rocketpool_exporter
      ```

      Lo clave a verificar es la columna `STATUS`.
      Si ninguna de las entradas dice `Restarting...`, entonces los contenedores deberían estar funcionando correctamente (ver la nota a continuación para una excepción sobre el contenedor `rocketpool_validator`).


      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Si estás usando Prysm o Lodestar como tu cliente de Consenso, probablemente notarás que el contenedor `rocketpool_validator` está constantemente reiniciándose.
        ¡Esto está bien!
        El contenedor del validador fallará hasta que se haya creado un nuevo validador usando el comando `rocketpool node deposit`, que cubriremos en la sección [Creando un Minipool (Validador)](./create-validator).
        Una vez que esto se haga, el contenedor funcionará correctamente - hasta entonces, simplemente ignóralo.
      </p>

      Aún así, puede ser útil verificar los registros de los diversos servicios.

      Para verificar los registros, usa el comando `rocketpool service logs container`, donde `container` es uno de `eth1`, `eth2`, `validator`, `api`, `node`, o `watchtower`.

      Por ejemplo, para verificar los registros de tu cliente ETH1:

      ```
      $ rocketpool service logs eth1

      Attaching to rocketpool_eth1
      eth1_1        | INFO [06-17|05:17:19.052] Imported new block receipts              count=25   elapsed=26.651ms    number=247,000   hash=6583ec..35eb1c age=2y3mo2w  size=15.72KiB
      eth1_1        | INFO [06-17|05:17:19.098] Imported new block headers               count=192  elapsed=18.515ms    number=247,551   hash=b7d5e4..d49faf age=2y3mo2w
      eth1_1        | INFO [06-17|05:17:19.334] Imported new block receipts              count=371  elapsed=46.450ms    number=247,371   hash=dd3240..1ed173 age=2y3mo2w  size=266.59KiB
      eth1_1        | INFO [06-17|05:17:19.354] Imported new state entries               count=1271 elapsed=2.866ms     processed=374,695 pending=3134  trieretry=0   coderetry=0  duplicate=0 unexpected=0
      eth1_1        | INFO [06-17|05:17:19.441] Imported new block headers               count=384  elapsed=35.331ms    number=247,935   hash=4c4dba..5bf8b6 age=2y3mo2w
      eth1_1        | INFO [06-17|05:17:19.460] Imported new block receipts              count=180  elapsed=33.648ms    number=247,551   hash=b7d5e4..d49faf age=2y3mo2w  size=128.73KiB
      eth1_1        | INFO [06-17|05:17:19.480] Imported new block headers               count=192  elapsed=19.122ms    number=248,127   hash=aa70b9..40d139 age=2y3mo1w
      eth1_1        | INFO [06-17|05:17:19.486] Imported new block receipts              count=6    elapsed=26.042ms    number=247,557   hash=fd6656..ca2439 age=2y3mo2w  size=3.77KiB
      ```

      Deberías hacer esto tanto para `eth1` como para `eth2` para asegurarte de que ambos clientes se estén ejecutando sin errores.
    </Tab>
    <Tab label="Modo Híbrido">
      Lo primero que debes verificar es si los contenedores de Docker están funcionando bien, o si están constantemente reiniciándose debido a un error.
      Ejecuta el siguiente comando:

      ```shell
      docker ps
      ```

      Los resultados deberían verse así:

      ```
      CONTAINER ID   IMAGE                               COMMAND                  CREATED       STATUS         NAMES
      a3c22f54eff0   rocketpool/smartnode:v1.0.0-rc3     "/go/bin/rocketpool …"   2 hours ago   Up 2 minutes   rocketpool_node
      0d5818868ef6   sigp/lighthouse:v1.4.0              "sh /setup/start-val…"   2 hours ago   Up 2 minutes   rocketpool_validator
      88bea525fa89   rocketpool/smartnode:v1.0.0-rc3     "/go/bin/rocketpool …"   2 hours ago   Up 2 minutes   rocketpool_watchtower
      62314e5a0ecf   rocketpool/smartnode:v1.0.0-rc3     "/bin/sleep infinity"    2 hours ago   Up 2 minutes   rocketpool_api
      ```

      Lo clave a verificar es la columna `STATUS`.
      Si ninguna de las entradas dice `Restarting...`, entonces los contenedores deberían estar funcionando correctamente (ver la nota a continuación para una excepción sobre el contenedor `rocketpool_validator`).

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Si estás usando **Lodestar** o **Prysm** como tu cliente de Consenso, probablemente notarás que el contenedor `rocketpool_validator` está constantemente reiniciándose.
        ¡Esto está bien!
        El contenedor del validador fallará hasta que se haya creado un nuevo validador usando el comando `rocketpool node deposit`, que cubriremos en la sección [Creando un Minipool (Validador)](./create-validator).
        Una vez que esto se haga, el contenedor funcionará correctamente - hasta entonces, simplemente ignóralo.
      </p>

      Aún así, puede ser útil verificar los registros de los diversos servicios.

      Para verificar los registros, usa el comando `rocketpool service logs container`, donde `container` es uno de `eth1`, `eth2`, `validator`, `api`, `node`, o `watchtower`.

      Puedes ignorar `eth1` y/o `eth2` según cuáles estés manteniendo externamente, pero si estás dejando que Rocket Pool gestione uno de ellos, deberías verificar su estado ahora usando este comando.
    </Tab>
    <Tab label="Modo Nativo">
      La forma más fácil de verificar el estado y los registros en modo nativo es usar los scripts de registro que creaste cuando configuraste por primera vez los servicios del Smartnode.

      Por ejemplo, para verificar el registro de Geth, simplemente ejecutarías:

      ```shell
      /srv/geth/log.sh
      ```

      Deberías ver que está avanzando lentamente sin errores.
      Haz esto para tus clientes de Ejecución y Consenso ahora para verificar que estén funcionando correctamente.
    </Tab>

  </Tabs>
</div>

::: tip CONSEJO
Cuando hayas terminado de ver los registros, puedes salir y volver al símbolo del sistema usando `Ctrl + C`.
:::

## Esperando a que tus Clientes ETH se Sincronicen

Ahora que tus clientes se han iniciado, vas a querer esperar hasta que tus clientes de Ejecución y Consenso hayan terminado de sincronizarse con la red antes de continuar.

Una forma fácil de verificar su estado es con el siguiente comando:

```shell
rocketpool node sync
```

Este comando mostrará qué tan avanzados están tus clientes de Ejecución y Consenso en el proceso de sincronización, similar a esto:

```shell
$ rocketpool node sync

Your Smartnode is currently using the Hoodi Test Network.

Your eth2 client is on the correct network.

Your primary execution client is fully synced.
You do not have a fallback execution client enabled.
Your consensus client is still syncing (99.69%).
```

Puedes llamar a esto ocasionalmente para seguir el progreso de tus clientes.

Para obtener un ETA real del tiempo de sincronización, es más fácil mirar los registros de tus clientes con `rocketpool service logs eth1` y `rocketpool service logs eth2` respectivamente (o los comandos de script de registro equivalentes si estás usando los modos híbrido / nativo).
Cada cliente típicamente proporciona un ETA sobre su estado de sincronización en su salida de registro.

::: tip NOTA
Puede tomar **días** sincronizar completamente tanto ETH1 como ETH2 dependiendo de la selección de tu cliente y el perfil de hardware de tu máquina.
**Esto es esperado**.
Relájate y espera a que ambos terminen.
:::

::: warning NOTA
Si tu nodo no se está sincronizando en absoluto o no tiene pares, puede ser porque tu router está bloqueando los puertos 30303 y 9001. Si están cerrados, necesitarás configurar el reenvío de puertos en tu router. Además, asegúrate de que tu nodo tenga una dirección IP local estática para que el reenvío de puertos no se rompa debido a que tu nodo obtenga una nueva dirección.
:::

## Próximos Pasos

Una vez que tus clientes se hayan sincronizado, estás listo para [crear una nueva billetera](./wallet-init) si este es tu primer nodo, o [recuperar una billetera existente](./recovering-rp) si estás restaurando desde una copia de seguridad o migrando desde otro proveedor como Allnodes a tu propio hardware.

Selecciona cuál te gustaría aprender más y sigue los pasos en la guía correspondiente.
