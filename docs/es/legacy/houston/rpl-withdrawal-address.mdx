import { Tab, Tabs } from "@rspress/core/theme";
import nodeAddress from "./images/node_address.png";
import rplWithdrawalConfirmation from "./images/rpl_withdrawal_confirmation.png";

# Establecer tu Dirección de Retiro de RPL

Es importante entender la diferencia entre tu [dirección de retiro primaria](../../node-staking/prepare-node#setting-your-primary-withdrawal-address) y tu dirección de retiro de RPL. Por defecto, tu dirección de retiro de RPL no está configurada y tu dirección de retiro primaria es donde se enviarán todas tus recompensas de checkpoint de RPL, tu RPL stakeado y el ETH de la Beacon Chain.

Puedes establecer una [dirección de retiro separada para tu RPL](https://rpips.rocketpool.net/RPIPs/RPIP-31) si lo deseas. Tu dirección de retiro de RPL, si está configurada, podrá activar y reclamar RPL de las recompensas de inflación y no tendrá efecto en las recompensas de consenso de ETH o cualquier cosa relacionada con ETH. En este caso, tu dirección de retiro primaria ya no tendrá ninguna autoridad sobre acciones relacionadas con RPL.

Esto crea algunas oportunidades interesantes donde el RPL puede ser suministrado por una entidad a un operador de nodo que no desea tener exposición a RPL. Esa entidad puede entonces reclamar recompensas de RPL por proporcionar el colateral de seguro requerido para el nodo. En otras palabras, esto permite que diferentes actores suministren cada tipo de colateral.

::: warning NOTA
Al configurar tu nodo por primera vez, tu dirección de retiro de RPL no está configurada por defecto.
Si eliges establecer una dirección de retiro de RPL, **es vitalmente importante establecerla en una dirección diferente controlada por una wallet fría.**
Una wallet fría podría ser una wallet de hardware (como un [Ledger](https://www.ledger.com/), [Trezor](https://trezor.io/), o [Grid+](https://gridplus.io/)), o una wallet de Smart Contract (como [Safe](https://app.safe.global/welcome)).

**Recomendamos encarecidamente** que NO uses una wallet caliente como MetaMask como tu dirección de retiro de RPL.

De esta manera, si tu wallet de nodo se ve comprometida, el atacante no tiene acceso a tu RPL stakeado forzándote a salir porque todos esos fondos se enviarán a tu wallet fría separada (que esperamos que no tengan).

Las direcciones de retiro de RPL se establecen a nivel de operador de nodo.
Si creas múltiples minipools, todos se referirán a la misma dirección de retiro de RPL, por lo que solo necesitas realizar esta configuración una vez.

[Ve aquí](https://ethereum.org/en/security/#wallet-security) para algunos conceptos básicos sobre seguridad de wallets de la Fundación Ethereum.
:::

Hay dos formas diferentes de hacer esto.
Por favor lee ambas opciones a continuación para determinar cuál se aplica a ti.

<div className="p-3">
  <Tabs>
    <Tab label="Método 1">
      *Usa este método si tu nueva dirección de retiro de RPL puede ser usada para firmar transacciones a través de MetaMask o WalletConnect.**

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Este método requerirá que **envíes una transacción** desde tu nueva dirección de retiro de RPL, por lo que **debes tener una pequeña cantidad de ETH en esa dirección ya.**
      </p>

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOTA</p>
        Para usuarios de wallets de hardware **Ledger**, ten en cuenta que Ledger Live aún no admite MetaMask o WalletConnect de forma nativa.
        Necesitarás usar MetaMask y conectarlo a tu Ledger en su lugar.
        Sigue [las instrucciones oficiales de Ledger](https://www.ledger.com/academy/security/the-safest-way-to-use-metamask) para hacer esto.

        Para trabajar con el sitio web de Rocket Pool, necesitarás tener tu Ledger conectado, desbloqueado y la aplicación ETH abierta.
        También necesitarás **habilitar "blind signing"** para la sesión actual; puedes encontrar esto dentro de la porción de Configuración de la aplicación ETH en el dispositivo.
        El blind signing se deshabilitará automáticamente después de cerrar la sesión.

        Si estás usando Hoodi Testnet y quieres usar tu Ledger como tu dirección de retiro de RPL, **primero debes crear una nueva wallet de Ethereum en tu Ledger** para asegurarte de que no conectas tu dirección real a la red de prueba, lo que tiende a causar confusión.
        Asegúrate de seleccionar la **Hoodi Testnet** en el menú desplegable de selección de red al conectar tu Ledger a MetaMask.
        Ten en cuenta que Ledger Live no mostrará tu saldo en la red de prueba, pero otras aplicaciones que admiten la red de prueba (como MetaMask y Etherscan) podrán mostrarlo.
      </p>

      1. Ejecuta `rocketpool node set-rpl-withdrawal-address 'tu dirección de wallet fría o nombre ENS'`. Tu nueva dirección de retiro de RPL se marcará como "pendiente". Hasta que la confirmes, **tu antigua dirección de retiro de RPL seguirá siendo usada**.
      2. Para confirmarla, debes enviar una transacción especial **desde tu nueva dirección de retiro de RPL** al contrato del minipool para verificar que posees la dirección de retiro de RPL.
      1. La forma más fácil de hacer esto es navegar al sitio de dirección de retiro de RPL de Rocket Pool (para la [Hoodi Testnet](https://testnet.node.rocketpool.net/rpl-withdrawal-address) o para [Mainnet](https://node.rocketpool.net/rpl-withdrawal-address)).
      3. Si aún no has conectado Metamask o WalletConnect al sitio web de Rocket Pool, hazlo ahora. Haz clic en el botón **seleccionar wallet** en el centro de la pantalla y elige MetaMask o WalletConnect según qué wallet te gustaría usar. Luego se te pedirá que confirmes la conexión. Por ejemplo, usando MetaMask:

      Haz clic en **Next**, luego haz clic en **Confirm** para permitir que el sitio web de Rocket Pool use tu wallet. 3. Selecciona **RPL Withdrawal Address** del menú superior (o el menú de hamburguesa en el lado izquierdo si estás en un dispositivo móvil). 4. Verás este aviso:

      4. Escribe tu **dirección de wallet de nodo** aquí y haz clic en el botón naranja **Find** para continuar.

      <img src={nodeAddress} width="100%" height="auto"/>

      1.  Se te pedirá confirmar una dirección de retiro de RPL pendiente. Esta debe ser la misma dirección que usaste al ejecutar este comando previamente: `rocketpool node set-rpl-withdrawal-address` Selecciona **Confirm Pending** cuando estés listo.
      2.  Ahora, debería haber un nuevo diálogo de confirmación en tu wallet. Nuevamente, usando MetaMask como ejemplo, haz clic en el ícono de MetaMask para abrirlo y deberías ver algo como esto:

      Haz clic en **Confirm** para enviar la transacción a la red. Esto tomará algo de tiempo hasta que se incluya en un bloque, pero una vez que lo haga, verás un diálogo de confirmación:

      <img src={rplWithdrawalConfirmation} width="100%" height="auto"/>

      5. Tu nueva dirección de retiro de RPL ahora estará confirmada y activada. Puedes ver esto con `rocketpool node status`.
    </Tab>
    <Tab label="Método 2">
      **Usa este método solo si tu dirección de retiro de RPL _no puede_ ser usada para firmar transacciones a través de MetaMask o WalletConnect.**

      En este método, ejecutarás:

      ```shell
      rocketpool node set-rpl-withdrawal-address --force `tu dirección de wallet fría`
      ```

      Se te ofrecerá la oportunidad de enviar una transacción de prueba antes de confirmar esto, para asegurarte de que tienes la dirección correcta.
      Si confirmas este comando cuando te lo pida, tu nueva dirección de retiro de RPL se establecerá inmediatamente.


      <p className="rspress-directive danger">
        Al hacer esto, evitas la medida de seguridad asociada con el Método 1, que requiere que demuestres que posees la nueva dirección.
        Si cometes un error tipográfico aquí, no hay forma de deshacerlo y **las recompensas de tu minipool se perderán para siempre**.

        **Recomendamos encarecidamente** que uses el mecanismo de transacción de prueba antes de confirmar esto, y si es posible, usa el Método 1 en su lugar.
      </p>
    </Tab>

  </Tabs>
</div>

Una vez que esto esté hecho, **ya no podrás cambiar tu dirección de retiro de RPL usando el comando `set-rpl-withdrawal-address`**.
Para cambiarla, necesitarás enviar una transacción firmada desde tu dirección de retiro de RPL **activa** (a la que acabas de cambiar).
El sitio web de Rocket Pool tiene una función para ayudarte a hacer esto.

Si deseas dejar sin configurar tu dirección de retiro de RPL, el proceso es bastante simple. Lo primero que querrás hacer es navegar de vuelta a la página de Dirección de Retiro de RPL en el sitio web de Rocket Pool.

<div className="p-3">
  <Tabs>
    <Tab label="Hoodi Testnet">https://testnet.node.rocketpool.net/rpl-withdrawal-address</Tab>
    <Tab label="Mainnet">https://node.rocketpool.net/rpl-withdrawal-address</Tab>
  </Tabs>
</div>

Si has iniciado sesión con la dirección de retiro de RPL del nodo, deberías poder hacer clic en el botón **unset** a la derecha aquí:

<img src="./images/unset_rpl_withdrawal.png" width="100%" height="auto" />

Hacer clic en **unset** te llevará a una página donde puedes confirmar los detalles. Si estás satisfecho con lo que ves, haz clic en el botón naranja **unset** para enviar la transacción a la red.

¡Eso es todo lo que hay sobre establecer tu dirección de retiro de RPL! Esperamos que hayas encontrado el proceso rápido y fácil.

Siéntete libre de pasar por [nuestro servidor de Discord](https://discord.gg/G46XgK264a) para hacernos saber qué pensaste de ello y estar al tanto del proyecto a medida que evoluciona.
