import proposal_diagram from "./images/proposal_diagram.png";
import proposal_checker from "./images/proposal_checker.png";

# Die Protocol DAO (pDAO)

Die Rocket Pool Protocol DAO (pDAO) ist verantwortlich für die Gestaltung der Richtung des Protokolls und wird durch RPL Governance geleitet. Ihre Mitglieder und deren Stimmkraft bestehen aus Node Operators, groß und klein, die alle direkt am Protokoll teilnehmen. Sie dient der gesamten Rocket Pool Community, einschließlich rETH Inhabern, Node Operators und RPL Inhabern. Die pDAO priorisiert die Sicherheit des Rocket Pool Protokolls und die Gesundheit des Ethereum Netzwerks. Für eine explizite Definition dessen, wer und was die pDAO ist, schauen Sie sich gerne die [pDAO Charta](https://rpips.rocketpool.net/RPIPs/RPIP-23) an.

## Neue pDAO Funktionen in Houston

### On-chain Ausführung von pDAO Verantwortlichkeiten

Das Houston Upgrade führt einen on-chain Ersatz für den Ausführungsprozess des pDAO Governance-Systems ein. Es verwendet ein optimistisches Betrugsbeweis-System, das es jedem Node Operator ermöglicht, Vorschläge einzureichen und über Vorschläge abzustimmen, um "pDAO Protokollparameter" anzupassen und Treasury-Mittel auszugeben. Um eine umfassende Liste von pDAO kontrollierbaren Parametern zu sehen, klicken Sie [hier](https://rpips.rocketpool.net/RPIPs/RPIP-33#parameter-table).
Vor Houston war das Kernteam verantwortlich für die Ausführung von pDAO Aufgaben im Auftrag des Community-Governance-Prozesses. Zum Beispiel führt das Team die monatlichen IMC und GMC Zahlungen gemäß den durch Governance abgestimmten Zahlungsplänen durch. Der Plan war, dass diese Macht vorübergehend beim Team verbleibt, bis eine neue Machtstruktur eingerichtet wird, um diese Verantwortlichkeiten zu übernehmen. Houston entfernt diese Abhängigkeit vom Team und macht das Protokoll dezentraler und vertrauensloser.

### Security Council

Das Houston Upgrade beinhaltet auch einen neuen Security Council, um im Falle potenzieller Probleme mit dem Protokoll schnell reagieren zu können. Diese Mitglieder können von der pDAO gewählt werden und haben die Fähigkeit, Änderungen ohne Verzögerung vorzuschlagen und auszuführen. Die pDAO hat die Macht, Mitglieder aus dem Security Council zu wählen und zu entfernen. Es ist eine ernste Rolle und die pDAO sollte starke Eintrittskriterien und Prozesse entwickeln, um veraltete Mitglieder zu entfernen. Der pDAO Guardian wird zu Beginn von Houston das einzige Mitglied des Security Council sein.

### Wiederkehrende Treasury-Ausgaben

RPL hat eine Inflationsrate von 5%. 22% dieser Inflation werden an die pDAO geleitet, wie in [RPIP-25](https://rpips.rocketpool.net/RPIPs/RPIP-25) definiert. Die pDAO kann diese Mittel für verschiedene Zwecke verwenden. Zum Beispiel Anreize wie Liquidity Provider (LP) Boni, Zuschüsse und Prämien für Verbesserungen und Projekte von Drittanbietern sowie Finanzierung der Entwicklung des Rocket Pool Protokolls. Das Houston Upgrade führt auch eine neue Funktion ein, die wiederkehrende Treasury-Zahlungen ermöglicht, die an einen bestimmten Begünstigten in jeder Belohnungsperiode geleistet werden.

## Protocol DAO (pDAO) Vorschläge

Jeder Knoten mit einer Stimmkraft ungleich Null kann jederzeit einen pDAO Vorschlag einreichen oder daran teilnehmen. Vorschläge können einen der folgenden Typen haben:

- Änderung von pDAO Einstellungen
- Einmalige Treasury-Ausgaben
- Wiederkehrende Treasury-Ausgaben (Verwaltungsausschüsse)
- Security Council Mitgliedschaft

Für weitere Details und Begründungen siehe [Vorschlagstypen](https://rpips.rocketpool.net/RPIPs/RPIP-33#proposal-types). Es ist wichtig zu verstehen, dass ein pDAO Vorschlag eine on-chain Entität ist, die existiert, um Änderungen auf Protokollebene auszuführen.

## Lebenszyklus eines pDAO Vorschlags

Ein Vorschlag sollte durch den [Governance-Prozess](./participate#governance-process) angekündigt werden, bevor er on-chain endet. Er besteht aus 4 Perioden, die alle pDAO [kontrollierbare Parameter](https://rpips.rocketpool.net/RPIPs/RPIP-33#parameter-table) sind:

- Vote Delay Period: `proposal.vote.delay.time`
- Vote Phase 1: `proposal.vote.phase1.time`
- Vote Phase 2: `proposal.vote.phase2.time`
- Execution: `proposal.execute.time	`

<img src={proposal_diagram} width="100%" height="auto" />

### Vote Delay Period

Um über das Ergebnis eines Vorschlags zu entscheiden, muss das Protokoll das erforderliche Quorum kennen. Ein Proposer berechnet diesen Wert off-chain und reicht ihn zusammen mit seinem Vorschlag ein. Der Wert wird optimistisch akzeptiert, aber im Falle von Betrug können Verifizierer einen Challenge/Response-Prozess durchführen, um zu beweisen, dass der Wert falsch ist. Ungültige Vorschläge werden dann verworfen.

Einige Gründe, warum Proposer und Challengers RPL sperren müssen:

- `proposal.bond` incentiviert gültige Vorschläge und wirkt Spam entgegen.
- `proposal.challenge.bond` incentiviert die Niederschlagung ungültiger/böswilliger Vorschläge.

Challengers liefern einen Index in den Merkle-Summen-Baum, von dem sie behaupten, dass er falsch ist. Jeder Node Operator kann an der Anfechtung betrügerischer Vorschläge teilnehmen (und dabei eine Belohnung verdienen). Lesen Sie gerne über den [pDAO Challenge Process](./pdao#challenge-process), wenn Sie daran interessiert sind, sich anzumelden. Ein Vorschlag, der am Ende der Vote Delay Period nicht durch eine Challenge besiegt wurde, tritt in die Abstimmungsphasen ein.

::: tip HINWEIS
Wenn `proposal.vote.delay.time` abläuft, kann der Vorschlag nicht mehr angefochten oder besiegt werden.
:::

### Vote Period 1

Während einer Abstimmungsperiode können Node Operators und Delegates mit einer von vier Optionen abstimmen:

```
1. Abstain: Die Stimmkraft des Voters trägt zum Quorum bei, ist aber weder für noch gegen den Vorschlag.
2. For: Der Voter stimmt für die Ausführung des Vorschlags.
3. Against: Der Voter stimmt gegen die Ausführung des Vorschlags.
4. Veto: Der Voter stimmt gegen den Vorschlag und zeigt an, dass er den Vorschlag als Spam oder böswillig betrachtet.
```

Ihre Stimmkraft wird in die Option ihrer Wahl einbezogen.

Dies kann mit dem Befehl durchgeführt werden:

```shell
rocketpool pdao proposals vote
```

Wenn das Veto-Quorum (wie durch den Parameter `proposal.veto.quorum` definiert) erreicht wird, wird der Vorschlag sofort besiegt und der Proposer verliert seine Bindung. Dies soll Spam, qualitativ minderwertige Vorschläge oder Vorschläge abschrecken, die nicht zuerst off-chain Prozesse durchlaufen haben. Der Smartnode-Befehl `rocketpool pdao proposals finalize` wird verwendet, um einen mit Veto belegten Vorschlag zu finalisieren, indem die gesperrte RPL Bindung des Proposers verbrannt wird.

Die Dauer von Periode 1 wird durch den Parameter `proposal.vote.phase1.time` bestimmt. Der Vorschlag geht in Phase 2 über, unabhängig davon, ob `proposal.quorum` erreicht wird oder nicht.

### Vote Period 2

Delegates können während der Vote Period 2 abstimmen, aber ihre Stimme ist nur ihre **lokale Stimmkraft** wert. Voters, die in Periode 1 nicht abgestimmt haben, können während Periode 2 noch eine Stimme abgeben. Node Operators, die mit der Wahl ihres Delegierten nicht einverstanden sind, haben die Gelegenheit, die Stimme ihres Delegierten zu überstimmen.

Der Prozess der Überstimmung ist ziemlich einfach, rufen Sie einfach `rocketpool pdao proposals vote` während der Vote Period 2 auf und folgen Sie den Eingabeaufforderungen. Die Stimmkraft des Delegierten wird durch die Stimmkraft des Delegierenden überstimmt.

Das Ergebnis eines Vorschlags wird abgeschlossen, wenn Vote Period 2 vorbei ist. Damit ein Ergebnis bestimmt (und ausgeführt) werden kann, muss `proposal.quorum` Gesamtstimmkraft bis zum Ende von `proposal.vote.phase2.time` erreicht werden. Wenn das Quorum erreicht wird und Konsens erzielt wird, wird der Vorschlag die Abstimmungsperioden bestehen und als erfolgreich markiert werden.

::: tip HINWEIS
Es können keine weiteren Aktionen durchgeführt werden, wenn `proposal.quorum` nicht erreicht wird. Ein Vorschlag gilt als abgeschlossen und endgültig, wenn das Quorum nicht erreicht wird.
:::

### Ausführung

Sobald beide Abstimmungsperioden vergangen sind und der Vorschlag erfolgreich ist, kann der Vorschlag ausgeführt werden und die Änderung (definiert durch die Payload) wird auf das Rocket Pool Protokoll angewendet. Um einen Vorschlag auszuführen, verwenden Sie den Befehl:

```shell
rocketpool pdao proposals execute
```

Sie werden aufgefordert, einen Vorschlag zur Ausführung auszuwählen, der Vorschlag wird nach diesem Schritt auf das Protokoll angewendet!

Nachdem der Vorschlag die Abstimmungsperioden bestanden hat, kann der Proposer seine gesperrte RPL Bindung [anfordern](./participate#claiming-bonds-and-rewards), es sei denn, der Vorschlag wurde durch eine Challenge besiegt oder mit Veto belegt.

::: tip HINWEIS
Es gibt ein Zeitfenster `proposal.execute.time`, in dem ein Vorschlag ausgeführt werden kann. Ein Vorschlag läuft ab, wenn dieser Timer sein Ende erreicht.
:::

Und das war's! Beachten Sie, dass alle oben genannten Variablen pDAO kontrollierbare Parameter sind. Klicken Sie [hier](https://rpips.rocketpool.net/RPIPs/RPIP-33#parameter-table) für eine umfassende Liste aller Parameter, die die pDAO mit on-chain Vorschlägen ändern kann.

## Challenge Process

Der vollständige Netzwerk-Abstimmungskraft-Baum wird aufgrund von Gas-Limits off-chain gespeichert. Wenn ein Benutzer einen neuen Vorschlag einreicht, ist er dafür verantwortlich, den Netzwerk-Abstimmungsbaum zur Ziel-Blocknummer zu konstruieren. Dieser Baum wird off-chain generiert, ist aber über Merkle-Wurzeln verifizierbar, die on-chain eingereicht werden. Das Protokoll verlässt sich auf **Verifizierer**, um die vom Proposer eingereichten Details zu überprüfen.

Jeder Knoten kann an der Verfolgung und Verifizierung der Korrektheit von Vorschlägen teilnehmen. Um sich für diese Verantwortung anzumelden, verwenden Sie den Befehl `rocketpool service config`, navigieren Sie zum Menü **Smartnode and TX Fee Settings** und aktivieren Sie das Kontrollkästchen `Enable PDAO Proposal Checker`.

<img src={proposal_checker} width="100%" height="auto" />

Wenn diese Einstellung aktiviert ist, überprüft der Knoten auf neue Vorschläge, verifiziert deren Korrektheit und reicht Challenges gegen ungültige Vorschläge ein. Die einzige Voraussetzung ist, dass [RPL Locking](./participate#allowing-rpl-locking) aktiviert ist.

Diese Überprüfung läuft alle 5 Minuten in Verbindung mit einigen anderen knotenbezogenen Aufgaben. Wir werden ein Beispiel durchgehen, wie die Anfechtung eines betrügerischen Vorschlags aussieht. Wir können den Smartnode-Befehl `rocketpool service logs node` verwenden, um den Fortschritt zu überwachen:

```
rocketpool_node  | 2024/04/05 02:19:16 Checking for Protocol DAO proposal challenges to defend...
rocketpool_node  | 2024/04/05 02:19:26 Checking for Protocol DAO proposals to challenge...
rocketpool_node  | 2024/04/05 02:19:26 [Network Tree] Couldn't load network tree for block 1283202 from disk, so it must be regenerated.
rocketpool_node  | 2024/04/05 02:19:26 [PDAO Proposals] Network tree for block 1283202 didn't exist, creating one.
rocketpool_node  | 2024/04/05 02:19:26 [Voting Info Snapshot] Couldn't load network tree for block 1283202 from disk, so it must be regenerated.
rocketpool_node  | 2024/04/05 02:19:26 [PDAO Proposals] Voting info snapshot for block 1283202 didn't exist, creating one.
rocketpool_node  | 2024/04/05 02:19:26 Proposal 177 does not match the local tree artifacts and must be challenged.
rocketpool_node  | 2024/04/05 02:19:26 [Voting Info Snapshot] Loaded file [vi-1283202.json.zst].
rocketpool_node  | 2024/04/05 02:19:26 [Network Tree] Loaded file [network-tree-1283202.json.zst].
rocketpool_node  | 2024/04/05 02:19:26 Submitting challenge against proposal 177, index 5...
rocketpool_node  | 2024/04/05 02:19:26 This transaction will use a max fee of 16.067134 Gwei, for a total of up to 0.003252 - 0.004878 ETH.
rocketpool_node  | 2024/04/05 02:19:26 Transaction has been submitted with hash 0x327e59e398bf2141a0d9273947d1da5c255606c45afaca428ab092186300eac2.
rocketpool_node  | 2024/04/05 02:19:26 You may follow its progress by visiting:
rocketpool_node  | 2024/04/05 02:19:26 https://holesky.etherscan.io/tx/0x327e59e398bf2141a0d9273947d1da5c255606c45afaca428ab092186300eac2

```

Wir können sehen, dass unser Knoten einen betrügerischen Vorschlag erwischt hat und den Prozess der Anfechtung gestartet hat. Block `1283202` ist der Block, in dem Vorschlag 177 eingereicht wurde, was bedeutet, dass die Stimmkraft für diesen Vorschlag bei Block `1283202` berechnet wird. Wenn Sie daran interessiert sind zu sehen, wie diese **Voting Info Snapshots** aussehen, finden Sie sie in diesem Verzeichnis: `~/.rocketpool/data/voting`

Da der Proposer beim Einreichen falscher Abstimmungsinformationen erwischt wurde, führt unser Knoten einen Vertragsaufruf `Function: createChallenge` auf Vorschlag 177 bei Index 5 durch und wartet darauf, dass der Proposer auf die Challenge antwortet.

```
rocketpool3_node  | 2024/04/05 02:56:51 Checking for Protocol DAO proposal challenges to defend...
rocketpool3_node  | 2024/04/05 02:57:01 Checking for Protocol DAO proposals to challenge...
rocketpool3_node  | 2024/04/05 02:57:01 [Network Tree] Loaded file [network-tree-1283202.json.zst].
rocketpool3_node  | 2024/04/05 02:57:01 Proposal 177 does not match the local tree artifacts and must be challenged.
rocketpool3_node  | 2024/04/05 02:57:01 [Voting Info Snapshot] Loaded file [vi-1283202.json.zst].
rocketpool3_node  | 2024/04/05 02:57:01 [Network Tree] Loaded file [network-tree-1283202.json.zst].
rocketpool3_node  | 2024/04/05 02:57:01 Proposal 177 has been defeated with node index 20, submitting defeat...
rocketpool3_node  | 2024/04/05 02:57:01 This transaction will use a max fee of 19.078965 Gwei, for a total of up to 0.002061 - 0.003091 ETH.
rocketpool3_node  | 2024/04/05 02:57:01 Transaction has been submitted with hash 0x8cc01dff37205dc98e53f4e9fae7f3c802ecc1c69a01f53e734115a73401287e.
rocketpool3_node  | 2024/04/05 02:57:01 You may follow its progress by visiting:
rocketpool3_node  | 2024/04/05 02:57:01 https://holesky.etherscan.io/tx/0x8cc01dff37205dc98e53f4e9fae7f3c802ecc1c69a01f53e734115a73401287e
rocketpool3_node  |
rocketpool3_node  | 2024/04/05 02:57:01 Waiting for the transaction to be validated...
rocketpool3_node  | 2024/04/05 02:57:13 Successfully defeated proposal.
```

Da die Abstimmungsinformationen des Proposers falsch sind, kann er nicht rechtzeitig auf die Challenge antworten (bestimmt durch `proposal.challenge.period`). Der Vorschlag gilt an diesem Punkt als besiegt. Wenn der Vorschlag besiegt ist, führt unser Knoten automatisch den Vertragsaufruf `defeatProposal` auf Vorschlag 177 bei Index 5 aus, um den Vorschlag zu beenden.

::: tip HINWEIS
Challengers, die an der Niederschlagung des Vorschlags teilnehmen, erhalten einen proportionalen Anteil der Bindung des Proposers, wenn sie einen Index einreichen, der als falsch nachgewiesen wurde. Alle anderen Challengers erhalten nur ihre Bindung zurück.
:::

Jetzt, da der Vorschlag besiegt ist, kann unser Knoten (der Challenger) seine ursprüngliche RPL Bindung sowie die RPL Bindung des Proposers als Belohnung für die Niederschlagung eines betrügerischen Vorschlags [anfordern](./participate#claiming-bonds-and-rewards).

Wenn Sie neugierig sind, sich mit den Details des pDAO Vorschlags- und Challenge-Systems zu befassen, schauen Sie sich die [technischen Spezifikationen](https://github.com/rocket-pool/rocketpool-research/blob/houston/Protocol%20DAO/pdao-prop-challenge-spec.md#draft-protocol-dao-proposal-challenge-system-specification) an. Sie können gerne zu diesem Abschnitt über den [Challenge Process](https://github.com/rocket-pool/rocketpool-research/blob/houston/Protocol%20DAO/pdao-prop-challenge-spec.md#challenge-process) springen, wenn Sie daran interessiert sind, ein Beispiel zu studieren, das in Details auf niedriger Ebene geht.
