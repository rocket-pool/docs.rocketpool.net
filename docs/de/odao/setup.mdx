import { Tab, Tabs } from "@rspress/core/theme";
import tuiOdao from "./images/tui-odao.png";

# Einrichten eines Oracle DAO Nodes

Als absolutes Minimum läuft ein Standard-Rocket Pool Node Folgendes:

- Die Smartnode-CLI
- Den Smartnode-API-Daemon
- Den Smartnode-`node`-Daemon
- Den Smartnode-`watchtower`-Daemon

Optional kann der Node auch die folgenden Komponenten ausführen:

- Einen Execution Client
- Einen Beacon Node
- Einen Validator Client
- MEV-Boost
- Prometheus
- Den Prometheus Node Exporter
- Grafana

Jede dieser Komponenten kann als Docker-Container im Standard-Setup, als `systemd`-Services im "Native Mode"-Setup oder als extern verwaltete Entitäten ausgeführt werden, mit denen sich der Smartnode über ihre jeweiligen API-Routen verbinden kann.

Praktischerweise sind Oracle DAO Nodes die gleichen wie normale Rocket Pool Nodes, aber der `watchtower`-Daemon führt die zusätzlichen Oracle DAO Aufgaben aus und es werden mehr Prometheus-Metriken für Leistungsüberwachungszwecke gesammelt.

## Initiales Node-Setup

Der beste Weg, um zu beginnen, besteht darin, [die Standard-Setup-Anweisungen](../node-staking/platform) für einen normalen Rocket Pool Node zu befolgen.
Dieser Prozess hilft Ihnen zu bestimmen, wie Sie Ihren Node konfigurieren und betreiben möchten.

Wenn Sie minipools (validators) auf Ihrem Node betreiben möchten, folgen Sie bitte der normalen Node-Dokumentation von Anfang bis Ende und kehren Sie hierher zurück, wenn Sie fertig sind.

Wenn Sie _nicht_ beabsichtigen, minipools zu betreiben und ihn stattdessen ausschließlich für Oracle DAO Aufgaben verwenden werden, können Sie alle Schritte im Zusammenhang mit dem Staken von RPL und der minipool-Erstellung überspringen.
Die anderen Schritte wie Node-Registrierung, Etablierung einer guten Sicherheitshaltung, Überwachung der Node-Gesundheit und -Leistung sowie Aktualisierung des Smartnode nach einem Update gelten weiterhin für Sie und Sie sollten sie sorgfältig prüfen, bevor Sie fortfahren.
Kehren Sie hierher zurück, wenn Sie fertig sind.

## Zusätzliche Oracle DAO Konfiguration

Es gibt zwei zusätzliche Einstellungen, die Sie bereitstellen müssen, um Ihre Oracle DAO Verantwortlichkeiten zu erfüllen.
Bitte wählen Sie den Modus aus, den Sie zur Konfiguration Ihres Nodes verwenden, aus den Tabs unten.

<div className="p-3">
  <Tabs>
    <Tab label="(service config) Interaktive UI">
      Öffnen Sie die `rocketpool service config` TUI und gehen Sie zum Abschnitt `Smartnode and TX Fees`.
      Hier sehen Sie zwei Optionen am unteren Rand:

      <img src={tuiOdao} width="100%" height="auto"/>

      Die `Archive-Mode EC URL` muss der HTTP-Endpunkt der RPC-API für Ihren Archive Execution Client sein.
      **Beachten Sie, dass Sie diese Einstellung ignorieren können, wenn Sie Ihren Archive EC bereits als primären Client im Externally-Managed-Modus verwenden.**
    </Tab>
    <Tab label="(service config) Headlessly">

      Führen Sie den folgenden Befehl aus, um Ihren Node headlessly zu konfigurieren:

      ```shell
      rocketpool service config --smartnode-archiveECUrl "http://your Archive EC URL"
      ```

      Wobei:

      `--smartnode-archiveECUrl` der HTTP-Endpunkt der RPC-API für Ihren Archive Execution Client sein muss.
      **Beachten Sie, dass Sie diese Einstellung ignorieren können, wenn Sie Ihren Archive EC bereits als primären Client im Externally-Managed-Modus verwenden.**

      Starten Sie schließlich Ihren `watchtower`-Daemon neu (z.B. mit `docker restart rocketpool_watchtower` im Docker- oder Hybrid-Modus, oder `sudo systemctl restart rp_watchtower` im Native-Modus), damit die Einstellungen wirksam werden.
    </Tab>
    <Tab label="Direkte Config-Datei">
      Öffnen Sie die Datei `user-settings.yml` in Ihrem Smartnode-Verzeichnis (standardmäßig `~/.rocketpool`) in einem Texteditor.
      Scrollen Sie nach unten zum Abschnitt `smartnode`:

      ```
      smartnode:
      archiveECUrl: http://your Archive EC URL
      dataPath: /home/user/.rocketpool/data
      manualMaxFee: "0"
      minipoolStakeGasThreshold: "150"
      network: mainnet
      priorityFee: "2"
      projectName: rocketpool
      rewardsTreeMode: generate
      ```

      Ersetzen Sie die Werte im Feld `archiveECUrl`, wobei:

      `archiveECUrl` der HTTP-Endpunkt der RPC-API für Ihren Archive Execution Client sein muss.
      **Beachten Sie, dass Sie diese Einstellung ignorieren können, wenn Sie Ihren Archive EC bereits als primären Client im Externally-Managed-Modus verwenden.**

      Starten Sie schließlich Ihren `watchtower`-Daemon neu (z.B. mit `docker restart rocketpool_watchtower` im Docker- oder Hybrid-Modus, oder `sudo systemctl restart rp_watchtower` im Native-Modus), damit die Einstellungen wirksam werden.
    </Tab>

  </Tabs>
</div>

## Oracle DAO Smartnode-Befehle

Die `odao`-Befehlsgruppe der Smartnode-CLI wird verwendet, um mit den Oracle DAO Contracts und Aufgaben on-chain zu interagieren:

```
NAME:
   rocketpool odao - Manage the Rocket Pool oracle DAO

USAGE:
   rocketpool odao command [command options] [arguments...]

COMMANDS:
   status, s             Get oracle DAO status
   members, m            Get the oracle DAO members
   member-settings, b    Get the oracle DAO settings related to oracle DAO members
   proposal-settings, a  Get the oracle DAO settings related to oracle DAO proposals
   minipool-settings, i  Get the oracle DAO settings related to minipools
   propose, p            Make an oracle DAO proposal
   proposals, o          Manage oracle DAO proposals
   join, j               Join the oracle DAO (requires an executed invite proposal)
   leave, l              Leave the oracle DAO (requires an executed leave proposal)

OPTIONS:
   --help, -h  show help
```

### status

Der `status`-Befehl fasst einige Details über das Oracle DAO zusammen, wie z.B. Mitgliederanzahl und Proposal-Anzahl:

```
The node is a member of the oracle DAO - it can create unbonded minipools, vote on DAO proposals and perform watchtower duties.

There are currently 8 member(s) in the oracle DAO.

There are 29 oracle DAO proposal(s) in total:
- 22 proposal(s) have passed and been executed
- 7 proposal(s) were cancelled, defeated, or have expired
```

### members

Der `members`-Befehl gibt detaillierte Informationen über jedes Mitglied des Oracle DAO aus, einschließlich ihres Handles, ihrer Kontaktinformationen, ihrer Node-Adresse, ihrer RPL-Bond und des letzten Zeitpunkts, zu dem sie einen Proposal zur Abstimmung eingereicht haben:

```
The oracle DAO has 8 members:

--------------------

Member ID:            kermit-2
URL:                  https://www.rocketpool.net
Node address:         0x04ddB06D1429578691F630B67A53916445DA38bE
Joined at:            31 Jul 21 23:32 EDT
Last proposal:        27 Sep 22 21:18 EDT
RPL bond amount:      5000.000000
Unbonded minipools:   0
...
```

### member-settings

`member-settings` zeigt die aktuellen Werte für jeden der konfigurierbaren Parameter im Zusammenhang mit der Oracle DAO Mitgliedschaft:

```
ODAO Voting Quorum Threshold: 51.000000%
Required Member RPL Bond: 1750.000000 RPL
Max Number of Unbonded Minipools: 250
Consecutive Challenge Cooldown: 300 Blocks
Challenge Meeting Window: 900 Blocks
Cost for Non-members to Challenge Members: 1.000000 ETH
```

Dieser Befehl wird im Abschnitt [Oracle DAO Proposals](./proposals) ausführlicher beschrieben.

### proposal-settings

`proposal-settings` zeigt die aktuellen Werte für jeden der konfigurierbaren Parameter im Zusammenhang mit Proposals, über die das Oracle DAO abstimmen kann:

```
Cooldown Between Proposals: 1h0m0s
Proposal Voting Window: 168h0m0s
Delay Before Voting on a Proposal is Allowed: 15m0s
Window to Execute an Accepted Proposal: 168h0m0s
Window to Act on an Executed Proposal: 168h0m0s
```

Dieser Befehl wird im Abschnitt [Oracle DAO Proposals](./proposals) ausführlicher beschrieben.

### minipool-settings

`minipool-settings` zeigt die aktuellen Werte für jeden der konfigurierbaren Parameter im Zusammenhang mit minipools im Rocket Pool Netzwerk:

```
Scrub Period: 1h0m0s
```

### propose

Der `propose`-Befehl wird verwendet, um Governance-Proposals einzureichen, über die der Rest des Oracle DAO abstimmen kann.
Diese können das Ändern einer Einstellung oder das Modifizieren der Oracle DAO Mitglieder beinhalten (d.h. das Einladen oder Entfernen anderer Mitglieder).

Dieser Befehl wird im Abschnitt [Oracle DAO Proposals](./proposals) ausführlicher beschrieben.

### proposals

Der `proposals`-Befehl wird verwendet, um mit bestehenden Oracle DAO Governance-Proposals zu interagieren.
Er kann sie anzeigen, Proposals zurückziehen, die Sie erstellt haben, über sie abstimmen und sie ausführen (falls zutreffend), wodurch sie wirksam werden, nachdem sie von den anderen Mitgliedern genehmigt wurden:

```
NAME:
   rocketpool odao proposals - Manage oracle DAO proposals

USAGE:
   rocketpool odao proposals command [command options] [arguments...]

COMMANDS:
   list, l     List the oracle DAO proposals
   details, d  View proposal details
   cancel, c   Cancel a proposal made by the node
   vote, v     Vote on a proposal
   execute, x  Execute a proposal

OPTIONS:
   --help, -h  show help

```

Dieser Befehl wird im Abschnitt [Oracle DAO Proposals](./proposals) ausführlicher beschrieben.

### join / leave

Die Befehle `join` und `leave` werden verwendet, um dem Oracle DAO beizutreten, sobald Sie eingeladen wurden, oder das Oracle DAO zu verlassen, sobald die anderen Mitglieder Ihrem Rücktrittsantrag zugestimmt haben.

## Dem Oracle DAO beitreten

### Die RPL-Bond

Um dem Oracle DAO beizutreten, muss Ihr Node-Wallet genügend RPL enthalten, um die erforderliche Mitgliedschafts-Bond zu decken.
Diese wird als Teil des Beitrittsprozesses im Vault von Rocket Pool gesperrt.
Der genaue RPL-Betrag, der für die Bond erforderlich ist, wird zum Zeitpunkt Ihrer Einladung festgelegt und wird Ihnen von den anderen Oracle DAO Mitgliedern vor Ihrem Onboarding mitgeteilt.

::: warning HINWEIS
Im Gegensatz zu allen anderen ETH- und RPL-Rewards wird die RPL-Bond beim Verlassen des Oracle DAO _nicht_ an die Withdrawal-Adresse Ihres Nodes gesendet.
Sie wird an Ihr Node-Wallet selbst zurückgesendet.
Betrachten Sie dies als zusätzlichen Anreiz, Ihr Node-Wallet vor Kompromittierung zu schützen.
:::

### Akzeptieren einer Einladung

Sobald Ihr Node eingerichtet ist und Sie von den bestehenden Mitgliedern zum Oracle DAO eingeladen wurden, können Sie den Befehl `rocketpool odao join` verwenden, um die Einladung anzunehmen.
Dies umfasst zwei Transaktionen:

- Eine zum Sperren des RPL, das für Ihre Bond erforderlich ist
- Eine zum Beitritt zum Oracle DAO, wenn die Bond empfangen wurde

Sobald Sie beigetreten sind, beginnt Ihr `watchtower`-Daemon automatisch mit der Durchführung seiner erforderlichen Aufgaben.
Sie können dies überprüfen, indem Sie sich seine Logs ansehen (z.B. `rocketpool service logs watchtower` für Standard-Docker-basierte Installationen); der Watchtower führt seinen Aufgabenzyklus alle 4 bis 6 Minuten durch, und Sie werden eine deutliche Änderung in seiner Ausgabe bemerken, sobald Sie dem Oracle DAO beigetreten sind.

### Nächste Schritte

Nachdem Sie dem Oracle DAO beigetreten sind, sehen Sie sich den nächsten Abschnitt an, um zu erfahren, wie Sie Ihren Node in dieser Rolle testen können.
