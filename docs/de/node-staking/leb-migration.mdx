import { Tab, Tabs } from "@rspress/core/theme";

::: danger WARNUNG
Minipool-Einzahlungen sind derzeit in Vorbereitung auf Saturn 1 deaktiviert.
:::

# Migration eines 16-ETH Minipools zu 8-ETH

Node Operators haben die Möglichkeit, ihre bestehenden 16-ETH Minipools **direkt zu 8-ETH Minipools zu migrieren**.
Dadurch werden ihrem [Einzahlungsguthaben](./credit) 8 ETH hinzugefügt, die verwendet werden können, um **zusätzliche Minipools zu erstellen, ohne dass ETH vom Node Operator erforderlich ist**.

Dieser Prozess ermöglicht es einem Node Operator, **einen 16-ETH Minipool kostenlos in zwei 8-ETH Minipools umzuwandeln** (_obwohl weiterhin ETH für Gas benötigt wird und genügend RPL-Sicherheiten vorhanden sein müssen, um beide Minipools zu unterstützen_).

Die Migration eines bestehenden 16-ETH Minipools zu einem 8-ETH Minipool wird formell als **Bond Reduction** bezeichnet.
Es ist ein zweistufiger Prozess und beinhaltet eine Validierung durch das Oracle DAO.
Wir führen Sie in den folgenden Abschnitten durch den gesamten Prozess.

### Regeln für Bond Reduction

Eine Bond Reduction umfasst die folgenden Schritte:

1. Starten der Bond Reduction durch den Node Operator.
2. Eine Wartezeit (die "Bond Reduction Scrub Check"), die dem Oracle DAO Zeit gibt, zu überprüfen, ob die Bond Reduction legal ist, und alle Bond Reductions zu stornieren, die gegen die Regeln verstoßen.
3. Abschluss der Bond Reduction durch den Node Operator.

Um eine erfolgreiche Bond Reduction ohne Scrubbing durchzuführen, muss der Minipool diese Regeln befolgen:

1. Der Minipool muss auf den [Atlas Delegate](./minipools/delegates) aktualisiert sein; der alte Redstone Delegate kann nicht verwendet werden.
1. Der Validator des Minipools auf der Beacon Chain muss **pending oder aktiv am Staking sein**. Er darf nicht geslasht, am Austritt / ausgetreten oder abhebbar / abgehoben sein.
1. Das Validator-Guthaben des Minipools auf der Beacon Chain muss **mindestens 31,99 ETH** betragen (32 ETH mit einem kleinen Puffer für schlecht getimte Komplikationen, die zu verpassten Attestierungen nach einem Rewards Skim führen).

Der Minipool muss diese Bedingungen für die **gesamte Dauer** der Scrub Check einhalten, während der das Oracle DAO ihn überwacht, um die Einhaltung der oben genannten Bedingungen sicherzustellen.

Wenn zu irgendeinem Zeitpunkt während der Scrub Check festgestellt wird, dass ein Minipool gegen diese Bedingungen verstößt, wird die Bond Reduction **gescrubbt**.
Der Minipool selbst wird nicht beeinträchtigt; er wird weiterhin glücklich als 16 ETH Minipool leben, validieren und so tun, als ob der gesamte Bond-Reduction-Prozess nie stattgefunden hätte.
Er wird jedoch **nicht mehr für Bond Reductions berechtigt sein**.
Sobald die Bond Reduction eines Minipools gescrubbt wurde, kann sie nie wieder versucht werden.

::: warning HINWEIS
Bei einer erfolgreichen Bond Reduction wird der Bond-Betrag des Minipools von 16 ETH auf 8 ETH reduziert und **die Provision des Minipools wird auf den aktuellen Netzwerkwert zurückgesetzt**.

Wenn Sie einen 16-ETH Minipool mit einer 20%-Provision reduzieren, **behalten Sie diese 20%-Provision nicht**.
Sie wird auf den Netzwerkwert reduziert (**derzeit auf pauschal 14% festgelegt**).

Beachten Sie, dass ein 8-ETH Minipool mit 14%, wie die [Beispielrechnung](./create-validator.mdx#rewards) zeigt, _immer noch profitabler ist_ als ein 16-ETH Minipool mit 20%, sodass das Festhalten an einer hohen Provisionsrate kein überzeugender Grund ist, einen 16 ETH Bond beizubehalten.
:::

### Schritt 1: Beginn der Bond Reduction

Um den Bond-Reduction-Prozess zu beginnen, geben Sie folgenden Befehl ein:

```shell
rocketpool minipool begin-bond-reduction
```

Dies beginnt mit einem kurzen Text zum Prozess (obwohl, wenn Sie diese Anleitung gelesen haben, sollte Ihnen alles bereits vertraut sein).
Sobald Sie bestätigen, dass Sie den Prozess verstanden haben, wird angezeigt, welche Minipools derzeit einen reduzierbaren Bond haben, zusammen mit ihrem aktuellen Bond und ihrer Provision:

```
Please select a minipool to begin the ETH bond reduction for:
1: All available minipools
2: 0x7E5703fdA638CD86c316B9EbAF76927fF695ADC5 (Current bond: 16 ETH, commission: 15.00%)
3: 0x7E5704aD2a63eb90880426Dcd4a3811246dF3cB0 (Current bond: 16 ETH, commission: 15.00%)
4: 0x7E5705c149D11efc951fFc20349D7A96bc6b819C (Current bond: 16 ETH, commission: 15.00%)
5: 0x7E570625cE8F586c90ACa7fe8792EeAA79751778 (Current bond: 16 ETH, commission: 15.00%)

```

Sobald Sie einen oder mehrere Minipools zur Reduzierung ausgewählt haben, prüft der Smartnode, ob diese Minipools für eine Bond Reduction berechtigt sind.

Um berechtigt zu sein, müssen folgende Bedingungen erfüllt sein:

- Der Minipool wurde aktualisiert, um den [Atlas Minipool Delegate Contract](./minipools/delegates) zu verwenden.
- Der Validator des Minipools muss ein Beacon Chain Guthaben von mindestens 32 ETH haben.
- Der Validator des Minipools muss pending oder aktiv sein.
- Sie müssen genug RPL gestakt haben, um das minimale RPL-Sicherheitsniveau zu unterstützen, das _nach_ der Bond Reduction erforderlich wäre.

Wenn nicht, wird eine Warnmeldung ausgegeben, die erklärt, was zuerst getan werden muss; zum Beispiel:

```
Please select a minipool to begin the ETH bond reduction for:
1: All available minipools
2: 0x7E5703fdA638CD86c316B9EbAF76927fF695ADC5 (Current bond: 16 ETH, commission: 15.00%)
3: 0x7E5704aD2a63eb90880426Dcd4a3811246dF3cB0 (Current bond: 16 ETH, commission: 15.00%)
4: 0x7E5705c149D11efc951fFc20349D7A96bc6b819C (Current bond: 16 ETH, commission: 15.00%)
5: 0x7E570625cE8F586c90ACa7fe8792EeAA79751778 (Current bond: 16 ETH, commission: 15.00%)
2

Cannot reduce bond for minipool 0x7E5703fdA638CD86c316B9EbAF76927fF695ADC5:
The minipool version is too low. It must be upgraded first using `rocketpool minipool delegate-upgrade`.
You do not have enough RPL staked to support this bond reduction; it would bring you below the minimum RPL staking requirement. You will have to stake more RPL first.
```

Dies zeigt, dass der ausgewählte Minipool ein Delegate-Upgrade benötigt und der Node mehr RPL gestakt haben muss, um den Bond dieses Minipools zu reduzieren.

Wenn Sie die Vorbedingungen erfüllt haben, werden Sie bei Auswahl eines Minipools in diesem Befehl einfach aufgefordert, Ihren Gaspreis für die Transaktion zu wählen und die Aktion zu bestätigen.
Nach Annahme der Bestätigung beginnt die Bond Reduction des Minipools.

### Überwachung des Scrub Check Timers

Sobald Sie eine Bond Reduction gestartet haben, können Sie in Ihren `node`-Daemon-Logs sehen, wie lange es noch dauert, bis sie abgeschlossen werden kann:

<div className="p-3">
  <Tabs>
    <Tab label="Docker and Hybrid Mode">
      Für Benutzer im **Docker Mode** und **Hybrid Mode** kann dies mit folgendem Befehl durchgeführt werden:

      ```shell
      rocketpool service logs node
      ```
    </Tab>
    <Tab label="Native Mode">
      Konsultieren Sie das Skript, das Sie zum Überprüfen der Systemlogs Ihres Node-Daemons verwenden.
    </Tab>

  </Tabs>
</div>

Sie werden einen neuen Eintrag sehen, der angibt, wie viel Zeit noch verbleibt, bis die Scrub Check für Ihre Bond Reduction abgeschlossen ist:

```
rocketpool_node  | 2023/02/25 09:04:21 Checking for minipool bonds to reduce...
rocketpool_node  | 2023/02/25 09:04:21 Minipool 0x7E5703fdA638CD86c316B9EbAF76927fF695ADC5 has 12m0s left until it can have its bond reduced.
```

Sobald dieser Timer Null erreicht und nicht mehr in diesen Logs erscheint, können Sie die Bond Reduction abschließen.

### Schritt 2: Abschluss der Bond Reduction

Wenn der Scrub-Timer erfolgreich beendet wurde, gibt es zwei Möglichkeiten, die Bond Reduction Ihres Minipools abzuschließen:

1. Lassen Sie den `node`-Daemon dies für Sie erledigen; er tut dies während der Routineprüfung, die er alle fünf Minuten durchführt (dieselbe, die die verbleibende Zeit im obigen Log ausgibt). Wenn er feststellt, dass Sie eine berechtigte Bond Reduction haben, **wird er die Reduzierung automatisch abschließen** - genau wie er es beim Staking von Pending-Minipools und beim Überprüfen Ihres Fee Recipients tut. Sie sehen die Ausgabe im `node`-Log, wenn er eine Bond Reduction erkannt und abgeschlossen hat.
2. Schließen Sie die Bond Reduction manuell mit folgendem Befehl ab:
   ```shell
   rocketpool minipool reduce-bond
   ```
   Der Befehl ist einfach; folgen Sie den Anweisungen, um den Prozess abzuschließen, sobald Ihr Minipool für eine Bond Reduction berechtigt ist.

Während der Bond Reduction **verteilt Rocket Pool das bestehende Guthaben Ihres Minipools** unter Verwendung des Pre-Bond-Reduction-Bonds und der Provision des Minipools, um sicherzustellen, dass sowohl Sie als auch die rETH-Staker ihren fairen Anteil am bestehenden Guthaben erhalten und die Bond Reduction die Belohnungen, die beide Parteien _für dieses Guthaben erhalten hätten_, nicht verändert.

### Die Ergebnisse eines reduzierten Bonds

Sie können die erfolgreiche Bond Reduction mit `rocketpool minipool status` überprüfen.

**Vor** der Bond Reduction würde dieser Befehl für den Beispiel-Minipool, dem wir gefolgt sind, folgende Ausgabe erzeugen:

```
Address:              0x7E5703fdA638CD86c316B9EbAF76927fF695ADC5
...
Node fee:             15.000000%
Node deposit:         16.000000 ETH
RP ETH assigned:       2023-02-08, 06:13 +0000 UTC
RP deposit:            16.000000 ETH
Minipool Balance (EL): 0.150713 ETH
Your portion:          0.086660 ETH
Available refund:      0.000000 ETH
Total EL rewards:      0.086660 ETH
...
Beacon balance (CL):   32.000152 ETH
Your portion:          16.000087 ETH
...
```

**Nach** der Bond Reduction würde der Befehl diese Ausgabe zurückgeben:

```
Address:              0x7E5703fdA638CD86c316B9EbAF76927fF695ADC5
...
Node fee:             14.000000%
Node deposit:         8.000000 ETH
RP ETH assigned:       2023-02-08, 06:13 +0000 UTC
RP deposit:            24.000000 ETH
Minipool Balance (EL): 0.086769 ETH
Your portion:          0.000000 ETH
Available refund:      0.086769 ETH
Total EL rewards:      0.086769 ETH
...
Beacon balance (CL):   32.000037 ETH
Your portion:          8.000013 ETH
...
```

Beachten Sie, wie sich die Dinge geändert haben:

- `Node fee` (Kommission) ging von 15% auf 14%
- `Node deposit` (Ihr Bond) ging von 16 ETH auf 8 ETH
- `RP deposit` (der Betrag, den Sie geliehen haben) ging von 16 ETH auf 24 ETH
- `Minipool Balance (EL)` ging von 0,150713 ETH auf 0,086769 ETH
- `Your portion (EL)` ging von 0,086660 ETH auf 0 ETH
- `Available refund` ging von 0 ETH auf 0,086769 ETH
- `Your portion (CL)` ging von 16,000087 ETH auf 8,000013 ETH

Die Änderungen bei `Node fee`, `Node deposit`, `RP deposit` und `Your portion (CL)` zeigen an, dass der Bond erfolgreich reduziert wurde.

Die Änderungen bei `Minipool Balance (EL)`, `Your portion (EL)` und `Available refund` zeigen die Ergebnisse der **Minipool Balance Distribution**, die als Teil des Bond-Reduction-Prozesses stattfand.
Um zu klären, wie diese Ergebnisse zu interpretieren sind:

- Wenn Sie sich [die Transaktion](https://zhejiang.beaconcha.in/tx/0xf02f6b1a4ea68f356909e6f1974dc3c24d301ba115b97f3013c3c829ba2ca57c) ansehen, werden Sie auch sehen, dass 0,06413383 ETH vom Minipool an den Staking Pool gesendet wurden.
- Im "Vorher"-Beispiel ist der Anteil des Staking Pools das Guthaben des Minipools minus dem Anteil des Node Operators, also `0,150713 - 0,086660 = 0,064053`, was der Betrag ist, der während der Bond Reduction an den Staking Pool übertragen wurde (plus ein kleiner Betrag aus einem Rewards Skim, der während der Scrub Check auftrat).
- Der Anteil des _Node Operators_ wird dagegen nicht an die Abhebungsadresse des Node Operators gesendet. Stattdessen wird er als **verfügbare Rückerstattung** markiert, weshalb der Rückerstattungsbetrag von 0 ETH auf den Betrag erhöht wurde, der zuvor der "Ihr Anteil"-Betrag des Minipool-Guthabens auf der EL war.
  - Sie können diese Rückerstattung jederzeit mit folgendem Befehl anfordern:
    ```shell
    rocketpool minipool refund
    ```

Es gibt ein weiteres wichtiges Ergebnis der Bond Reduction, das mit `rocketpool node status` beobachtet werden kann:

```
Your Smartnode is currently using the Zhejiang Test Network.

=== Account and Balances ===
The node 0x9BA1401Eb7D779eC51f910B066e9C4351cD28911 has a balance of 347.796908 ETH and 16799.835547 RPL.
The node has 8.000000 ETH in its credit balance, which can be used to make new minipools.
```

Der Bond-Reduction-Prozess hat **das** [Einzahlungsguthaben](./credit) **des Nodes um 8 ETH erhöht**.
Dieses Guthaben kann verwendet werden, um [einen weiteren 8-ETH Minipool zu erstellen](./create-validator.mdx#depositing-eth-and-creating-a-minipool) - kostenlos (kein ETH aus der Node-Wallet erforderlich, außer für Gas)!
