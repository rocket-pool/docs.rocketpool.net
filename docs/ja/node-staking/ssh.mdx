import { Tab, Tabs } from "@rspress/core/theme";
import powershell from "./images/powershell.png";

# Secure Shell (SSH) 入門

一般的に、ノードマシンにアクセスする方法には、**ローカル**と**リモート**の2つがあります。

- **ローカル**とは、物理的なノードの前に座り、直接接続されたモニターとキーボードを使用することを指します。
- **リモート**とは、別のコンピューター（例えばノートパソコンやデスクトップ）を使用してネットワーク経由でノードに接続し、そこから操作することを指します。

ほとんどの場合、ノードオペレーターは**リモート**でノードを操作する柔軟性を好みます。

Smartnodeには現在GUI（グラフィカルユーザーインターフェース）がなく、CLI（コマンドラインインターフェース）のみであるため、操作は完全にコマンドラインターミナルにコマンドを入力することによって行われます。
そのため、リモートで操作するには、別のマシンからノードのターミナルにアクセスする方法が必要です。
このセクションでは、最も一般的な方法である**SSH**について簡単に紹介します。

<div className="p-3">
  <Tabs>
    <Tab label="Windowsマシンを使用する場合">
      Windowsマシンから SSH を使用するにはいくつかの方法があります。

      最も簡単な方法は、最新バージョンの Windows に組み込まれている強力なコマンドターミナルである **Powershell** を使用することです。
      Powershell には SSH が含まれているため、追加のプログラムをインストールすることなくすぐに使用できます。

      スタートメニューを開いて検索バーに `Powershell` と入力すると見つかります。いくつかのオプションが表示されますが、必要なのは単に `Windows Powershell` と呼ばれるオプションです。

      <img src={powershell} width="100%" height="auto" />

      これにより、青い背景のターミナルが開きます。
      ここから `ssh` を使用できます - 使用方法については以下を参照してください。

      もう1つの人気のあるツールは [PuTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html) と呼ばれるものです。
      PuTTY は SSH 専用のターミナルを含む特別なプログラムですが、設定の変更、設定を「プロファイル」に保存、リストから選択して簡単に接続できるマシンのリストを保持するための便利な GUI も付属しています。

      他のツールのように `ssh` を使用する代わりに、PuTTY はこれを自動的に行います - 必要なのはユーザー名とパスワードを提供するだけです。
      PuTTY の使用方法については、[この優れたチュートリアル](https://tonyteaches.tech/putty-ssh-windows-tutorial/)をご覧ください。

      <p className="rspress-directive warning">
        **注意**: PuTTY は `rocketpool service config` テキストベースのユーザーインターフェース（TUI）で誤った色を表示する可能性があります。
        これには簡単な解決策があります。PuTTY の設定で、ドロップダウンメニューの **Connection** > **Data** > **Terminal Details** に移動してください。**Terminal-type string** テキストボックスがあるはずです。`xterm-256color` と入力し、設定を保存するとこの問題が解決されます。
      </p>

    </Tab>
    <Tab label="LinuxまたはmacOSマシンを使用する場合">
      Linux または macOS マシンから SSH を使用するのは簡単です。これらのいずれかを既に使用している場合、おそらくターミナルと対話したことがあるでしょう。
      SSH はターミナルに直接組み込まれています。`ssh` コマンドを実行して使用します。デフォルトでは、SSH を使用してノードのプライマリユーザーアカウントに接続できます。
    </Tab>

  </Tabs>
</div>

以下は、SSH を使用してノードに接続する方法です。

:::warning 注意
次のコマンドは、ノード自体からではなく、**ラップトップまたはデスクトップから実行してください**！
:::

```shell
ssh username@node-ip-address
```

たとえば、ノードのユーザー名が `staker` で、ノードの IP アドレスが `192.168.1.10` の場合、次のコマンドで接続します。

```shell
ssh staker@192.168.1.10
```

初めてこれを行うと、ノードが使用している公開鍵を提示するメッセージが表示されます - この鍵を検証する方法に精通している場合は、今すぐ検証できます。
それ以外の場合、`ssh` コマンドに正しいノード IP アドレスがあると信頼できる場合は、`yes` と答えて受け入れることができます。
これは一度だけ行う必要があります。

クライアントはユーザーのパスワードを要求します。それを入力すると、接続完了です！
ウェルカムメッセージ、マシンに関する詳細、および新しいプロンプトが表示されます。

この時点で、ターミナルに入力したものはすべて**ノードマシン上でリモート実行されます** - まるでノードマシンに直接ログインして、ローカルに接続されたキーボードで入力しているかのようです！

更新やメンテナンスのために定期的にターミナルに SSH 接続する必要があります。
ノードへのログイン方法を覚えておくのは不便な場合があるため、記憶に残るエイリアス - カスタムの「ショートカット」コマンドを作成すると便利です。

:::warning 注意
これを行う場合は、ノードではなく**クライアントマシン**にエイリアスを作成してください！
ターミナルがまだノードに接続されている場合は、まずコマンドプロンプトで `exit` を実行するか、単に新しいターミナルウィンドウを開いてください。
:::

:::warning 注意
このセクションは Linux/OSX または WSL ユーザーのみに適用されます - PowerShell はサポートされていません。
:::

この例では、SSH コマンドを置き換える `ethnode` という名前のエイリアスを作成します。
前述のように、ノードのユーザー名が `staker` で、ノードの IP アドレスが `192.168.1.10` であると仮定すると、次のコマンドでエイリアスを作成します。

```shell
echo "alias ethnode='ssh staker@192.168.1.10'" >> ~/.bash_aliases
```

エイリアスリストをリロードして、現在のターミナルウィンドウが新しいエイリアスを認識するようにします。

```shell
source ~/.bash_aliases
```

これで、ノードの IP アドレスを指定する長いコマンドの代わりに、作成したエイリアスを使用してノードに接続できます。

```shell
ethnode
```
