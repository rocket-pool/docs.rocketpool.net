import { Tab, Tabs } from "@rspress/core/theme";

# テストネットワークからメインネットへの移行

Hoodi テストネットワークで Rocket Pool を既に使用しており、その仕組みに慣れていて、実際のイーサリアムメインチェーンで ETH をステーキングするか、ノードを運用する準備ができている場合、このガイドはあなたのためのものです。
ここでは、既存の Smartnode スタックを Hoodi テストネットワークから、実際の ETH と RPL をステーキングする準備ができたイーサリアムメインネットに接続されたものへ移行する手順を説明します。

## メインネットでのプールステーキング

プールステーキングは、メインネットでもテストネットと基本的に同じプロセスです。
URL が異なり、rETH トークンのアドレスが異なる可能性がありますが、ワークフローに大きな変更はありません。
メインネットの手順で更新された[ステーキングガイド](../../liquid-staking/overview)に従ってください。

### テストネットとメインネットの違い

- テストネット Smartnode にはテスト ETH のためのフォーセットがあります。メインネット Smartnode には**フォーセットがありません**。ステーキングするには、自分で ETH を用意する必要があります。
- メインネットは WalletConnect を介して多くのイーサリアムウォレットをサポートしているため、テストネットでは使用できなかった他のウォレットを使用できます。**ステーキングするために Metamask の使用に制限されることはありません**。

## メインネットでの Smartnode 運用

::: danger 注意
テストネットワークからメインネットに移行できるものは**何もありません**。
実行クライアントとコンセンサスクライアントの両方でチェーンデータが異なるため、古いチェーンデータを削除し、メインネットチェーンをゼロから再同期する必要があります。
テストネットのバリデーターはメインネットに引き継がれません。
また、セキュリティ、互換性、安全性の理由から、**メインネットで新しいウォレットを作成する必要があります！**
**テストネットのノードウォレットをメインネットで使用しないでください！**

**以下の手順は、すべてのテストネットデータを削除します。**
テストネットワークのセットアップを保持したい場合は、ハードドライブをバックアップするか、2 台目のマシンに移動する必要があります。
:::

### テストネットとメインネットの違い

- テストネット Smartnode には ETH と RPL のフォーセットがあります。メインネット Smartnode には**フォーセットがありません**。自分で ETH と RPL を用意する必要があります。
- Geth を使用している場合、ノードのワークロードは**かなり高くなります**。Geth は Hoodi の約 40 倍のストレージスペースを必要とし、処理にはより多くの CPU パワーと RAM が必要です。Rocket Pool Grafana ダッシュボードを使用している場合は、使用率がはるかに高くなることを覚悟してください。
  フル Geth ノードは 2025-09-19 時点で 1.4 TB を使用します。[マージ前のブロックデータを期限切れにする](../maintenance/history-expiry)ことで、ストレージ使用量を約 300-500 GB 削減できます。
- ビーコンチェーンのピア（したがって、アテステーション効果）は、テストネットよりも**高くなります**。メインネットのピアははるかに多様で、テストネットよりも高品質である傾向があります。
- RPL 報酬のチェックポイントは、高いガス代を相殺するために、2 日ごとではなく**28 日ごと**に発生します。
- Rocket Pool ネットワークで使用される RPL 価格（したがって、担保レベル）とネットワーク全体の有効ステーク RPL の合計は、1 時間ごとではなく**24 時間ごとに 1 回**報告されます。

### 自動移行（Docker モードのみ）

Docker モードユーザーの場合、Smartnode が自動的にメインネットに移行できます。

**テストネットがまだ構成されている間に**、Hoodi でバリデーターを終了します:

```
rocketpool minipool exit
```

選択肢のリストから `1: All available minipools` を選択し、完了するまで待ちます。
これにより、バリデーターを削除することでネットワークをクリーンアップし、オンラインでなくなったためにアテステーションに常に失敗し続け、Hoodi の健全性を弱めることを防ぎます。

完了したら、設定マネージャーを開きます:

```
rocketpool service config
```

次に、**Smartnode and TX Fees** カテゴリを開き、**Network** ドロップダウンを `Hoodi Testnet` から `Ethereum Mainnet` に変更します:

<img src="../images/tui-change-network.png" width="100%" height="auto" />

保存して終了すると、すべてが削除されることを知らせる通知と確認ダイアログが表示されます:

```
WARNING: You have requested to change networks.

All of your existing chain data, your node wallet, and your validator keys will be removed.

Please confirm you have backed up everything you want to keep, because it will be deleted if you answer `y` to the prompt below.

Would you like the Smartnode to automatically switch networks for you? This will destroy and rebuild your `data` folder and all of Rocket Pool's Docker containers. [y/n]
```

保持したいもの（ノードウォレットとバリデーターキーを含む `data` フォルダーなど）をバックアップしてから、準備ができたら `y` を押して `Enter` を押します。
Smartnode が自動的に切り替えを処理します。

完了すると、メインネットに新規インストールされた状態になります。
すべての設定（クライアントの選択など）は保持されますが、新しいウォレットを作成する必要があります。また、メインネットでは _Checkpoint Sync URL_ がない可能性が高いため、[ここ](../config-docker#beacon-chain-checkpoint-syncing)で説明されているように設定する必要があります。そうしないと、メインネットビーコンチェーンの同期に長時間かかります。

### 手動での移行

何らかの理由で Smartnode の自動移行プロセスを利用できない場合は、いくつかの簡単な手順で手動で行うことができます:

<div className="p-3">
  <Tabs>
    <Tab label="Docker">
      1. **テストネットがまだ構成されている間に**、Hoodi でバリデーターを終了します:

      ```shell
      rocketpool minipool exit
      ```

      選択肢のリストから `1: All available minipools` を選択し、完了するまで待ちます。
      これにより、バリデーターを削除することでネットワークをクリーンアップし、オンラインでなくなったためにアテステーションに常に失敗し続け、Hoodi の健全性を弱めることを防ぎます。

      2. テストネットをシャットダウンします:

      ```shell
      rocketpool service stop
      ```

      3. テストネットチェーンデータと Docker コンテナを削除します:

      ```shell
      rocketpool service terminate
      ```

      4. Rocket Pool 構成フォルダーを削除します:

      ```shell
      sudo rm -rf ~/.rocketpool
      ```

      5. （オプション）Rocket Pool CLI を削除します:

      ```shell
      rm ~/bin/rocketpool
      ```
      いずれにしても最新バージョンの CLI で上書きしますが、徹底したい場合は、最初に古いものを削除できます。

      この時点でテストネットインストールは削除されており、新しいメインネットインストールに安全に移行できます。
      [Docker でのノード作成](../docker)ガイドに注意深く従って設定してください。
    </Tab>
    <Tab label="Native Mode">
      1. **テストネットがまだ構成されている間に**、Hoodi でバリデーターを終了します:

      ```shell
      rocketpool minipool exit
      ```

      選択肢のリストから `1: All available minipools` を選択し、完了するまで待ちます。
      これにより、バリデーターを削除することでネットワークをクリーンアップし、オンラインでなくなったためにアテステーションに常に失敗し続け、Hoodi の健全性を弱めることを防ぎます。

      2. すべての Rocket Pool およびイーサリアムサービスを停止します（たとえば、`geth` と `lighthouse` を使用している場合。インストール中に作成したサービスに置き換えてください）:

      ```shell
      sudo systemctl stop rp-node rp-watchtower geth lh-bn lh-vc
      ```

      3. すべてのテストネットチェーンデータを削除します（たとえば、x64 で `geth` と `lighthouse` を使用している場合。独自の構成に置き換えてください）:

      ```shell
      sudo rm -rf /srv/geth/geth_data
      sudo rm -rf /srv/lighthouse/lighthouse_data
      ```

      4. Rocket Pool 構成フォルダーを削除します:

      ```shell
      sudo rm -rf /srv/rocketpool
      ```

      5. （オプション）Rocket Pool CLI および Daemon バイナリを削除します:
      ```shell
      sudo rm /usr/local/bin/rocketpool /usr/local/bin/rocketpoold
      ```
      いずれにしても最新バージョンで上書きしますが、徹底したい場合は、最初に古いものを削除できます。

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">注意</p>
        簡単にするために、これらの手順には、`eth1` および `eth2` ユーザーの削除や、先ほど停止したサービスの削除などの一部の手順は_含まれていません_。
        それらを再利用し、インストールガイドでの設定に関する手順を無視できます。

        次のようないくつかのインストール手順をやり直す必要があります:

        - `/srv/rocketpool` フォルダーとそのスケルトンフレームワークを作成し、権限を適切に設定する
        - 実行クライアント、コンセンサスクライアント、およびバリデータークライアントのバイナリの最新リリースバージョンを取得する
        - サービスの **`ExecStart` 文字列**を設定する（**インストールガイドで定義されているメインネット構成を使用してください！**）
        - 最新の CLI および Daemon バイナリを取得する
            - インストーラーアーカイブから最新の構成ファイルを取得し、`/srv/rocketpool` に配置し、ノードのセットアップに合わせて調整する
      </p>

      この時点で、[ネイティブインストールガイド](../native)に従って移行する準備が整いました。
    </Tab>

  </Tabs>
</div>
