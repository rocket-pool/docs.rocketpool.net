import { Tab, Tabs } from "@rspress/core/theme";

# Layer 2上の分散型取引所を経由したステーキング

念のため、分散型ステーキングのメリットを享受するために、Rocket Poolを通じて直接ETHをrETHに交換する必要はありません。
rETHを保有するだけで、その価値は本質的に成長します。どのように入手したかは関係ありません。

とはいえ、特に最近の主な懸念事項の1つは、ステーキングやETHをrETHに交換する際のGas手数料のコストです。

これを削減するために、Ethereumネットワークは[rollups](https://www.youtube.com/watch?v=7pWxCklcNsU)の使用を開始しました。これは**Layer 2**としても知られています。

Layer 2は、Ethereumの下に存在するいくつかの独立したネットワークで構成されており、Ethereumが通常行うように多数のトランザクションを実行しますが、それらすべてを1つの「メガ」トランザクションにまとめて、代わりにメインのEthereumチェーンに*それ*を投稿します。
理想的には、Ethereumの分散型の性質に関連するすべてのセキュリティ上のメリットを得ることができますが、Layer 2での実行およびストレージコストははるかに低くなる可能性があり、トランザクションの一部のみがLayer 1に保存する必要があるため、トランザクションに対して**大幅に低いGas手数料**を享受できます。Layer 1では状態がはるかに高価です。

Rocket Poolは現在、2つのLayer 2ネットワークをサポートしています。[Optimism](https://www.optimism.io/)と[Arbitrum](https://arbitrum.io/)です。
両方とも、最も広く使用されている分散型取引所プロトコルである[Uniswap](https://docs.uniswap.org/protocol/introduction)の実行バージョンがあります。
Uniswapを使用すると、ETHをrETHに素早く簡単に交換できます。

このアプローチを使用する利点は、**Gas手数料が他の方法よりも大幅に低くなる**ことです。
少額のETHをステーキングしたいためにこれが重要な場合、Layer 2ネットワークを使用することがおそらく選択肢となるでしょう。

欠点は、rETHで最良の取引を得られない可能性があることです。
Uniswapには、流動性プロバイダーに与えられる少額の手数料が必要であり、大規模なトランザクションでは、価格への影響が大きすぎずに良い取引を得るために大規模な流動性プールが必要です。
Layer 2ネットワークは、メインのEthereumネットワークよりもrETHの流動性が低い傾向があります。

したがって、Layer 2ネットワークで得られる総rETHと、他の方法で得られる総rETHを比較して、このパスを追求することが理にかなっているかどうかを判断することをお勧めします。

[Optimismプール](https://info.uniswap.org/#/optimism/pools/0xaefc1edaede6adadcdf3bb344577d45a80b19582)と[Arbitrumプール](https://info.uniswap.org/#/arbitrum/pools/0xaac7de2b91293ba1791503d9127d2bdf2159db65)の現在のETHとrETHの残高を確認して、交換をカバーするのに十分なrETHがあるかどうかを判断できます。

以下の例では、Layer 2ネットワークと対話し、UniswapでETHをrETHに交換する方法を示します。

::: warning 注意
現在、この方法はMainnetでのみ利用可能です。
Hoodi Testnetで練習したい場合は、[Rocket Poolで直接交換](./via-rp)する必要があります。

**このガイドの残りの部分では、Mainnetを使用していることを前提としています。**
:::

このプロセスは、Web3互換のウォレットで完了できます。
デモンストレーションの目的で、最も人気のあるウォレットの1つである[MetaMask](https://metamask.io/)を使用します。

**別のウォレットを選択した場合でも、同様の手順で進めることができます。各手順でウォレット内の対応する機能を見つけてください。**

## Mainnet上でMetaMaskを設定する

まだインストールしていない場合は、[MetaMask](https://metamask.io/)をインストールしてください。
サイトの指示に従って、拡張機能をインストールし、アカウントを作成してサインインしてください。

次に、ブラウザのツールバーにあるアイコンを使用してMetaMaskパネルを開きます。
上部のツールバーにある**ネットワークドロップダウン**をクリックし、**Ethereum Mainnet**が選択されていることを確認してください。

<img src="./images/mm_network_main.png" width="100%" height="auto" />

その直下のアドレスが**Ethereumウォレットアドレス**です。

先に進む前に、このウォレットにETHを供給する必要があります。
以前の使用でアカウントにETHがない場合は、既存のアカウントからこのウォレットアドレスにETHを転送することでこれを行うことができます。

## Hopを経由してLayer 1からLayer 2にETHを転送する

Ethereum MainnetからLayer 2ネットワークにETHをブリッジする方法はいくつかあります。
このデモンストレーションでは、[Hop](https://docs.hop.exchange/faq)プロトコルを使用します。これは、Layer 1からいくつかのLayer 2ネットワークへ、またはLayer 2ネットワーク間でETH(および他のいくつかのコイン)を移動するシンプルで信頼性の高い方法です。

Hop取引所のウェブサイトにアクセスします。

[https://app.hop.exchange/send?token=ETH](https://app.hop.exchange/send?token=ETH)

ホーム画面は次のように表示されます。

<img src="./images/hop.png" width="100%" height="auto" />

右上隅にある**Connect a Wallet**ボタンをクリックして開始します。
使用するウォレットプロバイダーを尋ねる画面が表示されます。
この例では、**MetaMask**を選択します。

::: tip 注意
MetaMaskを使用していない場合は、WalletConnectなどの他のプロバイダーの1つがウォレットと互換性がある可能性があります。
:::

そのボタンをクリックすると、MetaMaskがポップアップし、使用するアカウントを選択するよう求められます。
アカウントが1つしかないと仮定すると、アカウントはすでに選択されているはずです。
**Next**をクリックします。

次に、Hopにアカウントのアドレスを表示するアクセス許可を与えるかどうかを尋ねられます。

<img src="./images/hop_connect.png" width="100%" height="auto" />

**Connect**をクリックすると、短い一時停止の後、ウォレットがHopに接続されます。
画面の右上隅にETH残高が表示されるはずです。

次に、**From**と**To (estimated)**ボックスの2つのドロップダウンを使用してネットワークを選択し、**From**ボックスに送信したいETHの量を入力できます。

たとえば、Layer 1からArbitrumに0.1 ETHを送信する場合は、次のようになります。

<img src="./images/hop_send.png" width="100%" height="auto" />

::: warning 注意
念のため、Uniswap(したがってRocket Poolステーキング)は現在、**OptimismとArbitrumでのみサポートされています**。
これらのネットワークの1つを選択する必要があります。
:::

準備ができたら、**Send**ボタンをクリックします。
Metamaskがポップアップし、トランザクションに関連するGas手数料を示す確認ダイアログが表示されます。

<img src="./images/hop_confirm.png" width="100%" height="auto" />

これらのGas手数料に問題がなければ、**Confirm**をクリックしてトランザクションを開始します。
しばらくすると、MetaMaskがトランザクション成功の確認メッセージをポップアップし、ETHが選択したLayer 2ネットワークで利用できるようになります。

## Layer 2上のUniswapに接続する

ウォレットが設定され、資金が供給されたら、次のURLにアクセスしてください。これにより、Uniswapが開き、ETHからrETHへの交換が自動的に表示されます。

[https://app.uniswap.org/#/swap?inputCurrency=eth](https://app.uniswap.org/#/swap?inputCurrency=eth)

ページは最初、次のように表示されます。

<img src="./images/uni_connect.png" width="100%" height="auto" />

右上隅の強調表示されたボタンなど、`Connect Wallet`ボタンの1つをクリックします。
使用するウォレットプロバイダーを尋ねる画面が表示されます。
この例では、**MetaMask**を選択します。

::: tip 注意
MetaMaskを使用していない場合は、WalletConnectなどの他のプロバイダーの1つがウォレットと互換性がある可能性があります。
:::

そのボタンをクリックすると、Hopで行ったのと同じように、MetaMaskがポップアップして使用するアカウントを選択するよう求められます。
アカウントを選択したままにして、**Next**をクリックし、次に以前にHopで行ったように**Connect**をクリックします。
短い一時停止の後、ウォレットがUniswapに接続されます。
画面の右上隅にETH残高が表示されるはずです。

最初にすることは、Ethereum mainnetから今スワップしたLayer 2にネットワークを変更することです。
画面の右上にあるネットワークドロップダウンをクリックします(ここでは赤で強調表示されています)。

<img src="./images/uni_network.png" width="100%" height="auto" />

そうすると、MetaMaskがカスタムネットワークを追加することを確認するよう求めます。

<img src="./images/uni_net_confirm.png" width="100%" height="auto" />

**Approve**をクリックし、次に**Switch Network**をクリックします。
これにより、MetaMaskはトランザクションにEthereumのmainnetの代わりに新しいLayer 2ネットワークを使用するように変更されます。

::: warning 注意
MetaMaskでトランザクションを行う前に、MetaMaskを開いて上部のネットワークドロップダウンを見て、現在使用しているネットワークを*必ず*確認してください。
誤って別のネットワークに切り替えて忘れてしまうことは簡単です。
:::

## MetaMaskにrETHを追加する

次のステップは、残高を確認し、取引にアクセスできるように、rETHトークンをMetaMaskに追加することです。
**Assets**タブをクリックし、次に**Add Token**をクリックします。

<img src="./images/mm_add_token.png" width="100%" height="auto" />

このダイアログで**Custom Token**が選択されていることを確認し、以下で選択したLayer 2ネットワークに適したタブを選択してください。

<div className="p-3">
  <Tabs>
    <Tab label="Optimism">
      **Token Contract Address**ボックスに、次の値を入力してください。

      ```shell
      0x9bcef72be871e61ed4fbbc7630889bee758eb81d
      ```

      **Token Symbol**は自動的に`rETH`が入力され、**Decimals of Precision**は自動的に`18`が入力されます。

      残りのプロンプトを受け入れると、リストにrETHトークンが表示されます。
    </Tab>
    <Tab label="Arbitrum">
      **Token Contract Address**ボックスに、次の値を入力してください。

      ```shell
      0xec70dcb4a1efa46b8f2d97c310c9c4790ba5ffa8
      ```

      **Token Symbol**は自動的に`rETH`が入力され、**Decimals of Precision**は自動的に`18`が入力されます。

      残りのプロンプトを受け入れると、リストにrETHトークンが表示されます。
    </Tab>

  </Tabs>
</div>

## UniswapでETHをrETHに交換する

プロセスの最後のステップは、交換を行うことです。

**Select a token**ドロップダウンをクリックし、MetaMaskに追加したrETHのアドレスを入力します(rETHと入力するだけでもかまいませんが、最初にアドレスを確認して、**正しいトークンであり、偽物や詐欺トークンではないことを確認してください**)。

::: warning 注意
最初に次のような警告が表示される場合があります。

<img src="./images/unknown_token.jpg" width="100%" height="auto" />

これは、UniswapがrETHを使用しているLayerの正規のトークンリストに追加するまでの一時的な警告です。
トークンアドレスがOptimismで`0x9bcef72be871e61ed4fbbc7630889bee758eb81d`、またはArbitrumで`0xec70dcb4a1efa46b8f2d97c310c9c4790ba5ffa8`である限り、安全に追加できます。
:::

次に、交換したいETHの量を入力すると、UniswapのUIが受け取るrETHの量を表示します。

<img src="./images/arb_swap.png" width="100%" height="auto" />

::: warning 注意
受け取るrETHの量が、入力したETHの量よりも**少ない**ことに注意してください。
これは正常です。なぜなら、**rETHはETHよりも価値があり**、継続的に値上がりしているからです。
これはスクリーンショットの下部で強調表示されている交換レートで確認できます。
:::

次に、**Swap**をクリックして、スリッページによって受け取る可能性のある最小量を含む取引の詳細を確認します。
満足できたら、**Confirm Swap**をクリックします。
これによりリクエストがMetaMaskに送信され、確認する前に総取引コストを確認できます。

<img src="./images/arb_gas.png" width="100%" height="auto" />

::: tip 注意
ここで推定Gas手数料に**細心の注意を払ってください**。
Layer 2ネットワークでこの交換を行う方が、Ethereum Mainnetで行うよりもGas手数料の面で**約10倍安い**ことに気付くでしょう。
:::

受け取るrETHの総量に対してGas手数料に満足している場合は、**Confirm**をクリックしてトランザクションを送信します。
しばらくすると、MetaMaskから正常に完了したという通知が表示され、ウォレットにrETHトークンが表示されます。

以上です。これでRocket Poolでステーキングしています。rETHを保持するだけで、rETHトークンの価値が上昇するにつれて、自動的にステーキング報酬を得ることができます。
