import tui_ec_expose_ports from "./images/tui-ec-expose-ports.png";
import tui_cc_expose_ports from "./images/tui-cc-expose-ports.png";
import tui_fallback_clients from "./images/tui-fallback-clients.png";

# Yedek Node Belirtme

Smartnode stack'inin **1.5.0** sürümünden başlayarak, birincil istemcileriniz çevrimdışı olduğunda (örneğin [Geth kullanıyorsanız ve budamanız gerekiyorsa](./pruning)) onların yerini alabilecek bir "yedek" Execution client ve Consensus client çifti sağlayabilirsiniz.
Bu durumda, birincil node makineniz hala megapool'unuzun validator anahtarlarıyla onaylama ve blok önerme işlemlerinden sorumlu olacaktır, ancak Execution katmanı ve Beacon zinciriyle etkileşim kurmak için harici bir makineye bağlanacaktır.

Esasen, zinciri sorgulama, işlem gönderme ve onaylanacak blokları alma gibi şeyler için geçici olarak başka bir istemci çifti kullanmanıza olanak tanır.
Bu çift harici olarak yönetilebilir (Hibrit modu gibi) veya başka bir Rocket Pool node'u olabilir (API portları açık olan başka bir Docker modu makinesi, aşağıda ele alacağız).

Node'unuzun birincil istemcileri tekrar çevrimiçi olduğunda, Smartnode ve Validator client'ınız otomatik olarak onlara geri dönecektir.

::: warning NOT
Bir yedek node, "backup" node ile **aynı değildir**.
Yedek node'lar zincire senkronize edilmiş ve çalışan bir Execution ve Consensus client çiftine sahiptir, ancak node'unuzun cüzdanını veya validator anahtarlarını yüklü **değildirler**.

Ana node'unuz çevrimdışı olursa, **yedeğiniz sizin için doğrulama yapmaya başlamayacaktır.**
:::

## Desteklenen Client'lar

v1.9.0 itibarıyla, desteklenen tüm validator client'larımız sadece birkaç sınırlama ile Yedek desteği eklemiştir:

| İsim       | Yedeği Destekler | Geçerli Yedek Client'lar                                                             |
| ---------- | ---------------- | ------------------------------------------------------------------------------------ |
| Lighthouse | Evet             | Herhangi (doppelganger koruması kapalı)<br />Lighthouse (doppelganger koruması açık) |
| Nimbus     | Evet             | Herhangi                                                                             |
| Prysm      | Evet             | Prysm                                                                                |
| Teku       | Evet             | Herhangi                                                                             |
| Lodestar   | Evet             | Herhangi                                                                             |

## Yeni Bir Node Kurulumu (Docker Modu)

Yedek node olarak yerel olarak sahip olduğunuz ikinci bir makineyi, VPS'de barındırılan uzak bir node'u veya bulut tabanlı bir node'u kullanabilirsiniz.

Bu örnek, yedek node olarak hizmet verebilecek Docker modunu kullanan farklı bir makinede ikinci bir Smartnode oluşturmanın nasıl yapılacağını gösterir.

::: tip İPUCU
Zaten hazır ikinci bir node'unuz varsa ve RPC portları açıksa, bu bölümü atlamaktan çekinmeyin.
:::

1. Node kurma kılavuzundaki adımları izleyin ([yerel](./local/hardware) veya [uzak](./vps/providers)).
2. Makine hazır olduğunda, [Smartnode stack'i kurun](./docker).
3. Hangi istemcileri kullanmak istediğinizi belirtmek için `rocketpool service config` komutunu çalıştırın.
   1. Sihirbazın sonuna geldiğinizde ve ayarlarınızı gözden geçirmek isteyip istemediğinizi sorduğunda, **Evet**'i seçin.
   2. `Execution Client` ayarlarına girin.
   3. `Expose RPC Ports` kutusunu işaretleyin:

   <img src={tui_ec_expose_ports} width="100%" height="auto" />
   4. Geri dönün ve `Consensus Client` ayarlarına girin. 5. `Expose API Port` kutusunu işaretleyin (**Prysm** kullanıyorsanız `Expose RPC Port` kutusunu da işaretleyin):

   <img src={tui_cc_expose_ports} width="100%" height="auto" />
   6. Ayarları kaydedin ve Smartnode'u başlatın.

4. SSH kurmak ve uygun güvenlik duruşunu ayarlamak için [Node'unuzu Güvence Altına Alma](./securing-your-node) kılavuzuna atlayın.
   1. `ufw` kuruluysa, API portlarına gelen trafiğe izin vermek için kurallar eklemeniz gerekecektir (varsayılan olarak `8545`, `8546` ve `5052`; **Prysm** kullanıyorsanız `5053` de).

5. İşte bu kadar! Burada durabilirsiniz.

::: danger NOT
`rocketpool wallet init` ile cüzdan **oluşturmayın** veya eski cüzdanınızı kurtarmayın.
Bu node'u cüzdan ve validator anahtarları olmadan bırakın.

Tek görevi senkronize edilmiş bir Execution client ve Consensus client'a sahip olmaktır.
:::

## Ana Node'unuzu Yedek Node'a Bağlama

Bir yedek node hazırladıktan sonra, bunu ana node'unuza bağlayabilirsiniz.

1. `rocketpool service config` TUI'sine girin ve `Fallback Clients` ayarlarına girin.
2. `Use Fallback Clients` kutusunu işaretleyin.
3. Execution client'ınız için RPC URL'sini `Execution Client URL` kutusuna girin. Örneğin, yedek node'unuzun IP adresi `192.168.1.45` ise ve Execution client'ı varsayılan `8545` portundaysa, buraya `http://192.168.1.45:8545` girersiniz.
4. Yedek Consensus client'ınızın RPC URL'si için de aynısını yapın. Aynı örneği takip ederek, varsayılan `5052` portundaysa, buraya `http://192.168.1.45:5052` girersiniz.

Son sayfa şöyle görünmelidir:

<img src={tui_fallback_clients} width="100%" height="auto" />

::: tip NOT
**Native mod** kullanıcıları aynı adımları takip edebilir, ancak TUI yukarıdaki ekran görüntüsünden biraz farklı görünecektir.

Bunun sadece **Smartnode'un kendisine** (daemon servisi) yedek desteği sağlayacağını unutmayın; **Validator client servisinizin argümanlarını yedek istemcilere erişim sağlamak için manuel olarak güncellemeniz gerekecektir.**
:::

Onaylandığından emin olmak için son kutuda `enter` tuşuna basın, ardından ayarları kaydedin ve değişiklikleri uygulayın.

Uygulandıktan sonra, yedek node'unuzun kullanılabilirliğini `rocketpool node sync` komutu kullanarak doğrulayabilirsiniz:

```
Your Smartnode is currently using the Ethereum Mainnet.

Your eth2 client is on the correct network.

Your primary execution client is fully synced.
Your fallback execution client is fully synced.
Your primary consensus client is fully synced.
Your fallback consensus client is fully synced.
```

Hem yedek Execution hem de Consensus client'ın senkronize olduğunu gösteriyorsa, hazırsınız!

## Yedek Client'ları Test Etme

Yapılandırmanızın çalışacağından emin olmak için yedek istemcileri test etmek istiyorsanız, ana node'unuzdaki Execution ve Consensus client'larını durdurun:

```shell
docker stop rocketpool_eth1 rocketpool_eth2
```

Ardından `rocketpool network stats` gibi zinciri sorgulayan herhangi bir komutu çalıştırın.
Birincil istemcilerinizden birinin (veya her ikisinin) çevrimdışı olduğunu ve yedek istemcilere geri döndüğünü belirten en üstte bir uyarı mesajı göreceksiniz:

```
NOTE: primary clients are not ready, using fallback clients...
 Primary EC status: unavailable (Sync progress check failed with [Post "http://eth1:8545": dial tcp: lookup eth1 on 127.0.0.11:53: no such host])
 Primary CC status: unavailable (Sync progress check failed with [Could not get node sync status: Get "http://eth2:5052/eth/v1/node/syncing": dial tcp: lookup eth2 on 127.0.0.11:53: no such host])

========== General Stats ==========
Total Value Locked:          1196.926316 ETH
Deposit Pool Balance:        23.586761 ETH
Minipool Queue Demand:       0.000000 ETH
Deposit Pool ETH Used:       6.809609%

============== Nodes ==============
Current Commission Rate:     5.000000%
Node Count:                  16
Active Minipools:            36
    Initialized:             0
    Prelaunch:               0
    Staking:                 36
    Withdrawable:            0
    Dissolved:               0
Finalized Minipools:         30

=========== Megapools ============
Megapool contracts deployed: 10
Total megapool validators:  86
     Staking:                51
     In Prestake:            6
     In Queue:               10
     Exited:                 14
     Locked:                 1
     Exiting:                2
     Dissolved:              2

========== Smoothing Pool =========
Contract Address:            0xE8D1136ac49DBe6ac8f299130253004DC63841a1
Nodes Opted in:              3
Pending Balance:             0.000000

============== Tokens =============
rETH Price (ETH / rETH):     1.185477 ETH
RPL Price (ETH / RPL):       0.000639 ETH
Total RPL staked:            33406.127068 RPL
Total Megapool RPL staked:   11406.127068 RPL
Total Legacy RPL staked:     22000.000000 RPL
```

Son olarak, birincil istemcilerinizi tekrar başlatın:

```shell
docker start rocketpool_eth1 rocketpool_eth2
```

Ve işiniz bitti!
Yedek kurulumunuz çalışıyor.

## Sonraki Adımlar

Kurulumunuz için bir yedek node oluşturmayı ve/veya çalıştırmayı tercih edip etmediğinizden bağımsız olarak, bir sonraki adım **öncelik ücretleri** hakkında bilgi edinmektir.
Devam etmeye hazır olduğunuzda kılavuzun bir sonraki bölümüne tıklayın.
