import { Tab, Tabs } from "@rspress/core/theme";
import tuiEcContainerTag from "./images/tui-ec-container-tag.png";
import tuiCcContainerTag from "./images/tui-cc-container-tag.png";

# Güncellemeleri Kontrol Etme

Bir düğüm operatörünün sorumluluklarından biri, sisteminizin en son güvenlik yamaları ile güncel olduğundan emin olmaktır.
Otomatik güncellemeler kullanışlıdır ancak düğüm işletmenizi kesintiye uğratabilir, bu nedenle bunları manuel olarak çalıştırmak tercih edilebilir.
Her iki durumda da, **makinenizin düzenli olarak yamalandığından emin olmalısınız!**

::: tip NOT
Çoğu zaman, güncelleme sisteminizin birkaç dakikadan fazla kapalı kalmasını gerektirmez.
Bu tür bir kesinti süresinin Beacon Chain bakiyenizi olumsuz etkileyeceğinden endişe edebilirsiniz.
Emin olun ki, bu kadar kısa bir süre için çevrimdışı olmanın cezası **tamamen önemsizdir**.

Kaçırdığınız her doğrulama, başarılı bir doğrulamadan kazanacağınız miktardan biraz daha az cezalandıracaktır.
Genel kural olarak, bir saat çevrimdışıyseniz, bir saat daha çevrimiçi olduktan sonra hepsini geri kazanırsınız.

Ayrıca, kısa bir süre için çevrimdışı olarak _cezalandırılma (slashing)_ olasılığınızın **kesinlikle olmadığını** unutmayın.
Cezalandırma yalnızca ağa saldırırsanız gerçekleşir ve bakım için çevrimdışı olmak ağa saldırı olarak sayılmaz.

**Lütfen sistemlerinizi güncel tutun - kesinti cezaları için endişelenmeyin!**
:::

## İşletim Sisteminizi Güncelleme

İşletim Sisteminizin paket yöneticisini veya güncelleme hizmetini sık sık kontrol ederek yeni önemli güvenlik yamalarını hızlı bir şekilde uyguladığınızdan emin olmalısınız.
Kesin talimatlar her İşletim Sistemi için değişir ve sisteminizin belgelerinde bulunabilir, ancak işte birkaç örnek.

<div className="p-3">
  <Tabs>
    <Tab label="Ubuntu">
      Bir terminalde, aşağıdakileri yazın:

      ```shell
      sudo apt update
      ```

      Bu, paket sunucularına erişecek ve yüklü paketlerinizden herhangi birinin yeni sürümlerinin mevcut olup olmadığını kontrol edecektir.
      Güncellemeler mevcutsa, çıktı şöyle görünecektir:

      ```
      Fetched 3974 kB in 2s (1641 kB/s)
      Reading package lists... Done
      Building dependency tree
      Reading state information... Done
      12 packages can be upgraded. Run 'apt list --upgradable' to see them.
      ```

      Güncellemeleri aşağıdaki komutla kurabilirsiniz:

      ```shell
      sudo apt dist-upgrade
      ```

      Bu size güncellenecek paketlerin listesini gösterecek ve toplam kurulum boyutu yeterince büyükse, size boyutu gösterecek ve kabul ettiğinizi onaylamanızı isteyecektir:

      ```
      12 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
      Need to get 51.3 MB of archives.
      After this operation, 52.2 kB of additional disk space will be used.
      Do you want to continue? [Y/n]
      ```

      Bunu yapmak için yeterli alanınız olduğundan emin olun, ardından `y` ve `Enter` tuşlarına basarak güncelleme işlemini başlatın.

      İlerleme çubuğu tamamlandığında ve terminal istemine geri bırakıldığınızda, yeni değiştirilen paketlerin eski sürümlerini temizlemek için aşağıdaki komutu çalıştırın:

      ```shell
      sudo apt autoremove
      ```

      Ardından, sisteminizin yeniden başlatılması gerekip gerekmediğini kontrol edin:

      ```shell
      cat /var/run/reboot-required
      ```

      Yukarıdaki komut `No such file or directory` yazdırırsa, yeniden başlatma gerekli değildir ve aşağıdaki adımı atlayabilirsiniz.

      Ancak komut `*** System restart required ***` yazdırırsa, güncellemeleri uygulamayı tamamlamak için yapabildiğinizde makinenizi yeniden başlatmalısınız:

      ```shell
      sudo reboot
      ```

      Rocket Pool zarif bir şekilde kapanacak ve sistem yeniden başlatıldığında otomatik olarak tekrar başlayacaktır.
    </Tab>
    <Tab label="MacOS">
      İşletim sistemi paketlerini güncellemek için, kullanıcı arayüzünü kullanarak `Apple -> Software Update` seçeneğini seçin.

      Paketlerin kendisini güncellemek için en kolay yol terminalde `homebrew` kullanmaktır:

      ```shell
      brew update && brew upgrade
      ```
    </Tab>

  </Tabs>
</div>

## Smartnode Yığınını Güncelleme

Zaman zaman, Rocket Pool Smartnode yığınının yeni bir sürümünü yayınlayacaktır.
Güncellemeler, CLI'nin veya Rocket Pool Docker konteynerlerinin yeni sürümlerini ve ayrıca Yürütüm ve Fikir Birliği istemcilerinin yeni sürümlerini içerebilir.

Yeni sürümler hakkında bilgi almanın en tutarlı yolu Rocket Pool Discord sunucusuna abone olmaktır; her zaman Releases kanalında yayınlanacaklar ve bir bildirim alacaksınız.

::: warning NOT
`apt update` komutunu çalıştırmanın düğüm yazılımını güncellemeyeceğini unutmayın.
Bu, aşağıdaki adımlar kullanılarak manuel olarak yapılmalıdır.
:::

::: tip İPUCU
Smartnode yükseltmesini tamamladığınızda, Grafana panosu hala bir güncellemenin mevcut olduğunu gösterecektir.
Sistem bir sonraki otomatik güncelleme kontrolünü yaptığında bir gün içinde otomatik olarak temizlenecektir.

Güncellemeden hemen sonra temizlemek istiyorsanız, sadece şunu çalıştırın:
`sudo apt update`
:::

::: tip İPUCU
CPU mimarinizi bilmiyorsanız, bunu bulmak için aşağıdaki komutu çalıştırabilirsiniz:

```shell
uname -m
```

Bu komutun çıktısı mimarinizi yazdıracaktır.
**`x86_64`'ün `x64` ve `amd64` ile aynı olduğunu unutmayın.**
**`aarch64`'ün `arm64` ile aynı olduğunu unutmayın.**
:::

Yükseltme adımları düğümünüzün hangi modu kullandığına bağlıdır. Aşağıdaki seçeneklerden birini seçin:

<div className="p-3">
  <Tabs>
    <Tab label="Linux (Docker veya Hibrit Mod)">
      Rocket Pool hizmetlerini durdurun:

      ```shell
      rocketpool service stop
      ```

      Yeni Smartnode CLI'yi indirin:

      `x64` sistemler için (çoğu normal makine):

      ```shell
      wget https://github.com/rocket-pool/smartnode/releases/latest/download/rocketpool-cli-linux-amd64 -O ~/bin/rocketpool
      ```

      `arm64` sistemler için:

      ```shell
      wget https://github.com/rocket-pool/smartnode/releases/latest/download/rocketpool-cli-linux-arm64 -O ~/bin/rocketpool
      ```

      Şimdi kurulum komutunu çalıştırın:

      ```shell
      rocketpool service install -d
      ```

      `-d` bayrağı, Docker gibi sistem bağımlılıklarını görmezden gelmesini söyler, çünkü zaten onlara sahipsiniz.

      Nelerin değiştiğini görmek istiyorsanız, Ayarlar Yöneticisini açın - İnceleme Sayfası size yenilikleri gösterecektir:

      ```shell
      rocketpool service config
      ```

      İşiniz bittiğinde, Rocket Pool'u tekrar başlatın:

      ```shell
      rocketpool service start
      ```

      Son olarak, CLI ve Smartnode yığınının her ikisinin de güncel olduğundan emin olmak için sürümü kontrol edin:

      ```shell
      rocketpool service version
      ```

      Çıktı şuna benzer bir şey görünmelidir:

      ```
      Your Smartnode is currently using the Hoodi Test Network.

      Rocket Pool client version: 1.5.0
      Rocket Pool service version: 1.5.0
      Selected Eth 1.0 client: Geth (Locally managed)
      Image: ethereum/client-go:v1.10.21
      Selected Eth 2.0 client: Lighthouse (Locally managed)
      Image: rocketpool/lighthouse:mevboost-5ee3bc5
      ```

      Hem istemci hem de hizmet yeni sürüm sürümüyle eşleşmelidir.
    </Tab>
    <Tab label="Linux (Yerel Mod)">
      <p className="rspress-directive warning">
        <p className="rspress-directive-title">NOT</p>
        Bu yalnızca Smartnode yığınının kendisini güncelleyecektir - Yürütüm veya Fikir Birliği istemcilerinizi **güncellemeyecektir**.
        Bunu manuel olarak yapmanız gerekecektir (aşağıdaki bir sonraki bölüme bakın).
      </p>

      Rocket Pool hizmetlerini durdurun:

      ```shell
      sudo systemctl stop rp-node rp-watchtower
      ```

      Yeni Smartnode CLI'yi indirin ve geri getirmeniz gerekebilecek eski CLI ve daemon ikili dosyalarını yedekleyin:

      `x64` sistemler için (çoğu normal makine):

      ```shell
      sudo mv /usr/local/bin/rocketpool /usr/local/bin/rocketpool_bak

      sudo mv /usr/local/bin/rocketpoold /usr/local/bin/rocketpoold_bak

      sudo wget https://github.com/rocket-pool/smartnode/releases/latest/download/rocketpool-cli-linux-amd64 -O /usr/local/bin/rocketpool

      sudo wget https://github.com/rocket-pool/smartnode/releases/latest/download/rocketpool-daemon-linux-amd64 -O /usr/local/bin/rocketpoold

      sudo chmod +x /usr/local/bin/rocketpool /usr/local/bin/rocketpoold
      ```

      `arm64` sistemler için:

      ```shell
      sudo mv /usr/local/bin/rocketpool /usr/local/bin/rocketpool_bak

      sudo mv /usr/local/bin/rocketpoold /usr/local/bin/rocketpoold_bak

      sudo wget https://github.com/rocket-pool/smartnode/releases/latest/download/rocketpool-cli-linux-arm64 -O /usr/local/bin/rocketpool

      sudo wget https://github.com/rocket-pool/smartnode/releases/latest/download/rocketpool-daemon-linux-arm64 -O /usr/local/bin/rocketpoold

      sudo chmod +x /usr/local/bin/rocketpool /usr/local/bin/rocketpoold
      ```

      Nelerin değiştiğini görmek istiyorsanız, Ayarlar Yöneticisini açın - İnceleme Sayfası size yenilikleri gösterecektir:

      ```shell
      rp service config
      ```

      İşiniz bittiğinde, Rocket Pool'u tekrar başlatın:

      ```shell
      sudo systemctl start rp-node rp-watchtower
      ```

      Son olarak, CLI ve Smartnode yığınının her ikisinin de güncel olduğundan emin olmak için sürümü kontrol edin:

      ```
      rocketpool service version

      Rocket Pool client version: 1.0.0-rc3
      Rocket Pool service version: 1.0.0-rc3
      Selected Eth 1.0 client: Geth (rocketpool/client-go:v1.10.4)
      Selected Eth 2.0 client: Nimbus (statusim/nimbus:v1.4.0)
      ```

      Hem istemci hem de hizmet yeni sürüm sürümüyle eşleşmelidir.
    </Tab>
    <Tab label="macOS (Docker veya Hibrit Mod)">
      Rocket Pool hizmetlerini durdurun:

      ```shell
      rocketpool service stop
      ```

      Yeni Smartnode CLI'yi indirin:

      `x64` sistemler için (çoğu Mac):

      ```shell
      wget https://github.com/rocket-pool/smartnode/releases/latest/download/rocketpool-cli-darwin-amd64 -O /usr/local/bin/rocketpool
      ```

      M1'li Mac mini gibi `arm64` sistemler için:

      ```shell
      wget https://github.com/rocket-pool/smartnode/releases/latest/download/rocketpool-cli-darwin-arm64 -O /opt/homebrew/bin/rocketpool
      ```

      Şimdi kurulum komutunu çalıştırın:

      ```shell
      rocketpool service install -d
      ```

      `-d` bayrağı, Docker gibi sistem bağımlılıklarını görmezden gelmesini söyler, çünkü zaten onlara sahipsiniz.

      Nelerin değiştiğini görmek istiyorsanız, Ayarlar Yöneticisini açın - İnceleme Sayfası size yenilikleri gösterecektir:

      ```shell
      rocketpool service config
      ```

      İşiniz bittiğinde, Rocket Pool'u tekrar başlatın:

      ```shell
      rocketpool service start
      ```

      Son olarak, CLI ve Smartnode yığınının her ikisinin de güncel olduğundan emin olmak için sürümü kontrol edin:

      ```shell
      rocketpool service version

      Rocket Pool client version: 1.0.0-rc3
      Rocket Pool service version: 1.0.0-rc3
      Selected Eth 1.0 client: Geth (rocketpool/client-go:v1.10.4)
      Selected Eth 2.0 client: Nimbus (statusim/nimbus:v1.4.0)
      ```

      Hem istemci hem de hizmet yeni sürüm sürümüyle eşleşmelidir.

    </Tab>

  </Tabs>
</div>

## Yürütüm veya Fikir Birliği İstemcisini Manuel Olarak Güncelleme

Smartnode yığınının her yeni sürümü, Yürütüm ve Fikir Birliği Docker konteynerlerinin en son uyumlu sürümlerine güncellenmiş referanslarla gelecektir.
Ancak bazı durumlarda, yeni bir Smartnode yığını sürümünü beklemeden _önce_ bu istemcilerden birini yükseltmek isteyebilirsiniz.
Bu bölüm size tam olarak bunu nasıl yapacağınızı gösterecektir.

<div className="p-3">
  <Tabs>
    <Tab label="Docker Modu">
      Docker modunda yeni istemci sürümlerine güncelleme kolaydır.

      Ayarlar Yöneticisini açarak başlayın:

      ```shell
      rocketpool service config
      ```

      Yürütüm istemci sürümünü değiştirmek için **Execution Client** kategorisine gidin.
      **Container Tag** ayarını değiştirin:

      <img src={tuiEcContainerTag} width="100%" height="auto"/>

      Fikir Birliği istemci sürümünü değiştirmek için **Consensus Client** kategorisine gidin.
      **Beacon Node Container Tag** ayarını değiştirin:

      <img src={tuiCcContainerTag} width="100%" height="auto"/>

      Değişikliklerinizden memnun olduğunuzda, her zamanki gibi kaydedin ve çıkın.
      Smartnode, etkilenen tüm konteynerleri otomatik olarak yeniden başlatmayı teklif edecektir.
    </Tab>
    <Tab label="Yerel Mod">
      İlk olarak, neyi güncellemek istediğinize bağlı olarak Yürütüm istemcinizi, Beacon Node'unuzu ve/veya Doğrulayıcı istemci hizmetinizi kapatın.
      Örneğin, Geth'i kapatmak için:

      ```shell
      sudo systemctl stop geth
      ```

      Ardından, istemcinizin satıcısından en son ikili sürümü indirin (veya kaynaktan oluşturun) ve eski ikili dosyayı yenisiyle değiştirin.
      **Eski ikili dosyayı üzerine yazmak yerine bir yedek konuma taşımanızı** öneririz, yeni istemcide sorun olması durumunda.

      Son olarak, istemci hizmetini tekrar başlatın - örneğin, Geth'i başlatmak için:

      ```shell
      sudo systemctl start geth
      ```

      Yükseltmeden sonra yeni istemcinin beklendiği gibi çalıştığından emin olmak için günlük betiklerini yakından takip etmelisiniz.
    </Tab>

  </Tabs>
</div>
