import { Tab, Tabs } from "@rspress/core/theme";

# Execution İstemcisini Budama

::: tip NOT
Bu, `geth` ve `nethermind` kullanıcıları içindir.
Besu'nun budanması _gerekmez_.
:::

Birincil Execution istemciniz olarak `geth` veya `nethermind` kullanıyorsanız, muhtemelen düğümünüzün boş disk alanının zamanla yavaşça azaldığını fark edeceksiniz.
Execution istemcisi bunun açık ara en büyük katkıda bulunanıdır; `rocketpool service config` sırasında önbelleğine ne kadar RAM tahsis ettiğinize bağlı olarak, günde birkaç gigabayt hızında büyüyebilir!

Bunu ele almak için, Execution istemcileri veritabanlarını güvenli bir şekilde tarayıp temizlemelerine ve biraz boş alan geri kazanmalarına olanak tanıyan **budama** adlı özel bir işlev sağlar.
Geth veya Nethermind kullanan her düğüm operatörü sonunda onu budamak zorunda kalacaktır.

2 TB'lık bir SSD'niz varsa, genellikle budama turları arasında aylarca gidebilirsiniz.
1 TB SSD kullanıcıları için, daha sık budamanız gerekecektir.

[Grafana panosunu](./grafana) etkinleştirdiyseniz, iyi bir kural düğümünüzün kullanılan disk alanı %80'i aştığında Execution istemcinizi budamayı düşünmeye başlamaktır.

Zamanı geldiğine karar verdiğinizde, Smartnode talep üzerine sizin için bunu budama yeteneğiyle gelir.
Nasıl çalıştığını ve ne bekleyeceğinizi öğrenmek için aşağıyı okuyun.

::: warning NOT
Execution istemcinizi budama yalnızca Docker Mode'da mümkündür.

Hybrid modda veya Native modda harici bir istemci gibi kendi Execution istemcinizi kullanıyorsanız, Execution istemcisini budamak için Smartnode'u kullanamazsınız.
Bunu manuel olarak yapmanız gerekecektir.
Nasıl budayacağınızı öğrenmek için lütfen Execution istemcinizin belgelerine başvurun.
:::

## Ön Koşullar

Aşağıdaki sekmelerden kullandığınız istemciyi seçin.

<div className="p-3">
  <Tabs>
    <Tab label="Geth">
      Geth'i budamak, birincil Execution istemcisini çevrimdışı almak anlamına gelir, böylece kendini temizleyebilir.
      Bu olduğunda, Smartnode (ve Consensus istemciniz) düzgün çalışmak için ETH1 zincirine erişmek için başka bir yola ihtiyaç duyacaktır.

      Bunu sağlamanın en kolay yolu bir **fallback node** ile olur.
      `rocketpool service config` kullanarak halihazırda [bir fallback node yapılandırdıysanız](./fallback), Geth container'ınız bakım için düştüğünde Smartnode otomatik olarak ona geçecektir.
      Ayrıca Consensus istemcinize de fallback'i kullanması gerektiğini bildirecektir.

      <p className="rspress-directive warning">
        <p className="rspress-directive-title">UYARI</p>
        Yapılandırılmış bir fallback node'unuz yoksa, düğümünüz budama işlemi sırasında doğrulamayı durduracaktır.
        Bitene ve ağ ile yeniden senkronize olana kadar tüm tasdikleri ve blok önerilerini kaçıracaktır.
        **Bu süre boyunca kaçırılan doğrulamalar nedeniyle ETH kaybedeceksiniz!**
      </p>

      Bunu akılda tutarak, Geth'i başarıyla budamak için aşağıdaki iki koşul gereklidir:

      - Çalışan bir fallback node yapılandırılmalı
      - SSD'nizde en az **50 GB** boş alan kalmalı
    </Tab>
    <Tab label="Nethermind">
      Nethermind budarken çevrimiçi kalabilir, bu da tasdik etmeye devam etmek için bir fallback node gerektirmediğiniz anlamına gelir.
      Ancak, budamanın **son derece kaynak yoğun bir görev** olduğunu ve onun sırasında tasdiklerinizin dahil edilme mesafesinde bir artış ve kaçırılan tasdikler görebileceğinizi unutmayın.

      Nethermind özel bir ön koşul gerektirmez; istediğiniz zaman budayabilirsiniz.
    </Tab>

  </Tabs>
</div>

## Budamayı Başlatma

Aşağıdaki sekmelerden kullandığınız istemciyi seçin.

<div className="p-3">
  <Tabs>
    <Tab label="Geth">
      Geth'i budamak istediğinizde, basitçe bu komutu çalıştırın:

      ```shell
      rocketpool service prune-eth1
      ```

      Etkinleştirilmiş bir fallback istemci çiftiniz yoksa, şu uyarıyı alacaksınız:

      ```
      This will shut down your main execution client and prune its database, freeing up disk space.
      Once pruning is complete, your execution client will restart automatically.

      You do not have a fallback execution client configured.
      Your node will no longer be able to perform any validation duties (attesting or proposing blocks) until Geth is done pruning and has synced again.
      Please configure a fallback client with `rocketpool service config` before running this.
      Are you sure you want to prune your main execution client? [y/n]
      ```

      Etkinleştirilmiş bir taneniz varsa, bunun yerine şu istemi göreceksiniz:

      ```
      This will shut down your main execution client and prune its database, freeing up disk space.
      Once pruning is complete, your execution client will restart automatically.

      You have fallback clients enabled. Rocket Pool (and your consensus client) will use that while the main client is pruning.
      Are you sure you want to prune your main execution client? [y/n]
      ```

      Kabul ederseniz, Smartnode hazırlıklarını yaparken birkaç ayrıntı göreceksiniz; bir başarı mesajıyla bitmelidir:

      ```
      Are you sure you want to prune your main ETH1 client? [y/n]
      y

      Your disk has 303 GiB free, which is enough to prune.
      Stopping rocketpool_eth1...
      Provisioning pruning on volume rocketpool_eth1clientdata...
      Restarting rocketpool_eth1...

      Done! Your main ETH1 client is now pruning. You can follow its progress with `rocketpool service logs eth1`.
      Once it's done, it will restart automatically and resume normal operation.
      NOTE: While pruning, you **cannot** interrupt the client (e.g. by restarting) or you risk corrupting the database!
      You must let it run to completion!
      ```

      Bununla, Geth şimdi budanıyor ve hazırsınız!
      İlerlemesini şununla takip edebilirsiniz:

      ```shell
      rocketpool service logs eth1
      ```

      Budama tamamlandığında, otomatik olarak yeniden başlayacak ve Smartnode fallback'iniz yerine tekrar onu kullanmaya devam edecektir.
    </Tab>
    <Tab label="Nethermind">
      Nethermind'ı budamak istediğinizde, basitçe bu komutu çalıştırın:

      ```shell
      rocketpool service prune-eth1
      ```

      Şu istemi göreceksiniz:

      ```
      This will shut down your main execution client and prune its database, freeing up disk space.
      Once pruning is complete, your execution client will restart automatically.

      Are you sure you want to prune your main execution client? [y/n]
      ```

      Kabul ederseniz, aşağıdakine benzer birkaç mesaj göreceksiniz:

      ```
      Your disk has 790 GiB free, which is enough to prune.
      Stopping rocketpool_eth1...
      Provisioning pruning on volume rocketpool_eth1clientdata...
      Restarting rocketpool_eth1...
      Error requesting prune: AggregateException - One or more errors occurred. (Connection refused (127.0.0.1:7434))
      Trying again in 3 seconds... (1/100)
      ...
      Trying again in 3 seconds... (10/100)
      Success: Pruning is now "Starting"

      Done! Your main execution client is now pruning. You can follow its progress with `rocketpool service logs eth1`.
      Once it's done, it will restart automatically and resume normal operation.
      NOTE: While pruning, you **cannot** interrupt the client (e.g. by restarting) or you risk corrupting the database!
      You must let it run to completion!
      ```

      Bununla, Nethermind şimdi budanıyor ve hazırsınız!
      İlerlemesini şununla takip edebilirsiniz:

      ```shell
      rocketpool service logs eth1
      ```

      Budama tamamlandığında, otomatik olarak yeniden başlayacaktır.
    </Tab>

  </Tabs>
</div>
