---
next:
  text: 救援已解散的 Minipool
  link: "/zh/node-staking/rescue-dissolved"
---

# 关闭 Minipool

## 退出您的验证者

当您决定不再想运行 minipool 并想要访问在信标链上锁定的全部余额时，您需要执行几个步骤：

1. 为 minipool 的验证者从信标链发送自愿退出请求。
2. 等待您的验证者退出。
3. 等待您的验证者余额被提取到执行层上的 minipool。
4. 关闭 minipool 以分配奖励并访问资金

我们将在下面介绍每个步骤。

### 发送退出请求

如果您想退出附加到 minipool 的验证者，请运行以下命令：

```shell
rocketpool minipool exit
```

您将看到可以退出的 minipool 列表：

```
Please select a minipool to exit:
1: All available minipools
2: 0x7E5700bcd65B1770bA68abB288D3f53814d376aC (staking since 2023-02-08, 06:33 +0000 UTC)
3: 0xd8E804cFA64ADb386F52DB20717810130c90f674 (staking since 2023-02-08, 06:33 +0000 UTC)
```

一旦确认要退出，您的节点将向信标链发送自愿退出请求。
这**不是**正常的执行层交易，因此您无需为其支付 gas 费用。

如果您需要刚刚退出的 minipool 的验证者公钥，可以使用 `rocketpool minipool status` 检索它。
您可以在信标链浏览器（例如 [https://beaconcha.in](https://beaconcha.in)（或 Hoodi 测试网的 [https://hoodi.beaconcha.in](https://hoodi.beaconcha.in)））上查看验证者的退出状态。
您的状态需要一些时间才能更新，但更新后您将看到它处于"退出中"状态：

<img src="./images/exiting.png" width="100%" height="auto" />

在这里您可以看到状态为 `Exiting`，突出显示了它将退出的 epoch（5224），并且"Exited"图标将呈绿色脉冲，表示操作正在进行中。
您的验证者可能需要一些时间才能退出，_特别是_如果同时有大量验证者退出信标链；该协议旨在每个 epoch 只允许少数验证者退出，因此您可能需要等待轮到您。

一旦您的退出 epoch 过去，您的验证者将正式退出链，并且将不再证明或提议区块。
您可以在验证者客户端日志或浏览器上确认这一点：

<img src="./images/exited.png" width="100%" height="auto" />

状态已更改为 `Exited`，下面有一些文字指示您的**可提取 epoch**（应该是您退出后的 256 个 epoch，或大约 27 小时）。
Beaconcha.in 还方便地提供了验证者何时退出以及何时可提取的本地时间戳。

一旦它进入**可提取**状态，您的验证者将被信标链排队等待奖励分配。
此队列取决于当前有多少验证者正在提取。
轮到您时，信标链将_自动_将您的余额发送到执行层上的 minipool 地址。
此时，您可以使用 Smartnode CLI 访问它来进行分配。

### 分配全额奖励

::: tip 注意
此过程要求您的验证者已从信标链退出，并且验证者的余额已转移到 minipool 合约。
如果您需要复习如何执行该过程，请参阅上面的[**退出您的验证者**](#exiting-your-validator)部分 - 完成后再回到这里。
:::

如果您已从信标链退出验证者，并且余额已存入 minipool 合约，则可以使用一个命令安全地提取全部内容。
与[手动分配](./skimming#manual-distribution)不同，此过程实际上会**最终确定**您的 minipool，从而关闭它并使其变为非活动状态。
一旦您的余额从信标链提取，并且您完成以下过程访问资金，minipool 的职责就结束了。

要检索资金并关闭 minipool，请运行以下命令：

```shell
rocketpool minipool close
```

这将向您显示符合关闭条件的 minipool 列表：

```
Please select a minipool to close:
1: All available minipools
2: 0xd8E804cFA64ADb386F52DB20717810130c90f674 (32.007209 ETH available, 8.002559 ETH is yours plus a refund of 0.000000 ETH)
```

在这里，您可以看到每个符合条件的 minipool 的总余额、将分配给您的余额以及为您保留的退款金额（绕过分配）。

从列表中选择您想要分配和关闭的 minipool，确认操作，然后等待您的交易得到验证。
完成后，您的 minipool 余额份额（和您的退款）将被发送到您的提取地址，并且 minipool 将进入 `finalized` 状态。

您可以通过在区块浏览器上查看交易来验证它；例如，请参阅[关闭上述 minipool 的交易（Goerli 测试网）](https://goerli.etherscan.io/tx/0xe81415b3b66f9b42d43ac17a0983e792725726c9fdd35ac855745bd12a053509)。

### 取消质押 RPL

此时，您的有效 RPL 将更新以从计算中删除此 minipool。
您现在可以取消质押任何会使您超过 60% 绑定 ETH 阈值的 RPL。

要针对节点取消质押 RPL，请运行以下命令：

```shell
rocketpool node withdraw-rpl
```

::: tip 注意
RPL 提取有两个限制：

在质押（或重新质押）RPL 后的 28 天内无法提取 RPL。请注意，如果您在关闭 minipool 之前领取这些奖励，如果您重新质押任何数量的 RPL 奖励，您将无法在自上次质押操作以来的 28 天内提取任何数量的 RPL。

RPL 可以提取到您总绑定 ETH 的 60%。对于完全退出，这意味着所有 RPL 都可以提取；对于部分退出，请记住此限制。
:::

## 关于旧委托的注意事项

从 Rocket Pool 启动到 Atlas 部署期间分配给每个 minipool 的**原始 minipool 委托**是在考虑两个假设的情况下构建的：

1. 您的 minipool 唯一有余额的时间是在验证者从信标链退出之后。
2. 一旦余额从信标链转移到 minipool 合约，Oracle DAO 将把您的 minipool 状态从"质押中"更改为"可提取"。

第一点现在显然不再相关，因为以太坊正在升级以支持撇取。
第二点_也_不再正确，因为 Oracle DAO **不再**标记"可提取"的 minipool。
这是一个有意的设计决策，旨在减少 Oracle DAO 对 Rocket Pool 节点运营商施加的权力，并允许他们在没有对受信任方的任何补充要求的情况下访问奖励。

由于这些缺陷，Smartnode CLI **不再支持**原始 minipool 委托上的提取或资金分配。
如果您想访问您的奖励，您**必须**升级到支持上述新提取条件的 Atlas 委托。

::: danger 危险
如果您是高级用户，并通过第三方工具绕过 CLI 直接调用合约上的分配功能，请注意以下事项：

1. 如果 minipool 的余额**低于 16 ETH**，委托的分配函数将回退。低于 16 ETH 的余额**无法访问。**
2. 如果 minipool 的余额**在 16 到 32 ETH 之间**，原始委托的分配将假设您的验证者已被**罚没**。它将向质押池返还 16 ETH，并给您剩余的部分。只有当 minipool 余额超过 32 ETH 时，它才会_正常_运行。
3. minipool 永远不会进入 `finalized` 状态，因为 Oracle DAO 永远不会将其标记为 `withdrawable`，因此即使您可能能够访问您的 ETH，**您的 RPL 将被锁定**，直到您升级到 Atlas 委托。

由于这些原因，我们**强烈建议**您首先升级到 Atlas 委托，完全避免它们。
:::
